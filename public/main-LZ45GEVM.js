import{a as Kl,b as Wl,c as No,d as Hl,e as Ql,f as Jl,g as Fo,h as Yl,i as Xl,j as it,k as Cr,l as st,m as xi,n as Sr,o as Oo,p as Zl,q as eh,r as Pr,s as ki,t as we,u as Lo,v as Uo,w as jo,x as Bo,y as qo,z as Ht}from"./chunk-PQQ733WR.js";import{$ as Se,A as Ri,Aa as Bl,B as Fe,Ba as ql,C as yn,Ca as $l,D as bo,Da as Ct,E as ze,Ea as Gl,F as Ke,Fa as zl,G as Co,H as Kt,I as wr,J as Oe,K as So,L as Er,N as oe,O as Y,P as Po,Q as Ir,R as wt,S as Et,T as Rl,U as Me,V as Vo,W as j,X as U,Y as Wt,Z as vn,_ as ae,a as yt,aa as xl,b as Pi,ba as G,c as bl,ca as Tr,d as Cl,da as wn,e as vt,ea as It,f as $t,fa as Tt,g as _n,ga as At,h as yr,ha as Ar,i as rt,ia as We,j as Sl,ja as kl,k as Pl,ka as Ml,l as Eo,la as Nl,m as Vl,ma as Do,n as Io,na as Ro,o as Gt,oa as Fl,p as To,pa as Ol,q as Dl,qa as xo,r as Vi,ra as Ll,s as vr,sa as ko,t as zt,ta as br,u as Di,ua as bt,v as se,va as Mo,w as Ce,wa as Ul,x as Ao,xa as jl,y as De,ya as En,z as Ge,za as In}from"./chunk-EH7LUFSM.js";import{a as ke,b as $e,e as V}from"./chunk-7A67K276.js";var km="firebase",Mm="10.13.1";we(km,Mm,"app");var Pt=new Do("ANGULARFIRE2_VERSION");function Ni(n,e,t){if(e){if(e.length===1)return e[0];let o=e.filter(u=>u.app===t);if(o.length===1)return o[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Vr=(n,e)=>{let t=e?[e]:ki(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(u=>{r.includes(u)||r.push(u)})}),r},ot=class{constructor(){return Vr(Nm)}},Nm="app-check";function Tn(){}var Mi=class{zone;delegate;constructor(e,t=Cl){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,o=function(u){i.runGuarded(()=>{e.apply(this,[u])})};return this.delegate.schedule(o,t,r)}},$o=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Tn,{},Tn,Tn)),t.pipe(Dl({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Vt=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new Mi(Zone.current)),this.insideAngular=t.run(()=>new Mi(Zone.current,bl)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(Ce(Oe))};static \u0275prov=zt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Fi(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function Fm(n){return Fi().ngZone.runOutsideAngular(()=>n())}function Qt(n){return Fi().ngZone.run(()=>n())}function Go(n){return Om(Fi())(n)}function Om(n){return function(t){return t=t.lift(new $o(n.ngZone)),t.pipe($t(n.outsideAngular),vt(n.insideAngular))}}var Lm=(n,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),Qt(()=>n.apply(void 0,r))},Pe=(n,e)=>function(){let t,r=arguments;for(let o=0;o<arguments.length;o++)typeof r[o]=="function"&&(e&&(t||=Qt(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Tn,{},Tn,Tn))),r[o]=Lm(r[o],t));let i=Fm(()=>n.apply(this,r));if(!e)if(i instanceof yt){let o=Fi();return i.pipe($t(o.outsideAngular),vt(o.insideAngular))}else return Qt(()=>i);return i instanceof yt?i.pipe(Go):i instanceof Promise?Qt(()=>new Promise((o,u)=>i.then(l=>Qt(()=>o(l)),l=>Qt(()=>u(l))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:Qt(()=>i)};var at=class{constructor(e){return e}},Jt=class{constructor(){return ki()}};function jm(n){return n&&n.length===1?n[0]:new at(Pr())}var zo=new se("angularfire2._apps"),Bm={provide:at,useFactory:jm,deps:[[new De,zo]]},qm={provide:Jt,deps:[[new De,zo]]};function $m(n){return(e,t)=>{let r=t.get(Er);we("angularfire",Pt.full,"core"),we("angularfire",Pt.full,"app"),we("angular",Ro.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new at(i)}}function th(n,...e){return yn([Bm,qm,{provide:zo,useFactory:$m(n),multi:!0,deps:[Oe,Kt,Vt,...e]}])}var Oi=Pe(eh,!0);var nh="auth",Dr=class{constructor(e){return e}},Rr=class{constructor(){return Vr(nh)}};var Ko=new se("angularfire2.auth-instances");function Up(n,e){let t=Ni(nh,n,e);return t&&new Dr(t)}function jp(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Dr(r)}}var Bp={provide:Rr,deps:[[new De,Ko]]},qp={provide:Dr,useFactory:Up,deps:[[new De,Ko],at]};function rh(n,...e){return we("angularfire",Pt.full,"auth"),yn([qp,Bp,{provide:Ko,useFactory:jp(n),multi:!0,deps:[Oe,Kt,Vt,Jt,[new De,ot],...e]}])}var ih=Pe(Lo,!0);var Li=Pe(qo,!0);var sh=Pe(jo,!0);var oh=Pe(Uo,!0);var ah=Pe(Bo,!0);var uh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ch={};var Dt,Wo;(function(){var n;function e(w,m){function _(){}_.prototype=m.prototype,w.D=m.prototype,w.prototype=new _,w.prototype.constructor=w,w.C=function(y,v,I){for(var g=Array(arguments.length-2),et=2;et<arguments.length;et++)g[et-2]=arguments[et];return m.prototype[v].apply(y,g)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,m,_){_||(_=0);var y=Array(16);if(typeof m=="string")for(var v=0;16>v;++v)y[v]=m.charCodeAt(_++)|m.charCodeAt(_++)<<8|m.charCodeAt(_++)<<16|m.charCodeAt(_++)<<24;else for(v=0;16>v;++v)y[v]=m[_++]|m[_++]<<8|m[_++]<<16|m[_++]<<24;m=w.g[0],_=w.g[1],v=w.g[2];var I=w.g[3],g=m+(I^_&(v^I))+y[0]+3614090360&4294967295;m=_+(g<<7&4294967295|g>>>25),g=I+(v^m&(_^v))+y[1]+3905402710&4294967295,I=m+(g<<12&4294967295|g>>>20),g=v+(_^I&(m^_))+y[2]+606105819&4294967295,v=I+(g<<17&4294967295|g>>>15),g=_+(m^v&(I^m))+y[3]+3250441966&4294967295,_=v+(g<<22&4294967295|g>>>10),g=m+(I^_&(v^I))+y[4]+4118548399&4294967295,m=_+(g<<7&4294967295|g>>>25),g=I+(v^m&(_^v))+y[5]+1200080426&4294967295,I=m+(g<<12&4294967295|g>>>20),g=v+(_^I&(m^_))+y[6]+2821735955&4294967295,v=I+(g<<17&4294967295|g>>>15),g=_+(m^v&(I^m))+y[7]+4249261313&4294967295,_=v+(g<<22&4294967295|g>>>10),g=m+(I^_&(v^I))+y[8]+1770035416&4294967295,m=_+(g<<7&4294967295|g>>>25),g=I+(v^m&(_^v))+y[9]+2336552879&4294967295,I=m+(g<<12&4294967295|g>>>20),g=v+(_^I&(m^_))+y[10]+4294925233&4294967295,v=I+(g<<17&4294967295|g>>>15),g=_+(m^v&(I^m))+y[11]+2304563134&4294967295,_=v+(g<<22&4294967295|g>>>10),g=m+(I^_&(v^I))+y[12]+1804603682&4294967295,m=_+(g<<7&4294967295|g>>>25),g=I+(v^m&(_^v))+y[13]+4254626195&4294967295,I=m+(g<<12&4294967295|g>>>20),g=v+(_^I&(m^_))+y[14]+2792965006&4294967295,v=I+(g<<17&4294967295|g>>>15),g=_+(m^v&(I^m))+y[15]+1236535329&4294967295,_=v+(g<<22&4294967295|g>>>10),g=m+(v^I&(_^v))+y[1]+4129170786&4294967295,m=_+(g<<5&4294967295|g>>>27),g=I+(_^v&(m^_))+y[6]+3225465664&4294967295,I=m+(g<<9&4294967295|g>>>23),g=v+(m^_&(I^m))+y[11]+643717713&4294967295,v=I+(g<<14&4294967295|g>>>18),g=_+(I^m&(v^I))+y[0]+3921069994&4294967295,_=v+(g<<20&4294967295|g>>>12),g=m+(v^I&(_^v))+y[5]+3593408605&4294967295,m=_+(g<<5&4294967295|g>>>27),g=I+(_^v&(m^_))+y[10]+38016083&4294967295,I=m+(g<<9&4294967295|g>>>23),g=v+(m^_&(I^m))+y[15]+3634488961&4294967295,v=I+(g<<14&4294967295|g>>>18),g=_+(I^m&(v^I))+y[4]+3889429448&4294967295,_=v+(g<<20&4294967295|g>>>12),g=m+(v^I&(_^v))+y[9]+568446438&4294967295,m=_+(g<<5&4294967295|g>>>27),g=I+(_^v&(m^_))+y[14]+3275163606&4294967295,I=m+(g<<9&4294967295|g>>>23),g=v+(m^_&(I^m))+y[3]+4107603335&4294967295,v=I+(g<<14&4294967295|g>>>18),g=_+(I^m&(v^I))+y[8]+1163531501&4294967295,_=v+(g<<20&4294967295|g>>>12),g=m+(v^I&(_^v))+y[13]+2850285829&4294967295,m=_+(g<<5&4294967295|g>>>27),g=I+(_^v&(m^_))+y[2]+4243563512&4294967295,I=m+(g<<9&4294967295|g>>>23),g=v+(m^_&(I^m))+y[7]+1735328473&4294967295,v=I+(g<<14&4294967295|g>>>18),g=_+(I^m&(v^I))+y[12]+2368359562&4294967295,_=v+(g<<20&4294967295|g>>>12),g=m+(_^v^I)+y[5]+4294588738&4294967295,m=_+(g<<4&4294967295|g>>>28),g=I+(m^_^v)+y[8]+2272392833&4294967295,I=m+(g<<11&4294967295|g>>>21),g=v+(I^m^_)+y[11]+1839030562&4294967295,v=I+(g<<16&4294967295|g>>>16),g=_+(v^I^m)+y[14]+4259657740&4294967295,_=v+(g<<23&4294967295|g>>>9),g=m+(_^v^I)+y[1]+2763975236&4294967295,m=_+(g<<4&4294967295|g>>>28),g=I+(m^_^v)+y[4]+1272893353&4294967295,I=m+(g<<11&4294967295|g>>>21),g=v+(I^m^_)+y[7]+4139469664&4294967295,v=I+(g<<16&4294967295|g>>>16),g=_+(v^I^m)+y[10]+3200236656&4294967295,_=v+(g<<23&4294967295|g>>>9),g=m+(_^v^I)+y[13]+681279174&4294967295,m=_+(g<<4&4294967295|g>>>28),g=I+(m^_^v)+y[0]+3936430074&4294967295,I=m+(g<<11&4294967295|g>>>21),g=v+(I^m^_)+y[3]+3572445317&4294967295,v=I+(g<<16&4294967295|g>>>16),g=_+(v^I^m)+y[6]+76029189&4294967295,_=v+(g<<23&4294967295|g>>>9),g=m+(_^v^I)+y[9]+3654602809&4294967295,m=_+(g<<4&4294967295|g>>>28),g=I+(m^_^v)+y[12]+3873151461&4294967295,I=m+(g<<11&4294967295|g>>>21),g=v+(I^m^_)+y[15]+530742520&4294967295,v=I+(g<<16&4294967295|g>>>16),g=_+(v^I^m)+y[2]+3299628645&4294967295,_=v+(g<<23&4294967295|g>>>9),g=m+(v^(_|~I))+y[0]+4096336452&4294967295,m=_+(g<<6&4294967295|g>>>26),g=I+(_^(m|~v))+y[7]+1126891415&4294967295,I=m+(g<<10&4294967295|g>>>22),g=v+(m^(I|~_))+y[14]+2878612391&4294967295,v=I+(g<<15&4294967295|g>>>17),g=_+(I^(v|~m))+y[5]+4237533241&4294967295,_=v+(g<<21&4294967295|g>>>11),g=m+(v^(_|~I))+y[12]+1700485571&4294967295,m=_+(g<<6&4294967295|g>>>26),g=I+(_^(m|~v))+y[3]+2399980690&4294967295,I=m+(g<<10&4294967295|g>>>22),g=v+(m^(I|~_))+y[10]+4293915773&4294967295,v=I+(g<<15&4294967295|g>>>17),g=_+(I^(v|~m))+y[1]+2240044497&4294967295,_=v+(g<<21&4294967295|g>>>11),g=m+(v^(_|~I))+y[8]+1873313359&4294967295,m=_+(g<<6&4294967295|g>>>26),g=I+(_^(m|~v))+y[15]+4264355552&4294967295,I=m+(g<<10&4294967295|g>>>22),g=v+(m^(I|~_))+y[6]+2734768916&4294967295,v=I+(g<<15&4294967295|g>>>17),g=_+(I^(v|~m))+y[13]+1309151649&4294967295,_=v+(g<<21&4294967295|g>>>11),g=m+(v^(_|~I))+y[4]+4149444226&4294967295,m=_+(g<<6&4294967295|g>>>26),g=I+(_^(m|~v))+y[11]+3174756917&4294967295,I=m+(g<<10&4294967295|g>>>22),g=v+(m^(I|~_))+y[2]+718787259&4294967295,v=I+(g<<15&4294967295|g>>>17),g=_+(I^(v|~m))+y[9]+3951481745&4294967295,w.g[0]=w.g[0]+m&4294967295,w.g[1]=w.g[1]+(v+(g<<21&4294967295|g>>>11))&4294967295,w.g[2]=w.g[2]+v&4294967295,w.g[3]=w.g[3]+I&4294967295}r.prototype.u=function(w,m){m===void 0&&(m=w.length);for(var _=m-this.blockSize,y=this.B,v=this.h,I=0;I<m;){if(v==0)for(;I<=_;)i(this,w,I),I+=this.blockSize;if(typeof w=="string"){for(;I<m;)if(y[v++]=w.charCodeAt(I++),v==this.blockSize){i(this,y),v=0;break}}else for(;I<m;)if(y[v++]=w[I++],v==this.blockSize){i(this,y),v=0;break}}this.h=v,this.o+=m},r.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var m=1;m<w.length-8;++m)w[m]=0;var _=8*this.o;for(m=w.length-8;m<w.length;++m)w[m]=_&255,_/=256;for(this.u(w),w=Array(16),m=_=0;4>m;++m)for(var y=0;32>y;y+=8)w[_++]=this.g[m]>>>y&255;return w};function o(w,m){var _=l;return Object.prototype.hasOwnProperty.call(_,w)?_[w]:_[w]=m(w)}function u(w,m){this.h=m;for(var _=[],y=!0,v=w.length-1;0<=v;v--){var I=w[v]|0;y&&I==m||(_[v]=I,y=!1)}this.g=_}var l={};function h(w){return-128<=w&&128>w?o(w,function(m){return new u([m|0],0>m?-1:0)}):new u([w|0],0>w?-1:0)}function f(w){if(isNaN(w)||!isFinite(w))return T;if(0>w)return D(f(-w));for(var m=[],_=1,y=0;w>=_;y++)m[y]=w/_|0,_*=4294967296;return new u(m,0)}function p(w,m){if(w.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(w.charAt(0)=="-")return D(p(w.substring(1),m));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=f(Math.pow(m,8)),y=T,v=0;v<w.length;v+=8){var I=Math.min(8,w.length-v),g=parseInt(w.substring(v,v+I),m);8>I?(I=f(Math.pow(m,I)),y=y.j(I).add(f(g))):(y=y.j(_),y=y.add(f(g)))}return y}var T=h(0),b=h(1),S=h(16777216);n=u.prototype,n.m=function(){if(M(this))return-D(this).m();for(var w=0,m=1,_=0;_<this.g.length;_++){var y=this.i(_);w+=(0<=y?y:4294967296+y)*m,m*=4294967296}return w},n.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(x(this))return"0";if(M(this))return"-"+D(this).toString(w);for(var m=f(Math.pow(w,6)),_=this,y="";;){var v=H(_,m).g;_=$(_,v.j(m));var I=((0<_.g.length?_.g[0]:_.h)>>>0).toString(w);if(_=v,x(_))return I+y;for(;6>I.length;)I="0"+I;y=I+y}},n.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function x(w){if(w.h!=0)return!1;for(var m=0;m<w.g.length;m++)if(w.g[m]!=0)return!1;return!0}function M(w){return w.h==-1}n.l=function(w){return w=$(this,w),M(w)?-1:x(w)?0:1};function D(w){for(var m=w.g.length,_=[],y=0;y<m;y++)_[y]=~w.g[y];return new u(_,~w.h).add(b)}n.abs=function(){return M(this)?D(this):this},n.add=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],y=0,v=0;v<=m;v++){var I=y+(this.i(v)&65535)+(w.i(v)&65535),g=(I>>>16)+(this.i(v)>>>16)+(w.i(v)>>>16);y=g>>>16,I&=65535,g&=65535,_[v]=g<<16|I}return new u(_,_[_.length-1]&-2147483648?-1:0)};function $(w,m){return w.add(D(m))}n.j=function(w){if(x(this)||x(w))return T;if(M(this))return M(w)?D(this).j(D(w)):D(D(this).j(w));if(M(w))return D(this.j(D(w)));if(0>this.l(S)&&0>w.l(S))return f(this.m()*w.m());for(var m=this.g.length+w.g.length,_=[],y=0;y<2*m;y++)_[y]=0;for(y=0;y<this.g.length;y++)for(var v=0;v<w.g.length;v++){var I=this.i(y)>>>16,g=this.i(y)&65535,et=w.i(v)>>>16,Zn=w.i(v)&65535;_[2*y+2*v]+=g*Zn,z(_,2*y+2*v),_[2*y+2*v+1]+=I*Zn,z(_,2*y+2*v+1),_[2*y+2*v+1]+=g*et,z(_,2*y+2*v+1),_[2*y+2*v+2]+=I*et,z(_,2*y+2*v+2)}for(y=0;y<m;y++)_[y]=_[2*y+1]<<16|_[2*y];for(y=m;y<2*m;y++)_[y]=0;return new u(_,0)};function z(w,m){for(;(w[m]&65535)!=w[m];)w[m+1]+=w[m]>>>16,w[m]&=65535,m++}function O(w,m){this.g=w,this.h=m}function H(w,m){if(x(m))throw Error("division by zero");if(x(w))return new O(T,T);if(M(w))return m=H(D(w),m),new O(D(m.g),D(m.h));if(M(m))return m=H(w,D(m)),new O(D(m.g),m.h);if(30<w.g.length){if(M(w)||M(m))throw Error("slowDivide_ only works with positive integers.");for(var _=b,y=m;0>=y.l(w);)_=ce(_),y=ce(y);var v=ee(_,1),I=ee(y,1);for(y=ee(y,2),_=ee(_,2);!x(y);){var g=I.add(y);0>=g.l(w)&&(v=v.add(_),I=g),y=ee(y,1),_=ee(_,1)}return m=$(w,v.j(m)),new O(v,m)}for(v=T;0<=w.l(m);){for(_=Math.max(1,Math.floor(w.m()/m.m())),y=Math.ceil(Math.log(_)/Math.LN2),y=48>=y?1:Math.pow(2,y-48),I=f(_),g=I.j(m);M(g)||0<g.l(w);)_-=y,I=f(_),g=I.j(m);x(I)&&(I=b),v=v.add(I),w=$(w,g)}return new O(v,w)}n.A=function(w){return H(this,w).h},n.and=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],y=0;y<m;y++)_[y]=this.i(y)&w.i(y);return new u(_,this.h&w.h)},n.or=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],y=0;y<m;y++)_[y]=this.i(y)|w.i(y);return new u(_,this.h|w.h)},n.xor=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],y=0;y<m;y++)_[y]=this.i(y)^w.i(y);return new u(_,this.h^w.h)};function ce(w){for(var m=w.g.length+1,_=[],y=0;y<m;y++)_[y]=w.i(y)<<1|w.i(y-1)>>>31;return new u(_,w.h)}function ee(w,m){var _=m>>5;m%=32;for(var y=w.g.length-_,v=[],I=0;I<y;I++)v[I]=0<m?w.i(I+_)>>>m|w.i(I+_+1)<<32-m:w.i(I+_);return new u(v,w.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Wo=ch.Md5=r,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.A,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=f,u.fromString=p,Dt=ch.Integer=u}).apply(typeof uh<"u"?uh:typeof self<"u"?self:typeof window<"u"?window:{});var Ui=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ut={};var Ho,Qo,An,Jo,xr,ji,Yo,Xo,Zo;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(s,a,c){return s==Array.prototype||s==Object.prototype||(s[a]=c.value),s};function t(s){s=[typeof globalThis=="object"&&globalThis,s,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ui=="object"&&Ui];for(var a=0;a<s.length;++a){var c=s[a];if(c&&c.Math==Math)return c}throw Error("Cannot find global object")}var r=t(this);function i(s,a){if(a)e:{var c=r;s=s.split(".");for(var d=0;d<s.length-1;d++){var E=s[d];if(!(E in c))break e;c=c[E]}s=s[s.length-1],d=c[s],a=a(d),a!=d&&a!=null&&e(c,s,{configurable:!0,writable:!0,value:a})}}function o(s,a){s instanceof String&&(s+="");var c=0,d=!1,E={next:function(){if(!d&&c<s.length){var A=c++;return{value:a(A,s[A]),done:!1}}return d=!0,{done:!0,value:void 0}}};return E[Symbol.iterator]=function(){return E},E}i("Array.prototype.values",function(s){return s||function(){return o(this,function(a,c){return c})}});var u=u||{},l=this||self;function h(s){var a=typeof s;return a=a!="object"?a:s?Array.isArray(s)?"array":a:"null",a=="array"||a=="object"&&typeof s.length=="number"}function f(s){var a=typeof s;return a=="object"&&s!=null||a=="function"}function p(s,a,c){return s.call.apply(s.bind,arguments)}function T(s,a,c){if(!s)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var E=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(E,d),s.apply(a,E)}}return function(){return s.apply(a,arguments)}}function b(s,a,c){return b=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:T,b.apply(null,arguments)}function S(s,a){var c=Array.prototype.slice.call(arguments,1);return function(){var d=c.slice();return d.push.apply(d,arguments),s.apply(this,d)}}function x(s,a){function c(){}c.prototype=a.prototype,s.aa=a.prototype,s.prototype=new c,s.prototype.constructor=s,s.Qb=function(d,E,A){for(var R=Array(arguments.length-2),X=2;X<arguments.length;X++)R[X-2]=arguments[X];return a.prototype[E].apply(d,R)}}function M(s){let a=s.length;if(0<a){let c=Array(a);for(let d=0;d<a;d++)c[d]=s[d];return c}return[]}function D(s,a){for(let c=1;c<arguments.length;c++){let d=arguments[c];if(h(d)){let E=s.length||0,A=d.length||0;s.length=E+A;for(let R=0;R<A;R++)s[E+R]=d[R]}else s.push(d)}}class ${constructor(a,c){this.i=a,this.j=c,this.h=0,this.g=null}get(){let a;return 0<this.h?(this.h--,a=this.g,this.g=a.next,a.next=null):a=this.i(),a}}function z(s){return/^[\s\xa0]*$/.test(s)}function O(){var s=l.navigator;return s&&(s=s.userAgent)?s:""}function H(s){return H[" "](s),s}H[" "]=function(){};var ce=O().indexOf("Gecko")!=-1&&!(O().toLowerCase().indexOf("webkit")!=-1&&O().indexOf("Edge")==-1)&&!(O().indexOf("Trident")!=-1||O().indexOf("MSIE")!=-1)&&O().indexOf("Edge")==-1;function ee(s,a,c){for(let d in s)a.call(c,s[d],d,s)}function w(s,a){for(let c in s)a.call(void 0,s[c],c,s)}function m(s){let a={};for(let c in s)a[c]=s[c];return a}let _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function y(s,a){let c,d;for(let E=1;E<arguments.length;E++){d=arguments[E];for(c in d)s[c]=d[c];for(let A=0;A<_.length;A++)c=_[A],Object.prototype.hasOwnProperty.call(d,c)&&(s[c]=d[c])}}function v(s){var a=1;s=s.split(":");let c=[];for(;0<a&&s.length;)c.push(s.shift()),a--;return s.length&&c.push(s.join(":")),c}function I(s){l.setTimeout(()=>{throw s},0)}function g(){var s=Qs;let a=null;return s.g&&(a=s.g,s.g=s.g.next,s.g||(s.h=null),a.next=null),a}class et{constructor(){this.h=this.g=null}add(a,c){let d=Zn.get();d.set(a,c),this.h?this.h.next=d:this.g=d,this.h=d}}var Zn=new $(()=>new Zf,s=>s.reset());class Zf{constructor(){this.next=this.g=this.h=null}set(a,c){this.h=a,this.g=c,this.next=null}reset(){this.next=this.g=this.h=null}}let er,tr=!1,Qs=new et,Ac=()=>{let s=l.Promise.resolve(void 0);er=()=>{s.then(em)}};var em=()=>{for(var s;s=g();){try{s.h.call(s.g)}catch(c){I(c)}var a=Zn;a.j(s),100>a.h&&(a.h++,s.next=a.g,a.g=s)}tr=!1};function mt(){this.s=this.s,this.C=this.C}mt.prototype.s=!1,mt.prototype.ma=function(){this.s||(this.s=!0,this.N())},mt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ge(s,a){this.type=s,this.g=this.target=a,this.defaultPrevented=!1}ge.prototype.h=function(){this.defaultPrevented=!0};var tm=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var s=!1,a=Object.defineProperty({},"passive",{get:function(){s=!0}});try{let c=()=>{};l.addEventListener("test",c,a),l.removeEventListener("test",c,a)}catch{}return s}();function nr(s,a){if(ge.call(this,s?s.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,s){var c=this.type=s.type,d=s.changedTouches&&s.changedTouches.length?s.changedTouches[0]:null;if(this.target=s.target||s.srcElement,this.g=a,a=s.relatedTarget){if(ce){e:{try{H(a.nodeName);var E=!0;break e}catch{}E=!1}E||(a=null)}}else c=="mouseover"?a=s.fromElement:c=="mouseout"&&(a=s.toElement);this.relatedTarget=a,d?(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0):(this.clientX=s.clientX!==void 0?s.clientX:s.pageX,this.clientY=s.clientY!==void 0?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0),this.button=s.button,this.key=s.key||"",this.ctrlKey=s.ctrlKey,this.altKey=s.altKey,this.shiftKey=s.shiftKey,this.metaKey=s.metaKey,this.pointerId=s.pointerId||0,this.pointerType=typeof s.pointerType=="string"?s.pointerType:nm[s.pointerType]||"",this.state=s.state,this.i=s,s.defaultPrevented&&nr.aa.h.call(this)}}x(nr,ge);var nm={2:"touch",3:"pen",4:"mouse"};nr.prototype.h=function(){nr.aa.h.call(this);var s=this.i;s.preventDefault?s.preventDefault():s.returnValue=!1};var rr="closure_listenable_"+(1e6*Math.random()|0),rm=0;function im(s,a,c,d,E){this.listener=s,this.proxy=null,this.src=a,this.type=c,this.capture=!!d,this.ha=E,this.key=++rm,this.da=this.fa=!1}function hi(s){s.da=!0,s.listener=null,s.proxy=null,s.src=null,s.ha=null}function di(s){this.src=s,this.g={},this.h=0}di.prototype.add=function(s,a,c,d,E){var A=s.toString();s=this.g[A],s||(s=this.g[A]=[],this.h++);var R=Ys(s,a,d,E);return-1<R?(a=s[R],c||(a.fa=!1)):(a=new im(a,this.src,A,!!d,E),a.fa=c,s.push(a)),a};function Js(s,a){var c=a.type;if(c in s.g){var d=s.g[c],E=Array.prototype.indexOf.call(d,a,void 0),A;(A=0<=E)&&Array.prototype.splice.call(d,E,1),A&&(hi(a),s.g[c].length==0&&(delete s.g[c],s.h--))}}function Ys(s,a,c,d){for(var E=0;E<s.length;++E){var A=s[E];if(!A.da&&A.listener==a&&A.capture==!!c&&A.ha==d)return E}return-1}var Xs="closure_lm_"+(1e6*Math.random()|0),Zs={};function bc(s,a,c,d,E){if(d&&d.once)return Sc(s,a,c,d,E);if(Array.isArray(a)){for(var A=0;A<a.length;A++)bc(s,a[A],c,d,E);return null}return c=ro(c),s&&s[rr]?s.K(a,c,f(d)?!!d.capture:!!d,E):Cc(s,a,c,!1,d,E)}function Cc(s,a,c,d,E,A){if(!a)throw Error("Invalid event type");var R=f(E)?!!E.capture:!!E,X=to(s);if(X||(s[Xs]=X=new di(s)),c=X.add(a,c,d,R,A),c.proxy)return c;if(d=sm(),c.proxy=d,d.src=s,d.listener=c,s.addEventListener)tm||(E=R),E===void 0&&(E=!1),s.addEventListener(a.toString(),d,E);else if(s.attachEvent)s.attachEvent(Vc(a.toString()),d);else if(s.addListener&&s.removeListener)s.addListener(d);else throw Error("addEventListener and attachEvent are unavailable.");return c}function sm(){function s(c){return a.call(s.src,s.listener,c)}let a=om;return s}function Sc(s,a,c,d,E){if(Array.isArray(a)){for(var A=0;A<a.length;A++)Sc(s,a[A],c,d,E);return null}return c=ro(c),s&&s[rr]?s.L(a,c,f(d)?!!d.capture:!!d,E):Cc(s,a,c,!0,d,E)}function Pc(s,a,c,d,E){if(Array.isArray(a))for(var A=0;A<a.length;A++)Pc(s,a[A],c,d,E);else d=f(d)?!!d.capture:!!d,c=ro(c),s&&s[rr]?(s=s.i,a=String(a).toString(),a in s.g&&(A=s.g[a],c=Ys(A,c,d,E),-1<c&&(hi(A[c]),Array.prototype.splice.call(A,c,1),A.length==0&&(delete s.g[a],s.h--)))):s&&(s=to(s))&&(a=s.g[a.toString()],s=-1,a&&(s=Ys(a,c,d,E)),(c=-1<s?a[s]:null)&&eo(c))}function eo(s){if(typeof s!="number"&&s&&!s.da){var a=s.src;if(a&&a[rr])Js(a.i,s);else{var c=s.type,d=s.proxy;a.removeEventListener?a.removeEventListener(c,d,s.capture):a.detachEvent?a.detachEvent(Vc(c),d):a.addListener&&a.removeListener&&a.removeListener(d),(c=to(a))?(Js(c,s),c.h==0&&(c.src=null,a[Xs]=null)):hi(s)}}}function Vc(s){return s in Zs?Zs[s]:Zs[s]="on"+s}function om(s,a){if(s.da)s=!0;else{a=new nr(a,this);var c=s.listener,d=s.ha||s.src;s.fa&&eo(s),s=c.call(d,a)}return s}function to(s){return s=s[Xs],s instanceof di?s:null}var no="__closure_events_fn_"+(1e9*Math.random()>>>0);function ro(s){return typeof s=="function"?s:(s[no]||(s[no]=function(a){return s.handleEvent(a)}),s[no])}function _e(){mt.call(this),this.i=new di(this),this.M=this,this.F=null}x(_e,mt),_e.prototype[rr]=!0,_e.prototype.removeEventListener=function(s,a,c,d){Pc(this,s,a,c,d)};function Ae(s,a){var c,d=s.F;if(d)for(c=[];d;d=d.F)c.push(d);if(s=s.M,d=a.type||a,typeof a=="string")a=new ge(a,s);else if(a instanceof ge)a.target=a.target||s;else{var E=a;a=new ge(d,s),y(a,E)}if(E=!0,c)for(var A=c.length-1;0<=A;A--){var R=a.g=c[A];E=fi(R,d,!0,a)&&E}if(R=a.g=s,E=fi(R,d,!0,a)&&E,E=fi(R,d,!1,a)&&E,c)for(A=0;A<c.length;A++)R=a.g=c[A],E=fi(R,d,!1,a)&&E}_e.prototype.N=function(){if(_e.aa.N.call(this),this.i){var s=this.i,a;for(a in s.g){for(var c=s.g[a],d=0;d<c.length;d++)hi(c[d]);delete s.g[a],s.h--}}this.F=null},_e.prototype.K=function(s,a,c,d){return this.i.add(String(s),a,!1,c,d)},_e.prototype.L=function(s,a,c,d){return this.i.add(String(s),a,!0,c,d)};function fi(s,a,c,d){if(a=s.i.g[String(a)],!a)return!0;a=a.concat();for(var E=!0,A=0;A<a.length;++A){var R=a[A];if(R&&!R.da&&R.capture==c){var X=R.listener,pe=R.ha||R.src;R.fa&&Js(s.i,R),E=X.call(pe,d)!==!1&&E}}return E&&!d.defaultPrevented}function Dc(s,a,c){if(typeof s=="function")c&&(s=b(s,c));else if(s&&typeof s.handleEvent=="function")s=b(s.handleEvent,s);else throw Error("Invalid listener argument");return 2147483647<Number(a)?-1:l.setTimeout(s,a||0)}function Rc(s){s.g=Dc(()=>{s.g=null,s.i&&(s.i=!1,Rc(s))},s.l);let a=s.h;s.h=null,s.m.apply(null,a)}class am extends mt{constructor(a,c){super(),this.m=a,this.l=c,this.h=null,this.i=!1,this.g=null}j(a){this.h=arguments,this.g?this.i=!0:Rc(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ir(s){mt.call(this),this.h=s,this.g={}}x(ir,mt);var xc=[];function kc(s){ee(s.g,function(a,c){this.g.hasOwnProperty(c)&&eo(a)},s),s.g={}}ir.prototype.N=function(){ir.aa.N.call(this),kc(this)},ir.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var io=l.JSON.stringify,um=l.JSON.parse,cm=class{stringify(s){return l.JSON.stringify(s,void 0)}parse(s){return l.JSON.parse(s,void 0)}};function so(){}so.prototype.h=null;function Mc(s){return s.h||(s.h=s.i())}function Nc(){}var sr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function oo(){ge.call(this,"d")}x(oo,ge);function ao(){ge.call(this,"c")}x(ao,ge);var Ut={},Fc=null;function mi(){return Fc=Fc||new _e}Ut.La="serverreachability";function Oc(s){ge.call(this,Ut.La,s)}x(Oc,ge);function or(s){let a=mi();Ae(a,new Oc(a))}Ut.STAT_EVENT="statevent";function Lc(s,a){ge.call(this,Ut.STAT_EVENT,s),this.stat=a}x(Lc,ge);function be(s){let a=mi();Ae(a,new Lc(a,s))}Ut.Ma="timingevent";function Uc(s,a){ge.call(this,Ut.Ma,s),this.size=a}x(Uc,ge);function ar(s,a){if(typeof s!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){s()},a)}function ur(){this.g=!0}ur.prototype.xa=function(){this.g=!1};function lm(s,a,c,d,E,A){s.info(function(){if(s.g)if(A)for(var R="",X=A.split("&"),pe=0;pe<X.length;pe++){var Q=X[pe].split("=");if(1<Q.length){var ye=Q[0];Q=Q[1];var ve=ye.split("_");R=2<=ve.length&&ve[1]=="type"?R+(ye+"="+Q+"&"):R+(ye+"=redacted&")}}else R=null;else R=A;return"XMLHTTP REQ ("+d+") [attempt "+E+"]: "+a+`
`+c+`
`+R})}function hm(s,a,c,d,E,A,R){s.info(function(){return"XMLHTTP RESP ("+d+") [ attempt "+E+"]: "+a+`
`+c+`
`+A+" "+R})}function fn(s,a,c,d){s.info(function(){return"XMLHTTP TEXT ("+a+"): "+fm(s,c)+(d?" "+d:"")})}function dm(s,a){s.info(function(){return"TIMEOUT: "+a})}ur.prototype.info=function(){};function fm(s,a){if(!s.g)return a;if(!a)return null;try{var c=JSON.parse(a);if(c){for(s=0;s<c.length;s++)if(Array.isArray(c[s])){var d=c[s];if(!(2>d.length)){var E=d[1];if(Array.isArray(E)&&!(1>E.length)){var A=E[0];if(A!="noop"&&A!="stop"&&A!="close")for(var R=1;R<E.length;R++)E[R]=""}}}}return io(c)}catch{return a}}var pi={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},jc={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},uo;function gi(){}x(gi,so),gi.prototype.g=function(){return new XMLHttpRequest},gi.prototype.i=function(){return{}},uo=new gi;function pt(s,a,c,d){this.j=s,this.i=a,this.l=c,this.R=d||1,this.U=new ir(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Bc}function Bc(){this.i=null,this.g="",this.h=!1}var qc={},co={};function lo(s,a,c){s.L=1,s.v=wi(tt(a)),s.m=c,s.P=!0,$c(s,null)}function $c(s,a){s.F=Date.now(),_i(s),s.A=tt(s.v);var c=s.A,d=s.R;Array.isArray(d)||(d=[String(d)]),rl(c.i,"t",d),s.C=0,c=s.j.J,s.h=new Bc,s.g=El(s.j,c?a:null,!s.m),0<s.O&&(s.M=new am(b(s.Y,s,s.g),s.O)),a=s.U,c=s.g,d=s.ca;var E="readystatechange";Array.isArray(E)||(E&&(xc[0]=E.toString()),E=xc);for(var A=0;A<E.length;A++){var R=bc(c,E[A],d||a.handleEvent,!1,a.h||a);if(!R)break;a.g[R.key]=R}a=s.H?m(s.H):{},s.m?(s.u||(s.u="POST"),a["Content-Type"]="application/x-www-form-urlencoded",s.g.ea(s.A,s.u,s.m,a)):(s.u="GET",s.g.ea(s.A,s.u,null,a)),or(),lm(s.i,s.u,s.A,s.l,s.R,s.m)}pt.prototype.ca=function(s){s=s.target;let a=this.M;a&&nt(s)==3?a.j():this.Y(s)},pt.prototype.Y=function(s){try{if(s==this.g)e:{let ve=nt(this.g);var a=this.g.Ba();let gn=this.g.Z();if(!(3>ve)&&(ve!=3||this.g&&(this.h.h||this.g.oa()||ll(this.g)))){this.J||ve!=4||a==7||(a==8||0>=gn?or(3):or(2)),ho(this);var c=this.g.Z();this.X=c;t:if(Gc(this)){var d=ll(this.g);s="";var E=d.length,A=nt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){jt(this),cr(this);var R="";break t}this.h.i=new l.TextDecoder}for(a=0;a<E;a++)this.h.h=!0,s+=this.h.i.decode(d[a],{stream:!(A&&a==E-1)});d.length=0,this.h.g+=s,this.C=0,R=this.h.g}else R=this.g.oa();if(this.o=c==200,hm(this.i,this.u,this.A,this.l,this.R,ve,c),this.o){if(this.T&&!this.K){t:{if(this.g){var X,pe=this.g;if((X=pe.g?pe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(X)){var Q=X;break t}}Q=null}if(c=Q)fn(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,fo(this,c);else{this.o=!1,this.s=3,be(12),jt(this),cr(this);break e}}if(this.P){c=!0;let Ne;for(;!this.J&&this.C<R.length;)if(Ne=mm(this,R),Ne==co){ve==4&&(this.s=4,be(14),c=!1),fn(this.i,this.l,null,"[Incomplete Response]");break}else if(Ne==qc){this.s=4,be(15),fn(this.i,this.l,R,"[Invalid Chunk]"),c=!1;break}else fn(this.i,this.l,Ne,null),fo(this,Ne);if(Gc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ve!=4||R.length!=0||this.h.h||(this.s=1,be(16),c=!1),this.o=this.o&&c,!c)fn(this.i,this.l,R,"[Invalid Chunked Response]"),jt(this),cr(this);else if(0<R.length&&!this.W){this.W=!0;var ye=this.j;ye.g==this&&ye.ba&&!ye.M&&(ye.j.info("Great, no buffering proxy detected. Bytes received: "+R.length),vo(ye),ye.M=!0,be(11))}}else fn(this.i,this.l,R,null),fo(this,R);ve==4&&jt(this),this.o&&!this.J&&(ve==4?_l(this.j,this):(this.o=!1,_i(this)))}else Rm(this.g),c==400&&0<R.indexOf("Unknown SID")?(this.s=3,be(12)):(this.s=0,be(13)),jt(this),cr(this)}}}catch{}finally{}};function Gc(s){return s.g?s.u=="GET"&&s.L!=2&&s.j.Ca:!1}function mm(s,a){var c=s.C,d=a.indexOf(`
`,c);return d==-1?co:(c=Number(a.substring(c,d)),isNaN(c)?qc:(d+=1,d+c>a.length?co:(a=a.slice(d,d+c),s.C=d+c,a)))}pt.prototype.cancel=function(){this.J=!0,jt(this)};function _i(s){s.S=Date.now()+s.I,zc(s,s.I)}function zc(s,a){if(s.B!=null)throw Error("WatchDog timer not null");s.B=ar(b(s.ba,s),a)}function ho(s){s.B&&(l.clearTimeout(s.B),s.B=null)}pt.prototype.ba=function(){this.B=null;let s=Date.now();0<=s-this.S?(dm(this.i,this.A),this.L!=2&&(or(),be(17)),jt(this),this.s=2,cr(this)):zc(this,this.S-s)};function cr(s){s.j.G==0||s.J||_l(s.j,s)}function jt(s){ho(s);var a=s.M;a&&typeof a.ma=="function"&&a.ma(),s.M=null,kc(s.U),s.g&&(a=s.g,s.g=null,a.abort(),a.ma())}function fo(s,a){try{var c=s.j;if(c.G!=0&&(c.g==s||mo(c.h,s))){if(!s.K&&mo(c.h,s)&&c.G==3){try{var d=c.Da.g.parse(a)}catch{d=null}if(Array.isArray(d)&&d.length==3){var E=d;if(E[0]==0){e:if(!c.u){if(c.g)if(c.g.F+3e3<s.F)bi(c),Ti(c);else break e;yo(c),be(18)}}else c.za=E[1],0<c.za-c.T&&37500>E[2]&&c.F&&c.v==0&&!c.C&&(c.C=ar(b(c.Za,c),6e3));if(1>=Hc(c.h)&&c.ca){try{c.ca()}catch{}c.ca=void 0}}else qt(c,11)}else if((s.K||c.g==s)&&bi(c),!z(a))for(E=c.Da.g.parse(a),a=0;a<E.length;a++){let Q=E[a];if(c.T=Q[0],Q=Q[1],c.G==2)if(Q[0]=="c"){c.K=Q[1],c.ia=Q[2];let ye=Q[3];ye!=null&&(c.la=ye,c.j.info("VER="+c.la));let ve=Q[4];ve!=null&&(c.Aa=ve,c.j.info("SVER="+c.Aa));let gn=Q[5];gn!=null&&typeof gn=="number"&&0<gn&&(d=1.5*gn,c.L=d,c.j.info("backChannelRequestTimeoutMs_="+d)),d=c;let Ne=s.g;if(Ne){let Si=Ne.g?Ne.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Si){var A=d.h;A.g||Si.indexOf("spdy")==-1&&Si.indexOf("quic")==-1&&Si.indexOf("h2")==-1||(A.j=A.l,A.g=new Set,A.h&&(po(A,A.h),A.h=null))}if(d.D){let wo=Ne.g?Ne.g.getResponseHeader("X-HTTP-Session-Id"):null;wo&&(d.ya=wo,te(d.I,d.D,wo))}}c.G=3,c.l&&c.l.ua(),c.ba&&(c.R=Date.now()-s.F,c.j.info("Handshake RTT: "+c.R+"ms")),d=c;var R=s;if(d.qa=wl(d,d.J?d.ia:null,d.W),R.K){Qc(d.h,R);var X=R,pe=d.L;pe&&(X.I=pe),X.B&&(ho(X),_i(X)),d.g=R}else pl(d);0<c.i.length&&Ai(c)}else Q[0]!="stop"&&Q[0]!="close"||qt(c,7);else c.G==3&&(Q[0]=="stop"||Q[0]=="close"?Q[0]=="stop"?qt(c,7):_o(c):Q[0]!="noop"&&c.l&&c.l.ta(Q),c.v=0)}}or(4)}catch{}}var pm=class{constructor(s,a){this.g=s,this.map=a}};function Kc(s){this.l=s||10,l.PerformanceNavigationTiming?(s=l.performance.getEntriesByType("navigation"),s=0<s.length&&(s[0].nextHopProtocol=="hq"||s[0].nextHopProtocol=="h2")):s=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=s?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Wc(s){return s.h?!0:s.g?s.g.size>=s.j:!1}function Hc(s){return s.h?1:s.g?s.g.size:0}function mo(s,a){return s.h?s.h==a:s.g?s.g.has(a):!1}function po(s,a){s.g?s.g.add(a):s.h=a}function Qc(s,a){s.h&&s.h==a?s.h=null:s.g&&s.g.has(a)&&s.g.delete(a)}Kc.prototype.cancel=function(){if(this.i=Jc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let s of this.g.values())s.cancel();this.g.clear()}};function Jc(s){if(s.h!=null)return s.i.concat(s.h.D);if(s.g!=null&&s.g.size!==0){let a=s.i;for(let c of s.g.values())a=a.concat(c.D);return a}return M(s.i)}function gm(s){if(s.V&&typeof s.V=="function")return s.V();if(typeof Map<"u"&&s instanceof Map||typeof Set<"u"&&s instanceof Set)return Array.from(s.values());if(typeof s=="string")return s.split("");if(h(s)){for(var a=[],c=s.length,d=0;d<c;d++)a.push(s[d]);return a}a=[],c=0;for(d in s)a[c++]=s[d];return a}function _m(s){if(s.na&&typeof s.na=="function")return s.na();if(!s.V||typeof s.V!="function"){if(typeof Map<"u"&&s instanceof Map)return Array.from(s.keys());if(!(typeof Set<"u"&&s instanceof Set)){if(h(s)||typeof s=="string"){var a=[];s=s.length;for(var c=0;c<s;c++)a.push(c);return a}a=[],c=0;for(let d in s)a[c++]=d;return a}}}function Yc(s,a){if(s.forEach&&typeof s.forEach=="function")s.forEach(a,void 0);else if(h(s)||typeof s=="string")Array.prototype.forEach.call(s,a,void 0);else for(var c=_m(s),d=gm(s),E=d.length,A=0;A<E;A++)a.call(void 0,d[A],c&&c[A],s)}var Xc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ym(s,a){if(s){s=s.split("&");for(var c=0;c<s.length;c++){var d=s[c].indexOf("="),E=null;if(0<=d){var A=s[c].substring(0,d);E=s[c].substring(d+1)}else A=s[c];a(A,E?decodeURIComponent(E.replace(/\+/g," ")):"")}}}function Bt(s){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,s instanceof Bt){this.h=s.h,yi(this,s.j),this.o=s.o,this.g=s.g,vi(this,s.s),this.l=s.l;var a=s.i,c=new dr;c.i=a.i,a.g&&(c.g=new Map(a.g),c.h=a.h),Zc(this,c),this.m=s.m}else s&&(a=String(s).match(Xc))?(this.h=!1,yi(this,a[1]||"",!0),this.o=lr(a[2]||""),this.g=lr(a[3]||"",!0),vi(this,a[4]),this.l=lr(a[5]||"",!0),Zc(this,a[6]||"",!0),this.m=lr(a[7]||"")):(this.h=!1,this.i=new dr(null,this.h))}Bt.prototype.toString=function(){var s=[],a=this.j;a&&s.push(hr(a,el,!0),":");var c=this.g;return(c||a=="file")&&(s.push("//"),(a=this.o)&&s.push(hr(a,el,!0),"@"),s.push(encodeURIComponent(String(c)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c=this.s,c!=null&&s.push(":",String(c))),(c=this.l)&&(this.g&&c.charAt(0)!="/"&&s.push("/"),s.push(hr(c,c.charAt(0)=="/"?Em:wm,!0))),(c=this.i.toString())&&s.push("?",c),(c=this.m)&&s.push("#",hr(c,Tm)),s.join("")};function tt(s){return new Bt(s)}function yi(s,a,c){s.j=c?lr(a,!0):a,s.j&&(s.j=s.j.replace(/:$/,""))}function vi(s,a){if(a){if(a=Number(a),isNaN(a)||0>a)throw Error("Bad port number "+a);s.s=a}else s.s=null}function Zc(s,a,c){a instanceof dr?(s.i=a,Am(s.i,s.h)):(c||(a=hr(a,Im)),s.i=new dr(a,s.h))}function te(s,a,c){s.i.set(a,c)}function wi(s){return te(s,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),s}function lr(s,a){return s?a?decodeURI(s.replace(/%25/g,"%2525")):decodeURIComponent(s):""}function hr(s,a,c){return typeof s=="string"?(s=encodeURI(s).replace(a,vm),c&&(s=s.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),s):null}function vm(s){return s=s.charCodeAt(0),"%"+(s>>4&15).toString(16)+(s&15).toString(16)}var el=/[#\/\?@]/g,wm=/[#\?:]/g,Em=/[#\?]/g,Im=/[#\?@]/g,Tm=/#/g;function dr(s,a){this.h=this.g=null,this.i=s||null,this.j=!!a}function gt(s){s.g||(s.g=new Map,s.h=0,s.i&&ym(s.i,function(a,c){s.add(decodeURIComponent(a.replace(/\+/g," ")),c)}))}n=dr.prototype,n.add=function(s,a){gt(this),this.i=null,s=mn(this,s);var c=this.g.get(s);return c||this.g.set(s,c=[]),c.push(a),this.h+=1,this};function tl(s,a){gt(s),a=mn(s,a),s.g.has(a)&&(s.i=null,s.h-=s.g.get(a).length,s.g.delete(a))}function nl(s,a){return gt(s),a=mn(s,a),s.g.has(a)}n.forEach=function(s,a){gt(this),this.g.forEach(function(c,d){c.forEach(function(E){s.call(a,E,d,this)},this)},this)},n.na=function(){gt(this);let s=Array.from(this.g.values()),a=Array.from(this.g.keys()),c=[];for(let d=0;d<a.length;d++){let E=s[d];for(let A=0;A<E.length;A++)c.push(a[d])}return c},n.V=function(s){gt(this);let a=[];if(typeof s=="string")nl(this,s)&&(a=a.concat(this.g.get(mn(this,s))));else{s=Array.from(this.g.values());for(let c=0;c<s.length;c++)a=a.concat(s[c])}return a},n.set=function(s,a){return gt(this),this.i=null,s=mn(this,s),nl(this,s)&&(this.h-=this.g.get(s).length),this.g.set(s,[a]),this.h+=1,this},n.get=function(s,a){return s?(s=this.V(s),0<s.length?String(s[0]):a):a};function rl(s,a,c){tl(s,a),0<c.length&&(s.i=null,s.g.set(mn(s,a),M(c)),s.h+=c.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let s=[],a=Array.from(this.g.keys());for(var c=0;c<a.length;c++){var d=a[c];let A=encodeURIComponent(String(d)),R=this.V(d);for(d=0;d<R.length;d++){var E=A;R[d]!==""&&(E+="="+encodeURIComponent(String(R[d]))),s.push(E)}}return this.i=s.join("&")};function mn(s,a){return a=String(a),s.j&&(a=a.toLowerCase()),a}function Am(s,a){a&&!s.j&&(gt(s),s.i=null,s.g.forEach(function(c,d){var E=d.toLowerCase();d!=E&&(tl(this,d),rl(this,E,c))},s)),s.j=a}function bm(s,a){let c=new ur;if(l.Image){let d=new Image;d.onload=S(_t,c,"TestLoadImage: loaded",!0,a,d),d.onerror=S(_t,c,"TestLoadImage: error",!1,a,d),d.onabort=S(_t,c,"TestLoadImage: abort",!1,a,d),d.ontimeout=S(_t,c,"TestLoadImage: timeout",!1,a,d),l.setTimeout(function(){d.ontimeout&&d.ontimeout()},1e4),d.src=s}else a(!1)}function Cm(s,a){let c=new ur,d=new AbortController,E=setTimeout(()=>{d.abort(),_t(c,"TestPingServer: timeout",!1,a)},1e4);fetch(s,{signal:d.signal}).then(A=>{clearTimeout(E),A.ok?_t(c,"TestPingServer: ok",!0,a):_t(c,"TestPingServer: server error",!1,a)}).catch(()=>{clearTimeout(E),_t(c,"TestPingServer: error",!1,a)})}function _t(s,a,c,d,E){try{E&&(E.onload=null,E.onerror=null,E.onabort=null,E.ontimeout=null),d(c)}catch{}}function Sm(){this.g=new cm}function Pm(s,a,c){let d=c||"";try{Yc(s,function(E,A){let R=E;f(E)&&(R=io(E)),a.push(d+A+"="+encodeURIComponent(R))})}catch(E){throw a.push(d+"type="+encodeURIComponent("_badmap")),E}}function fr(s){this.l=s.Ub||null,this.j=s.eb||!1}x(fr,so),fr.prototype.g=function(){return new Ei(this.l,this.j)},fr.prototype.i=function(s){return function(){return s}}({});function Ei(s,a){_e.call(this),this.D=s,this.o=a,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(Ei,_e),n=Ei.prototype,n.open=function(s,a){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=s,this.A=a,this.readyState=1,pr(this)},n.send=function(s){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let a={headers:this.u,method:this.B,credentials:this.m,cache:void 0};s&&(a.body=s),(this.D||l).fetch(new Request(this.A,a)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,mr(this)),this.readyState=0},n.Sa=function(s){if(this.g&&(this.l=s,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=s.headers,this.readyState=2,pr(this)),this.g&&(this.readyState=3,pr(this),this.g)))if(this.responseType==="arraybuffer")s.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in s){if(this.j=s.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;il(this)}else s.text().then(this.Ra.bind(this),this.ga.bind(this))};function il(s){s.j.read().then(s.Pa.bind(s)).catch(s.ga.bind(s))}n.Pa=function(s){if(this.g){if(this.o&&s.value)this.response.push(s.value);else if(!this.o){var a=s.value?s.value:new Uint8Array(0);(a=this.v.decode(a,{stream:!s.done}))&&(this.response=this.responseText+=a)}s.done?mr(this):pr(this),this.readyState==3&&il(this)}},n.Ra=function(s){this.g&&(this.response=this.responseText=s,mr(this))},n.Qa=function(s){this.g&&(this.response=s,mr(this))},n.ga=function(){this.g&&mr(this)};function mr(s){s.readyState=4,s.l=null,s.j=null,s.v=null,pr(s)}n.setRequestHeader=function(s,a){this.u.append(s,a)},n.getResponseHeader=function(s){return this.h&&this.h.get(s.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let s=[],a=this.h.entries();for(var c=a.next();!c.done;)c=c.value,s.push(c[0]+": "+c[1]),c=a.next();return s.join(`\r
`)};function pr(s){s.onreadystatechange&&s.onreadystatechange.call(s)}Object.defineProperty(Ei.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(s){this.m=s?"include":"same-origin"}});function sl(s){let a="";return ee(s,function(c,d){a+=d,a+=":",a+=c,a+=`\r
`}),a}function go(s,a,c){e:{for(d in c){var d=!1;break e}d=!0}d||(c=sl(c),typeof s=="string"?c!=null&&encodeURIComponent(String(c)):te(s,a,c))}function ie(s){_e.call(this),this.headers=new Map,this.o=s||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x(ie,_e);var Vm=/^https?$/i,Dm=["POST","PUT"];n=ie.prototype,n.Ha=function(s){this.J=s},n.ea=function(s,a,c,d){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+s);a=a?a.toUpperCase():"GET",this.D=s,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():uo.g(),this.v=this.o?Mc(this.o):Mc(uo),this.g.onreadystatechange=b(this.Ea,this);try{this.B=!0,this.g.open(a,String(s),!0),this.B=!1}catch(A){ol(this,A);return}if(s=c||"",c=new Map(this.headers),d)if(Object.getPrototypeOf(d)===Object.prototype)for(var E in d)c.set(E,d[E]);else if(typeof d.keys=="function"&&typeof d.get=="function")for(let A of d.keys())c.set(A,d.get(A));else throw Error("Unknown input type for opt_headers: "+String(d));d=Array.from(c.keys()).find(A=>A.toLowerCase()=="content-type"),E=l.FormData&&s instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Dm,a,void 0))||d||E||c.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[A,R]of c)this.g.setRequestHeader(A,R);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{cl(this),this.u=!0,this.g.send(s),this.u=!1}catch(A){ol(this,A)}};function ol(s,a){s.h=!1,s.g&&(s.j=!0,s.g.abort(),s.j=!1),s.l=a,s.m=5,al(s),Ii(s)}function al(s){s.A||(s.A=!0,Ae(s,"complete"),Ae(s,"error"))}n.abort=function(s){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=s||7,Ae(this,"complete"),Ae(this,"abort"),Ii(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ii(this,!0)),ie.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?ul(this):this.bb())},n.bb=function(){ul(this)};function ul(s){if(s.h&&typeof u<"u"&&(!s.v[1]||nt(s)!=4||s.Z()!=2)){if(s.u&&nt(s)==4)Dc(s.Ea,0,s);else if(Ae(s,"readystatechange"),nt(s)==4){s.h=!1;try{let R=s.Z();e:switch(R){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var a=!0;break e;default:a=!1}var c;if(!(c=a)){var d;if(d=R===0){var E=String(s.D).match(Xc)[1]||null;!E&&l.self&&l.self.location&&(E=l.self.location.protocol.slice(0,-1)),d=!Vm.test(E?E.toLowerCase():"")}c=d}if(c)Ae(s,"complete"),Ae(s,"success");else{s.m=6;try{var A=2<nt(s)?s.g.statusText:""}catch{A=""}s.l=A+" ["+s.Z()+"]",al(s)}}finally{Ii(s)}}}}function Ii(s,a){if(s.g){cl(s);let c=s.g,d=s.v[0]?()=>{}:null;s.g=null,s.v=null,a||Ae(s,"ready");try{c.onreadystatechange=d}catch{}}}function cl(s){s.I&&(l.clearTimeout(s.I),s.I=null)}n.isActive=function(){return!!this.g};function nt(s){return s.g?s.g.readyState:0}n.Z=function(){try{return 2<nt(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(s){if(this.g){var a=this.g.responseText;return s&&a.indexOf(s)==0&&(a=a.substring(s.length)),um(a)}};function ll(s){try{if(!s.g)return null;if("response"in s.g)return s.g.response;switch(s.H){case"":case"text":return s.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in s.g)return s.g.mozResponseArrayBuffer}return null}catch{return null}}function Rm(s){let a={};s=(s.g&&2<=nt(s)&&s.g.getAllResponseHeaders()||"").split(`\r
`);for(let d=0;d<s.length;d++){if(z(s[d]))continue;var c=v(s[d]);let E=c[0];if(c=c[1],typeof c!="string")continue;c=c.trim();let A=a[E]||[];a[E]=A,A.push(c)}w(a,function(d){return d.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function gr(s,a,c){return c&&c.internalChannelParams&&c.internalChannelParams[s]||a}function hl(s){this.Aa=0,this.i=[],this.j=new ur,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=gr("failFast",!1,s),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=gr("baseRetryDelayMs",5e3,s),this.cb=gr("retryDelaySeedMs",1e4,s),this.Wa=gr("forwardChannelMaxRetries",2,s),this.wa=gr("forwardChannelRequestTimeoutMs",2e4,s),this.pa=s&&s.xmlHttpFactory||void 0,this.Xa=s&&s.Tb||void 0,this.Ca=s&&s.useFetchStreams||!1,this.L=void 0,this.J=s&&s.supportsCrossDomainXhr||!1,this.K="",this.h=new Kc(s&&s.concurrentRequestLimit),this.Da=new Sm,this.P=s&&s.fastHandshake||!1,this.O=s&&s.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=s&&s.Rb||!1,s&&s.xa&&this.j.xa(),s&&s.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&s&&s.detectBufferingProxy||!1,this.ja=void 0,s&&s.longPollingTimeout&&0<s.longPollingTimeout&&(this.ja=s.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=hl.prototype,n.la=8,n.G=1,n.connect=function(s,a,c,d){be(0),this.W=s,this.H=a||{},c&&d!==void 0&&(this.H.OSID=c,this.H.OAID=d),this.F=this.X,this.I=wl(this,null,this.W),Ai(this)};function _o(s){if(dl(s),s.G==3){var a=s.U++,c=tt(s.I);if(te(c,"SID",s.K),te(c,"RID",a),te(c,"TYPE","terminate"),_r(s,c),a=new pt(s,s.j,a),a.L=2,a.v=wi(tt(c)),c=!1,l.navigator&&l.navigator.sendBeacon)try{c=l.navigator.sendBeacon(a.v.toString(),"")}catch{}!c&&l.Image&&(new Image().src=a.v,c=!0),c||(a.g=El(a.j,null),a.g.ea(a.v)),a.F=Date.now(),_i(a)}vl(s)}function Ti(s){s.g&&(vo(s),s.g.cancel(),s.g=null)}function dl(s){Ti(s),s.u&&(l.clearTimeout(s.u),s.u=null),bi(s),s.h.cancel(),s.s&&(typeof s.s=="number"&&l.clearTimeout(s.s),s.s=null)}function Ai(s){if(!Wc(s.h)&&!s.s){s.s=!0;var a=s.Ga;er||Ac(),tr||(er(),tr=!0),Qs.add(a,s),s.B=0}}function xm(s,a){return Hc(s.h)>=s.h.j-(s.s?1:0)?!1:s.s?(s.i=a.D.concat(s.i),!0):s.G==1||s.G==2||s.B>=(s.Va?0:s.Wa)?!1:(s.s=ar(b(s.Ga,s,a),yl(s,s.B)),s.B++,!0)}n.Ga=function(s){if(this.s)if(this.s=null,this.G==1){if(!s){this.U=Math.floor(1e5*Math.random()),s=this.U++;let E=new pt(this,this.j,s),A=this.o;if(this.S&&(A?(A=m(A),y(A,this.S)):A=this.S),this.m!==null||this.O||(E.H=A,A=null),this.P)e:{for(var a=0,c=0;c<this.i.length;c++){t:{var d=this.i[c];if("__data__"in d.map&&(d=d.map.__data__,typeof d=="string")){d=d.length;break t}d=void 0}if(d===void 0)break;if(a+=d,4096<a){a=c;break e}if(a===4096||c===this.i.length-1){a=c+1;break e}}a=1e3}else a=1e3;a=ml(this,E,a),c=tt(this.I),te(c,"RID",s),te(c,"CVER",22),this.D&&te(c,"X-HTTP-Session-Id",this.D),_r(this,c),A&&(this.O?a="headers="+encodeURIComponent(String(sl(A)))+"&"+a:this.m&&go(c,this.m,A)),po(this.h,E),this.Ua&&te(c,"TYPE","init"),this.P?(te(c,"$req",a),te(c,"SID","null"),E.T=!0,lo(E,c,null)):lo(E,c,a),this.G=2}}else this.G==3&&(s?fl(this,s):this.i.length==0||Wc(this.h)||fl(this))};function fl(s,a){var c;a?c=a.l:c=s.U++;let d=tt(s.I);te(d,"SID",s.K),te(d,"RID",c),te(d,"AID",s.T),_r(s,d),s.m&&s.o&&go(d,s.m,s.o),c=new pt(s,s.j,c,s.B+1),s.m===null&&(c.H=s.o),a&&(s.i=a.D.concat(s.i)),a=ml(s,c,1e3),c.I=Math.round(.5*s.wa)+Math.round(.5*s.wa*Math.random()),po(s.h,c),lo(c,d,a)}function _r(s,a){s.H&&ee(s.H,function(c,d){te(a,d,c)}),s.l&&Yc({},function(c,d){te(a,d,c)})}function ml(s,a,c){c=Math.min(s.i.length,c);var d=s.l?b(s.l.Na,s.l,s):null;e:{var E=s.i;let A=-1;for(;;){let R=["count="+c];A==-1?0<c?(A=E[0].g,R.push("ofs="+A)):A=0:R.push("ofs="+A);let X=!0;for(let pe=0;pe<c;pe++){let Q=E[pe].g,ye=E[pe].map;if(Q-=A,0>Q)A=Math.max(0,E[pe].g-100),X=!1;else try{Pm(ye,R,"req"+Q+"_")}catch{d&&d(ye)}}if(X){d=R.join("&");break e}}}return s=s.i.splice(0,c),a.D=s,d}function pl(s){if(!s.g&&!s.u){s.Y=1;var a=s.Fa;er||Ac(),tr||(er(),tr=!0),Qs.add(a,s),s.v=0}}function yo(s){return s.g||s.u||3<=s.v?!1:(s.Y++,s.u=ar(b(s.Fa,s),yl(s,s.v)),s.v++,!0)}n.Fa=function(){if(this.u=null,gl(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var s=2*this.R;this.j.info("BP detection timer enabled: "+s),this.A=ar(b(this.ab,this),s)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,be(10),Ti(this),gl(this))};function vo(s){s.A!=null&&(l.clearTimeout(s.A),s.A=null)}function gl(s){s.g=new pt(s,s.j,"rpc",s.Y),s.m===null&&(s.g.H=s.o),s.g.O=0;var a=tt(s.qa);te(a,"RID","rpc"),te(a,"SID",s.K),te(a,"AID",s.T),te(a,"CI",s.F?"0":"1"),!s.F&&s.ja&&te(a,"TO",s.ja),te(a,"TYPE","xmlhttp"),_r(s,a),s.m&&s.o&&go(a,s.m,s.o),s.L&&(s.g.I=s.L);var c=s.g;s=s.ia,c.L=1,c.v=wi(tt(a)),c.m=null,c.P=!0,$c(c,s)}n.Za=function(){this.C!=null&&(this.C=null,Ti(this),yo(this),be(19))};function bi(s){s.C!=null&&(l.clearTimeout(s.C),s.C=null)}function _l(s,a){var c=null;if(s.g==a){bi(s),vo(s),s.g=null;var d=2}else if(mo(s.h,a))c=a.D,Qc(s.h,a),d=1;else return;if(s.G!=0){if(a.o)if(d==1){c=a.m?a.m.length:0,a=Date.now()-a.F;var E=s.B;d=mi(),Ae(d,new Uc(d,c)),Ai(s)}else pl(s);else if(E=a.s,E==3||E==0&&0<a.X||!(d==1&&xm(s,a)||d==2&&yo(s)))switch(c&&0<c.length&&(a=s.h,a.i=a.i.concat(c)),E){case 1:qt(s,5);break;case 4:qt(s,10);break;case 3:qt(s,6);break;default:qt(s,2)}}}function yl(s,a){let c=s.Ta+Math.floor(Math.random()*s.cb);return s.isActive()||(c*=2),c*a}function qt(s,a){if(s.j.info("Error code "+a),a==2){var c=b(s.fb,s),d=s.Xa;let E=!d;d=new Bt(d||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||yi(d,"https"),wi(d),E?bm(d.toString(),c):Cm(d.toString(),c)}else be(2);s.G=0,s.l&&s.l.sa(a),vl(s),dl(s)}n.fb=function(s){s?(this.j.info("Successfully pinged google.com"),be(2)):(this.j.info("Failed to ping google.com"),be(1))};function vl(s){if(s.G=0,s.ka=[],s.l){let a=Jc(s.h);(a.length!=0||s.i.length!=0)&&(D(s.ka,a),D(s.ka,s.i),s.h.i.length=0,M(s.i),s.i.length=0),s.l.ra()}}function wl(s,a,c){var d=c instanceof Bt?tt(c):new Bt(c);if(d.g!="")a&&(d.g=a+"."+d.g),vi(d,d.s);else{var E=l.location;d=E.protocol,a=a?a+"."+E.hostname:E.hostname,E=+E.port;var A=new Bt(null);d&&yi(A,d),a&&(A.g=a),E&&vi(A,E),c&&(A.l=c),d=A}return c=s.D,a=s.ya,c&&a&&te(d,c,a),te(d,"VER",s.la),_r(s,d),d}function El(s,a,c){if(a&&!s.J)throw Error("Can't create secondary domain capable XhrIo object.");return a=s.Ca&&!s.pa?new ie(new fr({eb:c})):new ie(s.pa),a.Ha(s.J),a}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Il(){}n=Il.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Ci(){}Ci.prototype.g=function(s,a){return new Ve(s,a)};function Ve(s,a){_e.call(this),this.g=new hl(a),this.l=s,this.h=a&&a.messageUrlParams||null,s=a&&a.messageHeaders||null,a&&a.clientProtocolHeaderRequired&&(s?s["X-Client-Protocol"]="webchannel":s={"X-Client-Protocol":"webchannel"}),this.g.o=s,s=a&&a.initMessageHeaders||null,a&&a.messageContentType&&(s?s["X-WebChannel-Content-Type"]=a.messageContentType:s={"X-WebChannel-Content-Type":a.messageContentType}),a&&a.va&&(s?s["X-WebChannel-Client-Profile"]=a.va:s={"X-WebChannel-Client-Profile":a.va}),this.g.S=s,(s=a&&a.Sb)&&!z(s)&&(this.g.m=s),this.v=a&&a.supportsCrossDomainXhr||!1,this.u=a&&a.sendRawJson||!1,(a=a&&a.httpSessionIdParam)&&!z(a)&&(this.g.D=a,s=this.h,s!==null&&a in s&&(s=this.h,a in s&&delete s[a])),this.j=new pn(this)}x(Ve,_e),Ve.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ve.prototype.close=function(){_o(this.g)},Ve.prototype.o=function(s){var a=this.g;if(typeof s=="string"){var c={};c.__data__=s,s=c}else this.u&&(c={},c.__data__=io(s),s=c);a.i.push(new pm(a.Ya++,s)),a.G==3&&Ai(a)},Ve.prototype.N=function(){this.g.l=null,delete this.j,_o(this.g),delete this.g,Ve.aa.N.call(this)};function Tl(s){oo.call(this),s.__headers__&&(this.headers=s.__headers__,this.statusCode=s.__status__,delete s.__headers__,delete s.__status__);var a=s.__sm__;if(a){e:{for(let c in a){s=c;break e}s=void 0}(this.i=s)&&(s=this.i,a=a!==null&&s in a?a[s]:void 0),this.data=a}else this.data=s}x(Tl,oo);function Al(){ao.call(this),this.status=1}x(Al,ao);function pn(s){this.g=s}x(pn,Il),pn.prototype.ua=function(){Ae(this.g,"a")},pn.prototype.ta=function(s){Ae(this.g,new Tl(s))},pn.prototype.sa=function(s){Ae(this.g,new Al)},pn.prototype.ra=function(){Ae(this.g,"b")},Ci.prototype.createWebChannel=Ci.prototype.g,Ve.prototype.send=Ve.prototype.o,Ve.prototype.open=Ve.prototype.m,Ve.prototype.close=Ve.prototype.close,Zo=ut.createWebChannelTransport=function(){return new Ci},Xo=ut.getStatEventTarget=function(){return mi()},Yo=ut.Event=Ut,ji=ut.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},pi.NO_ERROR=0,pi.TIMEOUT=8,pi.HTTP_ERROR=6,xr=ut.ErrorCode=pi,jc.COMPLETE="complete",Jo=ut.EventType=jc,Nc.EventType=sr,sr.OPEN="a",sr.CLOSE="b",sr.ERROR="c",sr.MESSAGE="d",_e.prototype.listen=_e.prototype.K,An=ut.WebChannel=Nc,Qo=ut.FetchXmlHttpFactory=fr,ie.prototype.listenOnce=ie.prototype.L,ie.prototype.getLastError=ie.prototype.Ka,ie.prototype.getLastErrorCode=ie.prototype.Ba,ie.prototype.getStatus=ie.prototype.Z,ie.prototype.getResponseJson=ie.prototype.Oa,ie.prototype.getResponseText=ie.prototype.oa,ie.prototype.send=ie.prototype.ea,ie.prototype.setWithCredentials=ie.prototype.Ha,Ho=ut.XhrIo=ie}).apply(typeof Ui<"u"?Ui:typeof self<"u"?self:typeof window<"u"?window:{});var lh="@firebase/firestore";var me=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};me.UNAUTHENTICATED=new me(null),me.GOOGLE_CREDENTIALS=new me("google-credentials-uid"),me.FIRST_PARTY=new me("first-party-uid"),me.MOCK_USER=new me("mock-user");var $n="10.13.1";var tn=new xi("@firebase/firestore");function kr(){return tn.logLevel}function N(n,...e){if(tn.logLevel<=st.DEBUG){let t=e.map(ju);tn.debug(`Firestore (${$n}): ${n}`,...t)}}function lt(n,...e){if(tn.logLevel<=st.ERROR){let t=e.map(ju);tn.error(`Firestore (${$n}): ${n}`,...t)}}function Rn(n,...e){if(tn.logLevel<=st.WARN){let t=e.map(ju);tn.warn(`Firestore (${$n}): ${n}`,...t)}}function ju(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function L(n="Unexpected state"){let e=`FIRESTORE (${$n}) INTERNAL ASSERTION FAILED: `+n;throw lt(e),new Error(e)}function Z(n,e){n||L()}function B(n,e){return n}var C={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},k=class extends Yl{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var ct=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var zi=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},ia=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(me.UNAUTHENTICATED))}shutdown(){}},sa=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},oa=class{constructor(e){this.t=e,this.currentUser=me.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve(),o=new ct;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new ct,e.enqueueRetryable(()=>i(this.currentUser))};let u=()=>{let h=o;e.enqueueRetryable(()=>V(this,null,function*(){yield h.promise,yield i(this.currentUser)}))},l=h=>{N("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.auth.addAuthTokenListener(this.o),u()};this.t.onInit(h=>l(h)),setTimeout(()=>{if(!this.auth){let h=this.t.getImmediate({optional:!0});h?l(h):(N("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new ct)}},0),u()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(N("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Z(typeof r.accessToken=="string"),new zi(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return Z(e===null||typeof e=="string"),new me(e)}},aa=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=me.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},ua=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new aa(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(me.FIRST_PARTY))}shutdown(){}invalidateToken(){}},ca=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},la=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let r=o=>{o.error!=null&&N("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let u=o.token!==this.R;return this.R=o.token,N("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{N("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.A.getImmediate({optional:!0});o?i(o):N("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Z(typeof t.token=="string"),this.R=t.token,new ca(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function $p(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var Ki=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=$p(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%e.length))}return r}};function J(n,e){return n<e?-1:n>e?1:0}function xn(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var fe=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new k(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new k(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new k(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new k(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?J(this.nanoseconds,e.nanoseconds):J(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var q=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new fe(0,0))}static max(){return new n(new fe(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Wi=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&L(),r===void 0?r=e.length-t:r>e.length-t&&L(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=e.get(i),u=t.get(i);if(o<u)return-1;if(o>u)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},re=class n extends Wi{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new k(C.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},Gp=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Re=class n extends Wi{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return Gp.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new k(C.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},u=!1;for(;i<e.length;){let l=e[i];if(l==="\\"){if(i+1===e.length)throw new k(C.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new k(C.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else l==="`"?(u=!u,i++):l!=="."||u?(r+=l,i++):(o(),i++)}if(o(),u)throw new k(C.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var F=class n{constructor(e){this.path=e}static fromPath(e){return new n(re.fromString(e))}static fromName(e){return new n(re.fromString(e).popFirst(5))}static empty(){return new n(re.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&re.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return re.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new re(e.slice()))}};var ha=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};ha.UNKNOWN_ID=-1;function zp(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=q.fromTimestamp(r===1e9?new fe(t+1,0):new fe(t,r));return new nn(i,F.empty(),e)}function Kp(n){return new nn(n.readTime,n.key,-1)}var nn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(q.min(),F.empty(),-1)}static max(){return new n(q.max(),F.empty(),-1)}};function Wp(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=F.comparator(n.documentKey,e.documentKey),t!==0?t:J(n.largestBatchId,e.largestBatchId))}var Hp="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",da=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Xr(n){return V(this,null,function*(){if(n.code!==C.FAILED_PRECONDITION||n.message!==Hp)throw n;N("LocalStore","Unexpectedly lost primary lease")})}var P=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&L(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,u=!1;e.forEach(l=>{++i,l.next(()=>{++o,u&&o===i&&t()},h=>r(h))}),u=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,u=new Array(o),l=0;for(let h=0;h<o;h++){let f=h;t(e[f]).next(p=>{u[f]=p,++l,l===o&&r(u)},p=>i(p))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};function Qp(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Zr(n){return n.name==="IndexedDbTransactionError"}var zh=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Is(n){return n==null}function jr(n){return n===0&&1/n==-1/0}function Jp(n){return typeof n=="number"&&Number.isInteger(n)&&!jr(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var Yp=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],B0=[...Yp,"documentOverlays"],Xp=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Zp=Xp,eg=[...Zp,"indexConfiguration","indexState","indexEntries"];var q0=[...eg,"globals"];function hh(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Gn(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Kh(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var ue=class n{constructor(e,t){this.comparator=e,this.root=t||Je.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Je.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Je.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Pn(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Pn(this.root,e,this.comparator,!1)}getReverseIterator(){return new Pn(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Pn(this.root,e,this.comparator,!0)}},Pn=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Je=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw L();let e=this.left.check();if(e!==this.right.check())throw L();return e+(this.isRed()?0:1)}};Je.EMPTY=null,Je.RED=!0,Je.BLACK=!1;Je.EMPTY=new class{constructor(){this.size=0}get key(){throw L()}get value(){throw L()}get color(){throw L()}get left(){throw L()}get right(){throw L()}copy(e,t,r,i,o){return this}insert(e,t,r){return new Je(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ie=class n{constructor(e){this.comparator=e,this.data=new ue(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Hi(this.data.getIterator())}getIteratorFrom(e){return new Hi(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Hi=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Qe=class n{constructor(e){this.fields=e,e.sort(Re.comparator)}static empty(){return new n([])}unionWith(e){let t=new Ie(Re.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return xn(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Qi=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Te=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Qi("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let o="";for(let u=0;u<i.length;++u)o+=String.fromCharCode(i[u]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return J(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Te.EMPTY_BYTE_STRING=new Te("");var tg=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ht(n){if(Z(!!n),typeof n=="string"){let e=0,t=tg.exec(n);if(Z(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ne(n.seconds),nanos:ne(n.nanos)}}function ne(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function xt(n){return typeof n=="string"?Te.fromBase64String(n):Te.fromUint8Array(n)}function Bu(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function qu(n){let e=n.mapValue.fields.__previous_value__;return Bu(e)?qu(e):e}function Br(n){let e=ht(n.mapValue.fields.__local_write_time__.timestampValue);return new fe(e.seconds,e.nanos)}var fa=class{constructor(e,t,r,i,o,u,l,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=u,this.autoDetectLongPolling=l,this.longPollingOptions=h,this.useFetchStreams=f}},Ji=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Bi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function rn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Bu(n)?4:Hh(n)?9007199254740991:Wh(n)?10:11:L()}function Ze(n,e){if(n===e)return!0;let t=rn(n);if(t!==rn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Br(n).isEqual(Br(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let u=ht(i.timestampValue),l=ht(o.timestampValue);return u.seconds===l.seconds&&u.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,o){return xt(i.bytesValue).isEqual(xt(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,o){return ne(i.geoPointValue.latitude)===ne(o.geoPointValue.latitude)&&ne(i.geoPointValue.longitude)===ne(o.geoPointValue.longitude)}(n,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return ne(i.integerValue)===ne(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let u=ne(i.doubleValue),l=ne(o.doubleValue);return u===l?jr(u)===jr(l):isNaN(u)&&isNaN(l)}return!1}(n,e);case 9:return xn(n.arrayValue.values||[],e.arrayValue.values||[],Ze);case 10:case 11:return function(i,o){let u=i.mapValue.fields||{},l=o.mapValue.fields||{};if(hh(u)!==hh(l))return!1;for(let h in u)if(u.hasOwnProperty(h)&&(l[h]===void 0||!Ze(u[h],l[h])))return!1;return!0}(n,e);default:return L()}}function qr(n,e){return(n.values||[]).find(t=>Ze(t,e))!==void 0}function kn(n,e){if(n===e)return 0;let t=rn(n),r=rn(e);if(t!==r)return J(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return J(n.booleanValue,e.booleanValue);case 2:return function(o,u){let l=ne(o.integerValue||o.doubleValue),h=ne(u.integerValue||u.doubleValue);return l<h?-1:l>h?1:l===h?0:isNaN(l)?isNaN(h)?0:-1:1}(n,e);case 3:return dh(n.timestampValue,e.timestampValue);case 4:return dh(Br(n),Br(e));case 5:return J(n.stringValue,e.stringValue);case 6:return function(o,u){let l=xt(o),h=xt(u);return l.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(o,u){let l=o.split("/"),h=u.split("/");for(let f=0;f<l.length&&f<h.length;f++){let p=J(l[f],h[f]);if(p!==0)return p}return J(l.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,u){let l=J(ne(o.latitude),ne(u.latitude));return l!==0?l:J(ne(o.longitude),ne(u.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return fh(n.arrayValue,e.arrayValue);case 10:return function(o,u){var l,h,f,p;let T=o.fields||{},b=u.fields||{},S=(l=T.value)===null||l===void 0?void 0:l.arrayValue,x=(h=b.value)===null||h===void 0?void 0:h.arrayValue,M=J(((f=S?.values)===null||f===void 0?void 0:f.length)||0,((p=x?.values)===null||p===void 0?void 0:p.length)||0);return M!==0?M:fh(S,x)}(n.mapValue,e.mapValue);case 11:return function(o,u){if(o===Bi.mapValue&&u===Bi.mapValue)return 0;if(o===Bi.mapValue)return 1;if(u===Bi.mapValue)return-1;let l=o.fields||{},h=Object.keys(l),f=u.fields||{},p=Object.keys(f);h.sort(),p.sort();for(let T=0;T<h.length&&T<p.length;++T){let b=J(h[T],p[T]);if(b!==0)return b;let S=kn(l[h[T]],f[p[T]]);if(S!==0)return S}return J(h.length,p.length)}(n.mapValue,e.mapValue);default:throw L()}}function dh(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return J(n,e);let t=ht(n),r=ht(e),i=J(t.seconds,r.seconds);return i!==0?i:J(t.nanos,r.nanos)}function fh(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=kn(t[i],r[i]);if(o)return o}return J(t.length,r.length)}function Mn(n){return ma(n)}function ma(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=ht(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return xt(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return F.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=ma(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let u of r)o?o=!1:i+=",",i+=`${u}:${ma(t.fields[u])}`;return i+"}"}(n.mapValue):L()}function mh(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function pa(n){return!!n&&"integerValue"in n}function $u(n){return!!n&&"arrayValue"in n}function ph(n){return!!n&&"nullValue"in n}function gh(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function $i(n){return!!n&&"mapValue"in n}function Wh(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Nr(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Gn(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Nr(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Nr(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Hh(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var Le=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!$i(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Nr(t)}setAll(e){let t=Re.emptyPath(),r={},i=[];e.forEach((u,l)=>{if(!t.isImmediateParentOf(l)){let h=this.getFieldsMap(t);this.applyChanges(h,r,i),r={},i=[],t=l.popLast()}u?r[l.lastSegment()]=Nr(u):i.push(l.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());$i(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ze(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];$i(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Gn(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(Nr(this.value))}};function Qh(n){let e=[];return Gn(n.fields,(t,r)=>{let i=new Re([t]);if($i(r)){let o=Qh(r.mapValue).fields;if(o.length===0)e.push(i);else for(let u of o)e.push(i.child(u))}else e.push(i)}),new Qe(e)}var Ue=class n{constructor(e,t,r,i,o,u,l){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=u,this.documentState=l}static newInvalidDocument(e){return new n(e,0,q.min(),q.min(),q.min(),Le.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,q.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,q.min(),q.min(),Le.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,q.min(),q.min(),Le.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(q.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Le.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Le.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=q.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Nn=class{constructor(e,t){this.position=e,this.inclusive=t}};function _h(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],u=n.position[i];if(o.field.isKeyField()?r=F.comparator(F.fromName(u.referenceValue),t.key):r=kn(u,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function yh(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ze(n.position[t],e.position[t]))return!1;return!0}var sn=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function ng(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Yi=class{},de=class n extends Yi{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new _a(e,t,r):t==="array-contains"?new wa(e,r):t==="in"?new Ea(e,r):t==="not-in"?new Ia(e,r):t==="array-contains-any"?new Ta(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new ya(e,r):new va(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(kn(t,this.value)):t!==null&&rn(this.value)===rn(t)&&this.matchesComparison(kn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return L()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},je=class n extends Yi{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return Jh(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function Jh(n){return n.op==="and"}function Yh(n){return rg(n)&&Jh(n)}function rg(n){for(let e of n.filters)if(e instanceof je)return!1;return!0}function ga(n){if(n instanceof de)return n.field.canonicalString()+n.op.toString()+Mn(n.value);if(Yh(n))return n.filters.map(e=>ga(e)).join(",");{let e=n.filters.map(t=>ga(t)).join(",");return`${n.op}(${e})`}}function Xh(n,e){return n instanceof de?function(r,i){return i instanceof de&&r.op===i.op&&r.field.isEqual(i.field)&&Ze(r.value,i.value)}(n,e):n instanceof je?function(r,i){return i instanceof je&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,u,l)=>o&&Xh(u,i.filters[l]),!0):!1}(n,e):void L()}function Zh(n){return n instanceof de?function(t){return`${t.field.canonicalString()} ${t.op} ${Mn(t.value)}`}(n):n instanceof je?function(t){return t.op.toString()+" {"+t.getFilters().map(Zh).join(" ,")+"}"}(n):"Filter"}var _a=class extends de{constructor(e,t,r){super(e,t,r),this.key=F.fromName(r.referenceValue)}matches(e){let t=F.comparator(e.key,this.key);return this.matchesComparison(t)}},ya=class extends de{constructor(e,t){super(e,"in",t),this.keys=ed("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},va=class extends de{constructor(e,t){super(e,"not-in",t),this.keys=ed("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function ed(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>F.fromName(r.referenceValue))}var wa=class extends de{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return $u(t)&&qr(t.arrayValue,this.value)}},Ea=class extends de{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&qr(this.value.arrayValue,t)}},Ia=class extends de{constructor(e,t){super(e,"not-in",t)}matches(e){if(qr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!qr(this.value.arrayValue,t)}},Ta=class extends de{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!$u(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>qr(this.value.arrayValue,r))}};var Aa=class{constructor(e,t=null,r=[],i=[],o=null,u=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=u,this.endAt=l,this.ue=null}};function vh(n,e=null,t=[],r=[],i=null,o=null,u=null){return new Aa(n,e,t,r,i,o,u)}function Gu(n){let e=B(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>ga(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),Is(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Mn(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Mn(r)).join(",")),e.ue=t}return e.ue}function zu(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!ng(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Xh(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!yh(n.startAt,e.startAt)&&yh(n.endAt,e.endAt)}function ba(n){return F.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var kt=class{constructor(e,t=null,r=[],i=[],o=null,u="F",l=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=u,this.startAt=l,this.endAt=h,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function ig(n,e,t,r,i,o,u,l){return new kt(n,e,t,r,i,o,u,l)}function Ku(n){return new kt(n)}function wh(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function td(n){return n.collectionGroup!==null}function Fr(n){let e=B(n);if(e.ce===null){e.ce=[];let t=new Set;for(let o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let l=new Ie(Re.comparator);return u.filters.forEach(h=>{h.getFlattenedFilters().forEach(f=>{f.isInequality()&&(l=l.add(f.field))})}),l})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new sn(o,r))}),t.has(Re.keyField().canonicalString())||e.ce.push(new sn(Re.keyField(),r))}return e.ce}function Ye(n){let e=B(n);return e.le||(e.le=sg(e,Fr(n))),e.le}function sg(n,e){if(n.limitType==="F")return vh(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new sn(i.field,o)});let t=n.endAt?new Nn(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Nn(n.startAt.position,n.startAt.inclusive):null;return vh(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Ca(n,e){let t=n.filters.concat([e]);return new kt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Sa(n,e,t){return new kt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Ts(n,e){return zu(Ye(n),Ye(e))&&n.limitType===e.limitType}function nd(n){return`${Gu(Ye(n))}|lt:${n.limitType}`}function bn(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>Zh(i)).join(", ")}]`),Is(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(u){return`${u.field.canonicalString()} (${u.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Mn(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Mn(i)).join(",")),`Target(${r})`}(Ye(n))}; limitType=${n.limitType})`}function As(n,e){return e.isFoundDocument()&&function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):F.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,e)&&function(r,i){for(let o of Fr(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(u,l,h){let f=_h(u,l,h);return u.inclusive?f<=0:f<0}(r.startAt,Fr(r),i)||r.endAt&&!function(u,l,h){let f=_h(u,l,h);return u.inclusive?f>=0:f>0}(r.endAt,Fr(r),i))}(n,e)}function og(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function rd(n){return(e,t)=>{let r=!1;for(let i of Fr(n)){let o=ag(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function ag(n,e,t){let r=n.field.isKeyField()?F.comparator(e.key,t.key):function(o,u,l){let h=u.data.field(o),f=l.data.field(o);return h!==null&&f!==null?kn(h,f):L()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return L()}}var Mt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Gn(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return Kh(this.inner)}size(){return this.innerSize}};var ug=new ue(F.comparator);function dt(){return ug}var id=new ue(F.comparator);function Mr(...n){let e=id;for(let t of n)e=e.insert(t.key,t);return e}function sd(n){let e=id;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Yt(){return Or()}function od(){return Or()}function Or(){return new Mt(n=>n.toString(),(n,e)=>n.isEqual(e))}var cg=new ue(F.comparator),lg=new Ie(F.comparator);function K(...n){let e=lg;for(let t of n)e=e.add(t);return e}var hg=new Ie(J);function dg(){return hg}function Wu(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:jr(e)?"-0":e}}function ad(n){return{integerValue:""+n}}function fg(n,e){return Jp(e)?ad(e):Wu(n,e)}var Fn=class{constructor(){this._=void 0}};function mg(n,e,t){return n instanceof On?function(i,o){let u={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&Bu(o)&&(o=qu(o)),o&&(u.fields.__previous_value__=o),{mapValue:u}}(t,e):n instanceof on?cd(n,e):n instanceof an?ld(n,e):function(i,o){let u=ud(i,o),l=Eh(u)+Eh(i.Pe);return pa(u)&&pa(i.Pe)?ad(l):Wu(i.serializer,l)}(n,e)}function pg(n,e,t){return n instanceof on?cd(n,e):n instanceof an?ld(n,e):t}function ud(n,e){return n instanceof Ln?function(r){return pa(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}var On=class extends Fn{},on=class extends Fn{constructor(e){super(),this.elements=e}};function cd(n,e){let t=hd(e);for(let r of n.elements)t.some(i=>Ze(i,r))||t.push(r);return{arrayValue:{values:t}}}var an=class extends Fn{constructor(e){super(),this.elements=e}};function ld(n,e){let t=hd(e);for(let r of n.elements)t=t.filter(i=>!Ze(i,r));return{arrayValue:{values:t}}}var Ln=class extends Fn{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function Eh(n){return ne(n.integerValue||n.doubleValue)}function hd(n){return $u(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function gg(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof on&&i instanceof on||r instanceof an&&i instanceof an?xn(r.elements,i.elements,Ze):r instanceof Ln&&i instanceof Ln?Ze(r.Pe,i.Pe):r instanceof On&&i instanceof On}(n.transform,e.transform)}var Pa=class{constructor(e,t){this.version=e,this.transformResults=t}},en=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Gi(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Un=class{};function dd(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Xi(n.key,en.none()):new un(n.key,n.data,en.none());{let t=n.data,r=Le.empty(),i=new Ie(Re.comparator);for(let o of e.fields)if(!i.has(o)){let u=t.field(o);u===null&&o.length>1&&(o=o.popLast(),u=t.field(o)),u===null?r.delete(o):r.set(o,u),i=i.add(o)}return new ft(n.key,r,new Qe(i.toArray()),en.none())}}function _g(n,e,t){n instanceof un?function(i,o,u){let l=i.value.clone(),h=Th(i.fieldTransforms,o,u.transformResults);l.setAll(h),o.convertToFoundDocument(u.version,l).setHasCommittedMutations()}(n,e,t):n instanceof ft?function(i,o,u){if(!Gi(i.precondition,o))return void o.convertToUnknownDocument(u.version);let l=Th(i.fieldTransforms,o,u.transformResults),h=o.data;h.setAll(fd(i)),h.setAll(l),o.convertToFoundDocument(u.version,h).setHasCommittedMutations()}(n,e,t):function(i,o,u){o.convertToNoDocument(u.version).setHasCommittedMutations()}(0,e,t)}function Lr(n,e,t,r){return n instanceof un?function(o,u,l,h){if(!Gi(o.precondition,u))return l;let f=o.value.clone(),p=Ah(o.fieldTransforms,h,u);return f.setAll(p),u.convertToFoundDocument(u.version,f).setHasLocalMutations(),null}(n,e,t,r):n instanceof ft?function(o,u,l,h){if(!Gi(o.precondition,u))return l;let f=Ah(o.fieldTransforms,h,u),p=u.data;return p.setAll(fd(o)),p.setAll(f),u.convertToFoundDocument(u.version,p).setHasLocalMutations(),l===null?null:l.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(T=>T.field))}(n,e,t,r):function(o,u,l){return Gi(o.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):l}(n,e,t)}function yg(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=ud(r.transform,i||null);o!=null&&(t===null&&(t=Le.empty()),t.set(r.field,o))}return t||null}function Ih(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&xn(r,i,(o,u)=>gg(o,u))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var un=class extends Un{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},ft=class extends Un{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function fd(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function Th(n,e,t){let r=new Map;Z(n.length===t.length);for(let i=0;i<t.length;i++){let o=n[i],u=o.transform,l=e.data.field(o.field);r.set(o.field,pg(u,l,t[i]))}return r}function Ah(n,e,t){let r=new Map;for(let i of n){let o=i.transform,u=t.data.field(i.field);r.set(i.field,mg(o,u,e))}return r}var Xi=class extends Un{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Va=class extends Un{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Da=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&_g(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Lr(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Lr(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=od();return this.mutations.forEach(i=>{let o=e.get(i.key),u=o.overlayedDocument,l=this.applyToLocalView(u,o.mutatedFields);l=t.has(i.key)?null:l;let h=dd(u,l);h!==null&&r.set(i.key,h),u.isValidDocument()||u.convertToNoDocument(q.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),K())}isEqual(e){return this.batchId===e.batchId&&xn(this.mutations,e.mutations,(t,r)=>Ih(t,r))&&xn(this.baseMutations,e.baseMutations,(t,r)=>Ih(t,r))}},Ra=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Z(e.mutations.length===r.length);let i=function(){return cg}(),o=e.mutations;for(let u=0;u<o.length;u++)i=i.insert(o[u].key,r[u].version);return new n(e,t,r,i)}};var xa=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var ka=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var le,W;function vg(n){switch(n){default:return L();case C.CANCELLED:case C.UNKNOWN:case C.DEADLINE_EXCEEDED:case C.RESOURCE_EXHAUSTED:case C.INTERNAL:case C.UNAVAILABLE:case C.UNAUTHENTICATED:return!1;case C.INVALID_ARGUMENT:case C.NOT_FOUND:case C.ALREADY_EXISTS:case C.PERMISSION_DENIED:case C.FAILED_PRECONDITION:case C.ABORTED:case C.OUT_OF_RANGE:case C.UNIMPLEMENTED:case C.DATA_LOSS:return!0}}function md(n){if(n===void 0)return lt("GRPC error has no .code"),C.UNKNOWN;switch(n){case le.OK:return C.OK;case le.CANCELLED:return C.CANCELLED;case le.UNKNOWN:return C.UNKNOWN;case le.DEADLINE_EXCEEDED:return C.DEADLINE_EXCEEDED;case le.RESOURCE_EXHAUSTED:return C.RESOURCE_EXHAUSTED;case le.INTERNAL:return C.INTERNAL;case le.UNAVAILABLE:return C.UNAVAILABLE;case le.UNAUTHENTICATED:return C.UNAUTHENTICATED;case le.INVALID_ARGUMENT:return C.INVALID_ARGUMENT;case le.NOT_FOUND:return C.NOT_FOUND;case le.ALREADY_EXISTS:return C.ALREADY_EXISTS;case le.PERMISSION_DENIED:return C.PERMISSION_DENIED;case le.FAILED_PRECONDITION:return C.FAILED_PRECONDITION;case le.ABORTED:return C.ABORTED;case le.OUT_OF_RANGE:return C.OUT_OF_RANGE;case le.UNIMPLEMENTED:return C.UNIMPLEMENTED;case le.DATA_LOSS:return C.DATA_LOSS;default:return L()}}(W=le||(le={}))[W.OK=0]="OK",W[W.CANCELLED=1]="CANCELLED",W[W.UNKNOWN=2]="UNKNOWN",W[W.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",W[W.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",W[W.NOT_FOUND=5]="NOT_FOUND",W[W.ALREADY_EXISTS=6]="ALREADY_EXISTS",W[W.PERMISSION_DENIED=7]="PERMISSION_DENIED",W[W.UNAUTHENTICATED=16]="UNAUTHENTICATED",W[W.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",W[W.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",W[W.ABORTED=10]="ABORTED",W[W.OUT_OF_RANGE=11]="OUT_OF_RANGE",W[W.UNIMPLEMENTED=12]="UNIMPLEMENTED",W[W.INTERNAL=13]="INTERNAL",W[W.UNAVAILABLE=14]="UNAVAILABLE",W[W.DATA_LOSS=15]="DATA_LOSS";var bh=null;function wg(){return new TextEncoder}var Eg=new Dt([4294967295,4294967295],0);function Ch(n){let e=wg().encode(n),t=new Wo;return t.update(e),new Uint8Array(t.digest())}function Sh(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Dt([t,r],0),new Dt([i,o],0)]}var Ma=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Xt(`Invalid padding: ${t}`);if(r<0)throw new Xt(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Xt(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Xt(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Dt.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(Dt.fromNumber(r)));return i.compare(Eg)===1&&(i=new Dt([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=Ch(e),[r,i]=Sh(t);for(let o=0;o<this.hashCount;o++){let u=this.Ee(r,i,o);if(!this.de(u))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),u=new n(o,i,t);return r.forEach(l=>u.insert(l)),u}insert(e){if(this.Ie===0)return;let t=Ch(e),[r,i]=Sh(t);for(let o=0;o<this.hashCount;o++){let u=this.Ee(r,i,o);this.Ae(u)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Xt=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Zi=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,$r.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(q.min(),i,new ue(J),dt(),K())}},$r=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,K(),K(),K())}};var Vn=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},es=class{constructor(e,t){this.targetId=e,this.me=t}},ts=class{constructor(e,t,r=Te.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},ns=class{constructor(){this.fe=0,this.ge=Vh(),this.pe=Te.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=K(),t=K(),r=K();return this.ge.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:L()}}),new $r(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=Vh()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Z(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},Na=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=dt(),this.qe=Ph(),this.Qe=new ue(J)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:L()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let o=i.target;if(ba(o))if(r===0){let u=new F(o.path);this.Ue(t,u,Ue.newNoDocument(u,q.min()))}else Z(r===1);else{let u=this.Ye(t);if(u!==r){let l=this.Ze(e),h=l?this.Xe(l,e,u):1;if(h!==0){this.je(t);let f=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,f)}bh?.et(function(p,T,b,S,x){var M,D,$,z,O,H;let ce={localCacheCount:p,existenceFilterCount:T.count,databaseId:b.database,projectId:b.projectId},ee=T.unchangedNames;return ee&&(ce.bloomFilter={applied:x===0,hashCount:(M=ee?.hashCount)!==null&&M!==void 0?M:0,bitmapLength:(z=($=(D=ee?.bits)===null||D===void 0?void 0:D.bitmap)===null||$===void 0?void 0:$.length)!==null&&z!==void 0?z:0,padding:(H=(O=ee?.bits)===null||O===void 0?void 0:O.padding)!==null&&H!==void 0?H:0,mightContain:w=>{var m;return(m=S?.mightContain(w))!==null&&m!==void 0&&m}}),ce}(u,e.me,this.Le.tt(),l,h))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,u,l;try{u=xt(r).toUint8Array()}catch(h){if(h instanceof Qi)return Rn("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{l=new Ma(u,i,o)}catch(h){return Rn(h instanceof Xt?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return l.Ie===0?null:l}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let u=this.Le.tt(),l=`projects/${u.projectId}/databases/${u.database}/documents/${o.path.canonicalString()}`;e.mightContain(l)||(this.Ue(t,o,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((o,u)=>{let l=this.Je(u);if(l){if(o.current&&ba(l.target)){let h=new F(l.target.path);this.ke.get(h)!==null||this.it(u,h)||this.Ue(u,h,Ue.newNoDocument(h,e))}o.be&&(t.set(u,o.ve()),o.Ce())}});let r=K();this.qe.forEach((o,u)=>{let l=!0;u.forEachWhile(h=>{let f=this.Je(h);return!f||f.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(o))}),this.ke.forEach((o,u)=>u.setReadTime(e));let i=new Zi(e,t,this.Qe,this.ke,r);return this.ke=dt(),this.qe=Ph(),this.Qe=new ue(J),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new ns,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Ie(J),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||N("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new ns),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function Ph(){return new ue(F.comparator)}function Vh(){return new ue(F.comparator)}var Ig={asc:"ASCENDING",desc:"DESCENDING"},Tg={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ag={and:"AND",or:"OR"},Fa=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Oa(n,e){return n.useProto3Json||Is(e)?e:{value:e}}function rs(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function pd(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function bg(n,e){return rs(n,e.toTimestamp())}function Xe(n){return Z(!!n),q.fromTimestamp(function(t){let r=ht(t);return new fe(r.seconds,r.nanos)}(n))}function Hu(n,e){return La(n,e).canonicalString()}function La(n,e){let t=function(i){return new re(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function gd(n){let e=re.fromString(n);return Z(Ed(e)),e}function Ua(n,e){return Hu(n.databaseId,e.path)}function ea(n,e){let t=gd(e);if(t.get(1)!==n.databaseId.projectId)throw new k(C.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new k(C.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new F(yd(t))}function _d(n,e){return Hu(n.databaseId,e)}function Cg(n){let e=gd(n);return e.length===4?re.emptyPath():yd(e)}function ja(n){return new re(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function yd(n){return Z(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Dh(n,e,t){return{name:Ua(n,e),fields:t.value.mapValue.fields}}function Sg(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(f){return f==="NO_CHANGE"?0:f==="ADD"?1:f==="REMOVE"?2:f==="CURRENT"?3:f==="RESET"?4:L()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(f,p){return f.useProto3Json?(Z(p===void 0||typeof p=="string"),Te.fromBase64String(p||"")):(Z(p===void 0||p instanceof Buffer||p instanceof Uint8Array),Te.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),u=e.targetChange.cause,l=u&&function(f){let p=f.code===void 0?C.UNKNOWN:md(f.code);return new k(p,f.message||"")}(u);t=new ts(r,i,o,l||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=ea(n,r.document.name),o=Xe(r.document.updateTime),u=r.document.createTime?Xe(r.document.createTime):q.min(),l=new Le({mapValue:{fields:r.document.fields}}),h=Ue.newFoundDocument(i,o,u,l),f=r.targetIds||[],p=r.removedTargetIds||[];t=new Vn(f,p,h.key,h)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=ea(n,r.document),o=r.readTime?Xe(r.readTime):q.min(),u=Ue.newNoDocument(i,o),l=r.removedTargetIds||[];t=new Vn([],l,u.key,u)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=ea(n,r.document),o=r.removedTargetIds||[];t=new Vn([],o,i,null)}else{if(!("filter"in e))return L();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,u=new ka(i,o),l=r.targetId;t=new es(l,u)}}return t}function Pg(n,e){let t;if(e instanceof un)t={update:Dh(n,e.key,e.value)};else if(e instanceof Xi)t={delete:Ua(n,e.key)};else if(e instanceof ft)t={update:Dh(n,e.key,e.data),updateMask:Og(e.fieldMask)};else{if(!(e instanceof Va))return L();t={verify:Ua(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(o,u){let l=u.transform;if(l instanceof On)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof on)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof an)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Ln)return{fieldPath:u.field.canonicalString(),increment:l.Pe};throw L()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:bg(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:L()}(n,e.precondition)),t}function Vg(n,e){return n&&n.length>0?(Z(e!==void 0),n.map(t=>function(i,o){let u=i.updateTime?Xe(i.updateTime):Xe(o);return u.isEqual(q.min())&&(u=Xe(o)),new Pa(u,i.transformResults||[])}(t,e))):[]}function Dg(n,e){return{documents:[_d(n,e.path)]}}function Rg(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=_d(n,i);let o=function(f){if(f.length!==0)return wd(je.create(f,"and"))}(e.filters);o&&(t.structuredQuery.where=o);let u=function(f){if(f.length!==0)return f.map(p=>function(b){return{field:Cn(b.field),direction:Mg(b.dir)}}(p))}(e.orderBy);u&&(t.structuredQuery.orderBy=u);let l=Oa(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=function(f){return{before:f.inclusive,values:f.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(f){return{before:!f.inclusive,values:f.position}}(e.endAt)),{_t:t,parent:i}}function xg(n){let e=Cg(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){Z(r===1);let p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let o=[];t.where&&(o=function(T){let b=vd(T);return b instanceof je&&Yh(b)?b.getFilters():[b]}(t.where));let u=[];t.orderBy&&(u=function(T){return T.map(b=>function(x){return new sn(Sn(x.field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(b))}(t.orderBy));let l=null;t.limit&&(l=function(T){let b;return b=typeof T=="object"?T.value:T,Is(b)?null:b}(t.limit));let h=null;t.startAt&&(h=function(T){let b=!!T.before,S=T.values||[];return new Nn(S,b)}(t.startAt));let f=null;return t.endAt&&(f=function(T){let b=!T.before,S=T.values||[];return new Nn(S,b)}(t.endAt)),ig(e,i,u,o,l,"F",h,f)}function kg(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return L()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function vd(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Sn(t.unaryFilter.field);return de.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Sn(t.unaryFilter.field);return de.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=Sn(t.unaryFilter.field);return de.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let u=Sn(t.unaryFilter.field);return de.create(u,"!=",{nullValue:"NULL_VALUE"});default:return L()}}(n):n.fieldFilter!==void 0?function(t){return de.create(Sn(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return L()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return je.create(t.compositeFilter.filters.map(r=>vd(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return L()}}(t.compositeFilter.op))}(n):L()}function Mg(n){return Ig[n]}function Ng(n){return Tg[n]}function Fg(n){return Ag[n]}function Cn(n){return{fieldPath:n.canonicalString()}}function Sn(n){return Re.fromServerFormat(n.fieldPath)}function wd(n){return n instanceof de?function(t){if(t.op==="=="){if(gh(t.value))return{unaryFilter:{field:Cn(t.field),op:"IS_NAN"}};if(ph(t.value))return{unaryFilter:{field:Cn(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(gh(t.value))return{unaryFilter:{field:Cn(t.field),op:"IS_NOT_NAN"}};if(ph(t.value))return{unaryFilter:{field:Cn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Cn(t.field),op:Ng(t.op),value:t.value}}}(n):n instanceof je?function(t){let r=t.getFilters().map(i=>wd(i));return r.length===1?r[0]:{compositeFilter:{op:Fg(t.op),filters:r}}}(n):L()}function Og(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Ed(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Gr=class n{constructor(e,t,r,i,o=q.min(),u=q.min(),l=Te.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=l,this.expectedCount=h}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Ba=class{constructor(e){this.ct=e}};function Lg(n){let e=xg({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Sa(e,e.limit,"L"):e}var is=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(ne(e.integerValue));else if("doubleValue"in e){let r=ne(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),jr(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=ht(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(xt(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?Hh(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Wh(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):L()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let o=e.fields||{};this.dt(t,53);let u="value",l=((i=(r=o[u].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(ne(l)),this.Vt(u,t),this.Tt(o[u],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),F.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};is.vt=new is;var qa=class{constructor(){this.un=new $a}addToCollectionParentIndex(e,t){return this.un.add(t),P.resolve()}getCollectionParents(e,t){return P.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return P.resolve()}deleteFieldIndex(e,t){return P.resolve()}deleteAllFieldIndexes(e){return P.resolve()}createTargetIndexes(e,t){return P.resolve()}getDocumentsMatchingTarget(e,t){return P.resolve(null)}getIndexType(e,t){return P.resolve(0)}getFieldIndexes(e,t){return P.resolve([])}getNextCollectionGroupToUpdate(e){return P.resolve(null)}getMinOffset(e,t){return P.resolve(nn.min())}getMinOffsetFromCollectionGroup(e,t){return P.resolve(nn.min())}updateCollectionGroup(e,t,r){return P.resolve()}updateIndexEntries(e,t){return P.resolve()}},$a=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Ie(re.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ie(re.comparator)).toArray()}};var G0=new Uint8Array(0);var He=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};He.DEFAULT_COLLECTION_PERCENTILE=10,He.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,He.DEFAULT=new He(41943040,He.DEFAULT_COLLECTION_PERCENTILE,He.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),He.DISABLED=new He(-1,0,0);var zr=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var Ga=class{constructor(){this.changes=new Mt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ue.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?P.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var za=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Ka=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Lr(r.mutation,i,Qe.empty(),fe.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,K()).next(()=>r))}getLocalViewOfDocuments(e,t,r=K()){let i=Yt();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let u=Mr();return o.forEach((l,h)=>{u=u.insert(l,h.overlayedDocument)}),u}))}getOverlayedDocuments(e,t){let r=Yt();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,K()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((u,l)=>{t.set(u,l)})})}computeViews(e,t,r,i){let o=dt(),u=Or(),l=function(){return Or()}();return t.forEach((h,f)=>{let p=r.get(f.key);i.has(f.key)&&(p===void 0||p.mutation instanceof ft)?o=o.insert(f.key,f):p!==void 0?(u.set(f.key,p.mutation.getFieldMask()),Lr(p.mutation,f,p.mutation.getFieldMask(),fe.now())):u.set(f.key,Qe.empty())}),this.recalculateAndSaveOverlays(e,o).next(h=>(h.forEach((f,p)=>u.set(f,p)),t.forEach((f,p)=>{var T;return l.set(f,new za(p,(T=u.get(f))!==null&&T!==void 0?T:null))}),l))}recalculateAndSaveOverlays(e,t){let r=Or(),i=new ue((u,l)=>u-l),o=K();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(u=>{for(let l of u)l.keys().forEach(h=>{let f=t.get(h);if(f===null)return;let p=r.get(h)||Qe.empty();p=l.applyToLocalView(f,p),r.set(h,p);let T=(i.get(l.batchId)||K()).add(h);i=i.insert(l.batchId,T)})}).next(()=>{let u=[],l=i.getReverseIterator();for(;l.hasNext();){let h=l.getNext(),f=h.key,p=h.value,T=od();p.forEach(b=>{if(!o.has(b)){let S=dd(t.get(b),r.get(b));S!==null&&T.set(b,S),o=o.add(b)}}),u.push(this.documentOverlayCache.saveOverlays(e,f,T))}return P.waitFor(u)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(u){return F.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):td(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let u=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):P.resolve(Yt()),l=-1,h=o;return u.next(f=>P.forEach(f,(p,T)=>(l<T.largestBatchId&&(l=T.largestBatchId),o.get(p)?P.resolve():this.remoteDocumentCache.getEntry(e,p).next(b=>{h=h.insert(p,b)}))).next(()=>this.populateOverlays(e,f,o)).next(()=>this.computeViews(e,h,f,K())).next(p=>({batchId:l,changes:sd(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new F(t)).next(r=>{let i=Mr();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,u=Mr();return this.indexManager.getCollectionParents(e,o).next(l=>P.forEach(l,h=>{let f=function(T,b){return new kt(b,null,T.explicitOrderBy.slice(),T.filters.slice(),T.limit,T.limitType,T.startAt,T.endAt)}(t,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,f,r,i).next(p=>{p.forEach((T,b)=>{u=u.insert(T,b)})})}).next(()=>u))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(u=>(o=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(u=>{o.forEach((h,f)=>{let p=f.getKey();u.get(p)===null&&(u=u.insert(p,Ue.newInvalidDocument(p)))});let l=Mr();return u.forEach((h,f)=>{let p=o.get(h);p!==void 0&&Lr(p.mutation,f,Qe.empty(),fe.now()),As(t,f)&&(l=l.insert(h,f))}),l})}};var Wa=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return P.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Xe(i.createTime)}}(t)),P.resolve()}getNamedQuery(e,t){return P.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:Lg(i.bundledQuery),readTime:Xe(i.readTime)}}(t)),P.resolve()}};var Ha=class{constructor(){this.overlays=new ue(F.comparator),this.Ir=new Map}getOverlay(e,t){return P.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Yt();return P.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.ht(e,t,o)}),P.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Ir.delete(r)),P.resolve()}getOverlaysForCollection(e,t,r){let i=Yt(),o=t.length+1,u=new F(t.child("")),l=this.overlays.getIteratorFrom(u);for(;l.hasNext();){let h=l.getNext().value,f=h.getKey();if(!t.isPrefixOf(f.path))break;f.path.length===o&&h.largestBatchId>r&&i.set(h.getKey(),h)}return P.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new ue((f,p)=>f-p),u=this.overlays.getIterator();for(;u.hasNext();){let f=u.getNext().value;if(f.getKey().getCollectionGroup()===t&&f.largestBatchId>r){let p=o.get(f.largestBatchId);p===null&&(p=Yt(),o=o.insert(f.largestBatchId,p)),p.set(f.getKey(),f)}}let l=Yt(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((f,p)=>l.set(f,p)),!(l.size()>=i)););return P.resolve(l)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let u=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,u)}this.overlays=this.overlays.insert(r.key,new xa(t,r));let o=this.Ir.get(t);o===void 0&&(o=K(),this.Ir.set(t,o)),this.Ir.set(t,o.add(r.key))}};var Qa=class{constructor(){this.sessionToken=Te.EMPTY_BYTE_STRING}getSessionToken(e){return P.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,P.resolve()}};var Kr=class{constructor(){this.Tr=new Ie(he.Er),this.dr=new Ie(he.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new he(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new he(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new F(new re([])),r=new he(t,e),i=new he(t,e+1),o=[];return this.dr.forEachInRange([r,i],u=>{this.Vr(u),o.push(u.key)}),o}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new F(new re([])),r=new he(t,e),i=new he(t,e+1),o=K();return this.dr.forEachInRange([r,i],u=>{o=o.add(u.key)}),o}containsKey(e){let t=new he(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},he=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return F.comparator(e.key,t.key)||J(e.wr,t.wr)}static Ar(e,t){return J(e.wr,t.wr)||F.comparator(e.key,t.key)}};var Ja=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Ie(he.Er)}checkEmpty(e){return P.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let u=new Da(o,t,r,i);this.mutationQueue.push(u);for(let l of i)this.br=this.br.add(new he(l.key,o)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return P.resolve(u)}lookupMutationBatch(e,t){return P.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),o=i<0?0:i;return P.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return P.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return P.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new he(t,0),i=new he(t,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([r,i],u=>{let l=this.Dr(u.wr);o.push(l)}),P.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ie(J);return t.forEach(i=>{let o=new he(i,0),u=new he(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,u],l=>{r=r.add(l.wr)})}),P.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;F.isDocumentKey(o)||(o=o.child(""));let u=new he(new F(o),0),l=new Ie(J);return this.br.forEachWhile(h=>{let f=h.key.path;return!!r.isPrefixOf(f)&&(f.length===i&&(l=l.add(h.wr)),!0)},u),P.resolve(this.Cr(l))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){Z(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return P.forEach(t.mutations,i=>{let o=new he(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new he(t,0),i=this.br.firstAfterOrEqual(r);return P.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,P.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Ya=class{constructor(e){this.Mr=e,this.docs=function(){return new ue(F.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,u=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:u}),this.size+=u-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return P.resolve(r?r.document.mutableCopy():Ue.newInvalidDocument(t))}getEntries(e,t){let r=dt();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():Ue.newInvalidDocument(i))}),P.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=dt(),u=t.path,l=new F(u.child("")),h=this.docs.getIteratorFrom(l);for(;h.hasNext();){let{key:f,value:{document:p}}=h.getNext();if(!u.isPrefixOf(f.path))break;f.path.length>u.length+1||Wp(Kp(p),r)<=0||(i.has(p.key)||As(t,p))&&(o=o.insert(p.key,p.mutableCopy()))}return P.resolve(o)}getAllFromCollectionGroup(e,t,r,i){L()}Or(e,t){return P.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Xa(this)}getSize(e){return P.resolve(this.size)}},Xa=class extends Ga{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),P.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var Za=class{constructor(e){this.persistence=e,this.Nr=new Mt(t=>Gu(t),zu),this.lastRemoteSnapshotVersion=q.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Kr,this.targetCount=0,this.kr=zr.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),P.resolve()}getLastRemoteSnapshotVersion(e){return P.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return P.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),P.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),P.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new zr(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,P.resolve()}updateTargetData(e,t){return this.Kn(t),P.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,P.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.Nr.forEach((u,l)=>{l.sequenceNumber<=t&&r.get(l.targetId)===null&&(this.Nr.delete(u),o.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),P.waitFor(o).next(()=>i)}getTargetCount(e){return P.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return P.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),P.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(u=>{o.push(i.markPotentiallyOrphaned(e,u))}),P.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),P.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return P.resolve(r)}containsKey(e,t){return P.resolve(this.Br.containsKey(t))}};var eu=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new zh(0),this.Kr=!1,this.Kr=!0,this.$r=new Qa,this.referenceDelegate=e(this),this.Ur=new Za(this),this.indexManager=new qa,this.remoteDocumentCache=function(i){return new Ya(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new Ba(t),this.Gr=new Wa(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Ha,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new Ja(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){N("MemoryPersistence","Starting transaction:",e);let i=new tu(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(o=>this.referenceDelegate.jr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Hr(e,t){return P.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},tu=class extends da{constructor(e){super(),this.currentSequenceNumber=e}},nu=class n{constructor(e){this.persistence=e,this.Jr=new Kr,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw L()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),P.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),P.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),P.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.Xr.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return P.forEach(this.Xr,r=>{let i=F.fromPath(r);return this.ei(e,i).next(o=>{o||t.removeEntry(i,q.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return P.or([()=>P.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var ru=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=K(),i=K();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var iu=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var su=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Jl()?8:Qp(Ql())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.Yi(e,t).next(u=>{o.result=u}).next(()=>{if(!o.result)return this.Zi(e,t,i,r).next(u=>{o.result=u})}).next(()=>{if(o.result)return;let u=new iu;return this.Xi(e,t,u).next(l=>{if(o.result=l,this.zi)return this.es(e,t,u,l.size)})}).next(()=>o.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(kr()<=st.DEBUG&&N("QueryEngine","SDK will not create cache indexes for query:",bn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),P.resolve()):(kr()<=st.DEBUG&&N("QueryEngine","Query:",bn(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(kr()<=st.DEBUG&&N("QueryEngine","The SDK decides to create cache indexes for query:",bn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ye(t))):P.resolve())}Yi(e,t){if(wh(t))return P.resolve(null);let r=Ye(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Sa(t,null,"F"),r=Ye(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let u=K(...o);return this.Ji.getDocuments(e,u).next(l=>this.indexManager.getMinOffset(e,r).next(h=>{let f=this.ts(t,l);return this.ns(t,f,u,h.readTime)?this.Yi(e,Sa(t,null,"F")):this.rs(e,f,t,h)}))})))}Zi(e,t,r,i){return wh(t)||i.isEqual(q.min())?P.resolve(null):this.Ji.getDocuments(e,r).next(o=>{let u=this.ts(t,o);return this.ns(t,u,r,i)?P.resolve(null):(kr()<=st.DEBUG&&N("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),bn(t)),this.rs(e,u,t,zp(i,-1)).next(l=>l))})}ts(e,t){let r=new Ie(rd(e));return t.forEach((i,o)=>{As(e,o)&&(r=r.add(o))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Xi(e,t,r){return kr()<=st.DEBUG&&N("QueryEngine","Using full collection scan to execute query:",bn(t)),this.Ji.getDocumentsMatchingQuery(e,t,nn.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(u=>{o=o.insert(u.key,u)}),o))}};var ou=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new ue(J),this._s=new Mt(o=>Gu(o),zu),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ka(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function Ug(n,e,t,r){return new ou(n,e,t,r)}function Id(n,e){return V(this,null,function*(){let t=B(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let u=[],l=[],h=K();for(let f of i){u.push(f.batchId);for(let p of f.mutations)h=h.add(p.key)}for(let f of o){l.push(f.batchId);for(let p of f.mutations)h=h.add(p.key)}return t.localDocuments.getDocuments(r,h).next(f=>({hs:f,removedBatchIds:u,addedBatchIds:l}))})})})}function jg(n,e){let t=B(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.cs.newChangeBuffer({trackRemovals:!0});return function(l,h,f,p){let T=f.batch,b=T.keys(),S=P.resolve();return b.forEach(x=>{S=S.next(()=>p.getEntry(h,x)).next(M=>{let D=f.docVersions.get(x);Z(D!==null),M.version.compareTo(D)<0&&(T.applyToRemoteDocument(M,f),M.isValidDocument()&&(M.setReadTime(f.commitVersion),p.addEntry(M)))})}),S.next(()=>l.mutationQueue.removeMutationBatch(h,T))}(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let h=K();for(let f=0;f<l.mutationResults.length;++f)l.mutationResults[f].transformResults.length>0&&(h=h.add(l.batch.mutations[f].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function Td(n){let e=B(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function Bg(n,e){let t=B(n),r=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let u=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let l=[];e.targetChanges.forEach((p,T)=>{let b=i.get(T);if(!b)return;l.push(t.Ur.removeMatchingKeys(o,p.removedDocuments,T).next(()=>t.Ur.addMatchingKeys(o,p.addedDocuments,T)));let S=b.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(T)!==null?S=S.withResumeToken(Te.EMPTY_BYTE_STRING,q.min()).withLastLimboFreeSnapshotVersion(q.min()):p.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(p.resumeToken,r)),i=i.insert(T,S),function(M,D,$){return M.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-M.snapshotVersion.toMicroseconds()>=3e8?!0:$.addedDocuments.size+$.modifiedDocuments.size+$.removedDocuments.size>0}(b,S,p)&&l.push(t.Ur.updateTargetData(o,S))});let h=dt(),f=K();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(o,p))}),l.push(qg(o,u,e.documentUpdates).next(p=>{h=p.Ps,f=p.Is})),!r.isEqual(q.min())){let p=t.Ur.getLastRemoteSnapshotVersion(o).next(T=>t.Ur.setTargetsMetadata(o,o.currentSequenceNumber,r));l.push(p)}return P.waitFor(l).next(()=>u.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,h,f)).next(()=>h)}).then(o=>(t.os=i,o))}function qg(n,e,t){let r=K(),i=K();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let u=dt();return t.forEach((l,h)=>{let f=o.get(l);h.isFoundDocument()!==f.isFoundDocument()&&(i=i.add(l)),h.isNoDocument()&&h.version.isEqual(q.min())?(e.removeEntry(l,h.readTime),u=u.insert(l,h)):!f.isValidDocument()||h.version.compareTo(f.version)>0||h.version.compareTo(f.version)===0&&f.hasPendingWrites?(e.addEntry(h),u=u.insert(l,h)):N("LocalStore","Ignoring outdated watch update for ",l,". Current version:",f.version," Watch version:",h.version)}),{Ps:u,Is:i}})}function $g(n,e){let t=B(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Gg(n,e){let t=B(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(o=>o?(i=o,P.resolve(i)):t.Ur.allocateTargetId(r).next(u=>(i=new Gr(e,u,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function au(n,e,t){return V(this,null,function*(){let r=B(n),i=r.os.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",o,u=>r.persistence.referenceDelegate.removeTarget(u,i)))}catch(u){if(!Zr(u))throw u;N("LocalStore",`Failed to update sequence numbers for target ${e}: ${u}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function Rh(n,e,t){let r=B(n),i=q.min(),o=K();return r.persistence.runTransaction("Execute query","readwrite",u=>function(h,f,p){let T=B(h),b=T._s.get(p);return b!==void 0?P.resolve(T.os.get(b)):T.Ur.getTargetData(f,p)}(r,u,Ye(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(u,l.targetId).next(h=>{o=h})}).next(()=>r.ss.getDocumentsMatchingQuery(u,e,t?i:q.min(),t?o:K())).next(l=>(zg(r,og(e),l),{documents:l,Ts:o})))}function zg(n,e,t){let r=n.us.get(e)||q.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.us.set(e,r)}var ss=class{constructor(){this.activeTargetIds=dg()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var uu=class{constructor(){this.so=new ss,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new ss,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var cu=class{_o(e){}shutdown(){}};var os=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){N("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){N("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var qi=null;function ta(){return qi===null?qi=function(){return 268435456+Math.round(2147483648*Math.random())}():qi++,"0x"+qi.toString(16)}var Kg={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var lu=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var Ee="WebChannelConnection",hu=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${o}`}get Fo(){return!1}Mo(t,r,i,o,u){let l=ta(),h=this.xo(t,r.toUriEncodedString());N("RestConnection",`Sending RPC '${t}' ${l}:`,h,i);let f={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(f,o,u),this.No(t,h,f,i).then(p=>(N("RestConnection",`Received RPC '${t}' ${l}: `,p),p),p=>{throw Rn("RestConnection",`RPC '${t}' ${l} failed with error: `,p,"url: ",h,"request:",i),p})}Lo(t,r,i,o,u,l){return this.Mo(t,r,i,o,u)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+$n}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,u)=>t[u]=o),i&&i.headers.forEach((o,u)=>t[u]=o)}xo(t,r){let i=Kg[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let o=ta();return new Promise((u,l)=>{let h=new Ho;h.setWithCredentials(!0),h.listenOnce(Jo.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case xr.NO_ERROR:let p=h.getResponseJson();N(Ee,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),u(p);break;case xr.TIMEOUT:N(Ee,`RPC '${e}' ${o} timed out`),l(new k(C.DEADLINE_EXCEEDED,"Request time out"));break;case xr.HTTP_ERROR:let T=h.getStatus();if(N(Ee,`RPC '${e}' ${o} failed with status:`,T,"response text:",h.getResponseText()),T>0){let b=h.getResponseJson();Array.isArray(b)&&(b=b[0]);let S=b?.error;if(S&&S.status&&S.message){let x=function(D){let $=D.toLowerCase().replace(/_/g,"-");return Object.values(C).indexOf($)>=0?$:C.UNKNOWN}(S.status);l(new k(x,S.message))}else l(new k(C.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new k(C.UNAVAILABLE,"Connection failed."));break;default:L()}}finally{N(Ee,`RPC '${e}' ${o} completed.`)}});let f=JSON.stringify(i);N(Ee,`RPC '${e}' ${o} sending request:`,i),h.send(t,"POST",f,r,15)})}Bo(e,t,r){let i=ta(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=Zo(),l=Xo(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(h.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(h.xmlHttpFactory=new Qo({})),this.Oo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;let p=o.join("");N(Ee,`Creating RPC '${e}' stream ${i}: ${p}`,h);let T=u.createWebChannel(p,h),b=!1,S=!1,x=new lu({Io:D=>{S?N(Ee,`Not sending because RPC '${e}' stream ${i} is closed:`,D):(b||(N(Ee,`Opening RPC '${e}' stream ${i} transport.`),T.open(),b=!0),N(Ee,`RPC '${e}' stream ${i} sending:`,D),T.send(D))},To:()=>T.close()}),M=(D,$,z)=>{D.listen($,O=>{try{z(O)}catch(H){setTimeout(()=>{throw H},0)}})};return M(T,An.EventType.OPEN,()=>{S||(N(Ee,`RPC '${e}' stream ${i} transport opened.`),x.yo())}),M(T,An.EventType.CLOSE,()=>{S||(S=!0,N(Ee,`RPC '${e}' stream ${i} transport closed`),x.So())}),M(T,An.EventType.ERROR,D=>{S||(S=!0,Rn(Ee,`RPC '${e}' stream ${i} transport errored:`,D),x.So(new k(C.UNAVAILABLE,"The operation could not be completed")))}),M(T,An.EventType.MESSAGE,D=>{var $;if(!S){let z=D.data[0];Z(!!z);let O=z,H=O.error||(($=O[0])===null||$===void 0?void 0:$.error);if(H){N(Ee,`RPC '${e}' stream ${i} received error:`,H);let ce=H.status,ee=function(_){let y=le[_];if(y!==void 0)return md(y)}(ce),w=H.message;ee===void 0&&(ee=C.INTERNAL,w="Unknown error status: "+ce+" with message "+H.message),S=!0,x.So(new k(ee,w)),T.close()}else N(Ee,`RPC '${e}' stream ${i} received:`,z),x.bo(z)}}),M(l,Yo.STAT_EVENT,D=>{D.stat===ji.PROXY?N(Ee,`RPC '${e}' stream ${i} detected buffering proxy`):D.stat===ji.NOPROXY&&N(Ee,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{x.wo()},0),x}};function na(){return typeof document<"u"?document:null}function bs(n){return new Fa(n,!0)}var as=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&N("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var us=class{constructor(e,t,r,i,o,u,l,h){this.ui=e,this.Ho=r,this.Jo=i,this.connection=o,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=l,this.listener=h,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new as(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return V(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return V(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return V(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===C.RESOURCE_EXHAUSTED?(lt(t.toString()),lt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===C.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new k(C.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>V(this,null,function*(){this.state=0,this.start()}))}I_(e){return N("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(N("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},du=class extends us{constructor(e,t,r,i,o,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,u),this.serializer=o}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=Sg(this.serializer,e),r=function(o){if(!("targetChange"in o))return q.min();let u=o.targetChange;return u.targetIds&&u.targetIds.length?q.min():u.readTime?Xe(u.readTime):q.min()}(e);return this.listener.d_(t,r)}A_(e){let t={};t.database=ja(this.serializer),t.addTarget=function(o,u){let l,h=u.target;if(l=ba(h)?{documents:Dg(o,h)}:{query:Rg(o,h)._t},l.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){l.resumeToken=pd(o,u.resumeToken);let f=Oa(o,u.expectedCount);f!==null&&(l.expectedCount=f)}else if(u.snapshotVersion.compareTo(q.min())>0){l.readTime=rs(o,u.snapshotVersion.toTimestamp());let f=Oa(o,u.expectedCount);f!==null&&(l.expectedCount=f)}return l}(this.serializer,e);let r=kg(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){let t={};t.database=ja(this.serializer),t.removeTarget=e,this.a_(t)}},fu=class extends us{constructor(e,t,r,i,o,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,u),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Z(!!e.streamToken),this.lastStreamToken=e.streamToken,Z(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Z(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=Vg(e.writeResults,e.commitTime),r=Xe(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=ja(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>Pg(this.serializer,r))};this.a_(t)}};var mu=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new k(C.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,u])=>this.connection.Mo(e,La(t,r),i,o,u)).catch(o=>{throw o.name==="FirebaseError"?(o.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new k(C.UNKNOWN,o.toString())})}Lo(e,t,r,i,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([u,l])=>this.connection.Lo(e,La(t,r),i,u,l,o)).catch(u=>{throw u.name==="FirebaseError"?(u.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new k(C.UNKNOWN,u.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},pu=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(lt(t),this.D_=!1):N("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var gu=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o(u=>{r.enqueueAndForget(()=>V(this,null,function*(){ln(this)&&(N("RemoteStore","Restarting streams for network reachability change."),yield function(h){return V(this,null,function*(){let f=B(h);f.L_.add(4),yield ei(f),f.q_.set("Unknown"),f.L_.delete(4),yield Cs(f)})}(this))}))}),this.q_=new pu(r,i)}};function Cs(n){return V(this,null,function*(){if(ln(n))for(let e of n.B_)yield e(!0)})}function ei(n){return V(this,null,function*(){for(let e of n.B_)yield e(!1)})}function Ad(n,e){let t=B(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Xu(t)?Yu(t):zn(t).r_()&&Ju(t,e))}function Qu(n,e){let t=B(n),r=zn(t);t.N_.delete(e),r.r_()&&bd(t,e),t.N_.size===0&&(r.r_()?r.o_():ln(t)&&t.q_.set("Unknown"))}function Ju(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(q.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}zn(n).A_(e)}function bd(n,e){n.Q_.xe(e),zn(n).R_(e)}function Yu(n){n.Q_=new Na({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),zn(n).start(),n.q_.v_()}function Xu(n){return ln(n)&&!zn(n).n_()&&n.N_.size>0}function ln(n){return B(n).L_.size===0}function Cd(n){n.Q_=void 0}function Wg(n){return V(this,null,function*(){n.q_.set("Online")})}function Hg(n){return V(this,null,function*(){n.N_.forEach((e,t)=>{Ju(n,e)})})}function Qg(n,e){return V(this,null,function*(){Cd(n),Xu(n)?(n.q_.M_(e),Yu(n)):n.q_.set("Unknown")})}function Jg(n,e,t){return V(this,null,function*(){if(n.q_.set("Online"),e instanceof ts&&e.state===2&&e.cause)try{yield function(i,o){return V(this,null,function*(){let u=o.cause;for(let l of o.targetIds)i.N_.has(l)&&(yield i.remoteSyncer.rejectListen(l,u),i.N_.delete(l),i.Q_.removeTarget(l))})}(n,e)}catch(r){N("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield cs(n,r)}else if(e instanceof Vn?n.Q_.Ke(e):e instanceof es?n.Q_.He(e):n.Q_.We(e),!t.isEqual(q.min()))try{let r=yield Td(n.localStore);t.compareTo(r)>=0&&(yield function(o,u){let l=o.Q_.rt(u);return l.targetChanges.forEach((h,f)=>{if(h.resumeToken.approximateByteSize()>0){let p=o.N_.get(f);p&&o.N_.set(f,p.withResumeToken(h.resumeToken,u))}}),l.targetMismatches.forEach((h,f)=>{let p=o.N_.get(h);if(!p)return;o.N_.set(h,p.withResumeToken(Te.EMPTY_BYTE_STRING,p.snapshotVersion)),bd(o,h);let T=new Gr(p.target,h,f,p.sequenceNumber);Ju(o,T)}),o.remoteSyncer.applyRemoteEvent(l)}(n,t))}catch(r){N("RemoteStore","Failed to raise snapshot:",r),yield cs(n,r)}})}function cs(n,e,t){return V(this,null,function*(){if(!Zr(e))throw e;n.L_.add(1),yield ei(n),n.q_.set("Offline"),t||(t=()=>Td(n.localStore)),n.asyncQueue.enqueueRetryable(()=>V(this,null,function*(){N("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield Cs(n)}))})}function Sd(n,e){return e().catch(t=>cs(n,t,e))}function Ss(n){return V(this,null,function*(){let e=B(n),t=Nt(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;Yg(e);)try{let i=yield $g(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,Xg(e,i)}catch(i){yield cs(e,i)}Pd(e)&&Vd(e)})}function Yg(n){return ln(n)&&n.O_.length<10}function Xg(n,e){n.O_.push(e);let t=Nt(n);t.r_()&&t.V_&&t.m_(e.mutations)}function Pd(n){return ln(n)&&!Nt(n).n_()&&n.O_.length>0}function Vd(n){Nt(n).start()}function Zg(n){return V(this,null,function*(){Nt(n).p_()})}function e_(n){return V(this,null,function*(){let e=Nt(n);for(let t of n.O_)e.m_(t.mutations)})}function t_(n,e,t){return V(this,null,function*(){let r=n.O_.shift(),i=Ra.from(r,e,t);yield Sd(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Ss(n)})}function n_(n,e){return V(this,null,function*(){e&&Nt(n).V_&&(yield function(r,i){return V(this,null,function*(){if(function(u){return vg(u)&&u!==C.ABORTED}(i.code)){let o=r.O_.shift();Nt(r).s_(),yield Sd(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield Ss(r)}})}(n,e)),Pd(n)&&Vd(n)})}function xh(n,e){return V(this,null,function*(){let t=B(n);t.asyncQueue.verifyOperationInProgress(),N("RemoteStore","RemoteStore received new credentials");let r=ln(t);t.L_.add(3),yield ei(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield Cs(t)})}function r_(n,e){return V(this,null,function*(){let t=B(n);e?(t.L_.delete(2),yield Cs(t)):e||(t.L_.add(2),yield ei(t),t.q_.set("Unknown"))})}function zn(n){return n.K_||(n.K_=function(t,r,i){let o=B(t);return o.w_(),new du(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:Wg.bind(null,n),Ro:Hg.bind(null,n),mo:Qg.bind(null,n),d_:Jg.bind(null,n)}),n.B_.push(e=>V(this,null,function*(){e?(n.K_.s_(),Xu(n)?Yu(n):n.q_.set("Unknown")):(yield n.K_.stop(),Cd(n))}))),n.K_}function Nt(n){return n.U_||(n.U_=function(t,r,i){let o=B(t);return o.w_(),new fu(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:Zg.bind(null,n),mo:n_.bind(null,n),f_:e_.bind(null,n),g_:t_.bind(null,n)}),n.B_.push(e=>V(this,null,function*(){e?(n.U_.s_(),yield Ss(n)):(yield n.U_.stop(),n.O_.length>0&&(N("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var _u=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new ct,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(u=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let u=Date.now()+r,l=new n(e,t,u,i,o);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new k(C.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Zu(n,e){if(lt("AsyncQueue",`${e}: ${n}`),Zr(n))return new k(C.UNAVAILABLE,`${e}: ${n}`);throw n}var ls=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||F.comparator(t.key,r.key):(t,r)=>F.comparator(t.key,r.key),this.keyedMap=Mr(),this.sortedSet=new ue(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var hs=class{constructor(){this.W_=new ue(F.comparator)}track(e){let t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):L():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}},jn=class n{constructor(e,t,r,i,o,u,l,h,f){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=u,this.syncStateChanged=l,this.excludesMetadataChanges=h,this.hasCachedResults=f}static fromInitialDocuments(e,t,r,i,o){let u=[];return t.forEach(l=>{u.push({type:0,doc:l})}),new n(e,t,ls.emptySet(t),u,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ts(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var yu=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},vu=class{constructor(){this.queries=kh(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=B(t),o=i.queries;i.queries=kh(),o.forEach((u,l)=>{for(let h of l.j_)h.onError(r)})})(this,new k(C.ABORTED,"Firestore shutting down"))}};function kh(){return new Mt(n=>nd(n),Ts)}function i_(n,e){return V(this,null,function*(){let t=B(n),r=3,i=e.query,o=t.queries.get(i);o?!o.H_()&&e.J_()&&(r=2):(o=new yu,r=e.J_()?0:1);try{switch(r){case 0:o.z_=yield t.onListen(i,!0);break;case 1:o.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(u){let l=Zu(u,`Initialization of query '${bn(e.query)}' failed`);return void e.onError(l)}t.queries.set(i,o),o.j_.push(e),e.Z_(t.onlineState),o.z_&&e.X_(o.z_)&&ec(t)})}function s_(n,e){return V(this,null,function*(){let t=B(n),r=e.query,i=3,o=t.queries.get(r);if(o){let u=o.j_.indexOf(e);u>=0&&(o.j_.splice(u,1),o.j_.length===0?i=e.J_()?0:1:!o.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function o_(n,e){let t=B(n),r=!1;for(let i of e){let o=i.query,u=t.queries.get(o);if(u){for(let l of u.j_)l.X_(i)&&(r=!0);u.z_=i}}r&&ec(t)}function a_(n,e,t){let r=B(n),i=r.queries.get(e);if(i)for(let o of i.j_)o.onError(t);r.queries.delete(e)}function ec(n){n.Y_.forEach(e=>{e.next()})}var wu,Mh;(Mh=wu||(wu={})).ea="default",Mh.Cache="cache";var Eu=class{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new jn(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=jn.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==wu.Cache}};var ds=class{constructor(e){this.key=e}},fs=class{constructor(e){this.key=e}},Iu=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=K(),this.mutatedKeys=K(),this.Aa=rd(e),this.Ra=new ls(this.Aa)}get Va(){return this.Ta}ma(e,t){let r=t?t.fa:new hs,i=t?t.Ra:this.Ra,o=t?t.mutatedKeys:this.mutatedKeys,u=i,l=!1,h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,f=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,T)=>{let b=i.get(p),S=As(this.query,T)?T:null,x=!!b&&this.mutatedKeys.has(b.key),M=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations),D=!1;b&&S?b.data.isEqual(S.data)?x!==M&&(r.track({type:3,doc:S}),D=!0):this.ga(b,S)||(r.track({type:2,doc:S}),D=!0,(h&&this.Aa(S,h)>0||f&&this.Aa(S,f)<0)&&(l=!0)):!b&&S?(r.track({type:0,doc:S}),D=!0):b&&!S&&(r.track({type:1,doc:b}),D=!0,(h||f)&&(l=!0)),D&&(S?(u=u.add(S),o=M?o.add(p):o.delete(p)):(u=u.delete(p),o=o.delete(p)))}),this.query.limit!==null)for(;u.size>this.query.limit;){let p=this.query.limitType==="F"?u.last():u.first();u=u.delete(p.key),o=o.delete(p.key),r.track({type:1,doc:p})}return{Ra:u,fa:r,ns:l,mutatedKeys:o}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let u=e.fa.G_();u.sort((p,T)=>function(S,x){let M=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return L()}};return M(S)-M(x)}(p.type,T.type)||this.Aa(p.doc,T.doc)),this.pa(r),i=i!=null&&i;let l=t&&!i?this.ya():[],h=this.da.size===0&&this.current&&!i?1:0,f=h!==this.Ea;return this.Ea=h,u.length!==0||f?{snapshot:new jn(this.query,e.Ra,o,u,e.mutatedKeys,h===0,f,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new hs,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=K(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let t=[];return e.forEach(r=>{this.da.has(r)||t.push(new fs(r))}),this.da.forEach(r=>{e.has(r)||t.push(new ds(r))}),t}ba(e){this.Ta=e.Ts,this.da=K();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return jn.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},Tu=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},Au=class{constructor(e){this.key=e,this.va=!1}},bu=class{constructor(e,t,r,i,o,u){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=u,this.Ca={},this.Fa=new Mt(l=>nd(l),Ts),this.Ma=new Map,this.xa=new Set,this.Oa=new ue(F.comparator),this.Na=new Map,this.La=new Kr,this.Ba={},this.ka=new Map,this.qa=zr.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function u_(n,e,t=!0){return V(this,null,function*(){let r=Nd(n),i,o=r.Fa.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Da()):i=yield Dd(r,e,t,!0),i})}function c_(n,e){return V(this,null,function*(){let t=Nd(n);yield Dd(t,e,!0,!1)})}function Dd(n,e,t,r){return V(this,null,function*(){let i=yield Gg(n.localStore,Ye(e)),o=i.targetId,u=t?n.sharedClientState.addLocalQueryTarget(o):"not-current",l;return r&&(l=yield l_(n,e,o,u==="current",i.resumeToken)),n.isPrimaryClient&&t&&Ad(n.remoteStore,i),l})}function l_(n,e,t,r,i){return V(this,null,function*(){n.Ka=(T,b,S)=>function(M,D,$,z){return V(this,null,function*(){let O=D.view.ma($);O.ns&&(O=yield Rh(M.localStore,D.query,!1).then(({documents:w})=>D.view.ma(w,O)));let H=z&&z.targetChanges.get(D.targetId),ce=z&&z.targetMismatches.get(D.targetId)!=null,ee=D.view.applyChanges(O,M.isPrimaryClient,H,ce);return Fh(M,D.targetId,ee.wa),ee.snapshot})}(n,T,b,S);let o=yield Rh(n.localStore,e,!0),u=new Iu(e,o.Ts),l=u.ma(o.documents),h=$r.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),f=u.applyChanges(l,n.isPrimaryClient,h);Fh(n,t,f.wa);let p=new Tu(e,t,u);return n.Fa.set(e,p),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),f.snapshot})}function h_(n,e,t){return V(this,null,function*(){let r=B(n),i=r.Fa.get(e),o=r.Ma.get(i.targetId);if(o.length>1)return r.Ma.set(i.targetId,o.filter(u=>!Ts(u,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield au(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Qu(r.remoteStore,i.targetId),Cu(r,i.targetId)}).catch(Xr))):(Cu(r,i.targetId),yield au(r.localStore,i.targetId,!0))})}function d_(n,e){return V(this,null,function*(){let t=B(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Qu(t.remoteStore,r.targetId))})}function f_(n,e,t){return V(this,null,function*(){let r=w_(n);try{let i=yield function(u,l){let h=B(u),f=fe.now(),p=l.reduce((S,x)=>S.add(x.key),K()),T,b;return h.persistence.runTransaction("Locally write mutations","readwrite",S=>{let x=dt(),M=K();return h.cs.getEntries(S,p).next(D=>{x=D,x.forEach(($,z)=>{z.isValidDocument()||(M=M.add($))})}).next(()=>h.localDocuments.getOverlayedDocuments(S,x)).next(D=>{T=D;let $=[];for(let z of l){let O=yg(z,T.get(z.key).overlayedDocument);O!=null&&$.push(new ft(z.key,O,Qh(O.value.mapValue),en.exists(!0)))}return h.mutationQueue.addMutationBatch(S,f,$,l)}).next(D=>{b=D;let $=D.applyToLocalDocumentSet(T,M);return h.documentOverlayCache.saveOverlays(S,D.batchId,$)})}).then(()=>({batchId:b.batchId,changes:sd(T)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(u,l,h){let f=u.Ba[u.currentUser.toKey()];f||(f=new ue(J)),f=f.insert(l,h),u.Ba[u.currentUser.toKey()]=f}(r,i.batchId,t),yield ti(r,i.changes),yield Ss(r.remoteStore)}catch(i){let o=Zu(i,"Failed to persist write");t.reject(o)}})}function Rd(n,e){return V(this,null,function*(){let t=B(n);try{let r=yield Bg(t.localStore,e);e.targetChanges.forEach((i,o)=>{let u=t.Na.get(o);u&&(Z(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?u.va=!0:i.modifiedDocuments.size>0?Z(u.va):i.removedDocuments.size>0&&(Z(u.va),u.va=!1))}),yield ti(t,r,e)}catch(r){yield Xr(r)}})}function Nh(n,e,t){let r=B(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((o,u)=>{let l=u.view.Z_(e);l.snapshot&&i.push(l.snapshot)}),function(u,l){let h=B(u);h.onlineState=l;let f=!1;h.queries.forEach((p,T)=>{for(let b of T.j_)b.Z_(l)&&(f=!0)}),f&&ec(h)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function m_(n,e,t){return V(this,null,function*(){let r=B(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Na.get(e),o=i&&i.key;if(o){let u=new ue(F.comparator);u=u.insert(o,Ue.newNoDocument(o,q.min()));let l=K().add(o),h=new Zi(q.min(),new Map,new ue(J),u,l);yield Rd(r,h),r.Oa=r.Oa.remove(o),r.Na.delete(e),tc(r)}else yield au(r.localStore,e,!1).then(()=>Cu(r,e,t)).catch(Xr)})}function p_(n,e){return V(this,null,function*(){let t=B(n),r=e.batch.batchId;try{let i=yield jg(t.localStore,e);kd(t,r,null),xd(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield ti(t,i)}catch(i){yield Xr(i)}})}function g_(n,e,t){return V(this,null,function*(){let r=B(n);try{let i=yield function(u,l){let h=B(u);return h.persistence.runTransaction("Reject batch","readwrite-primary",f=>{let p;return h.mutationQueue.lookupMutationBatch(f,l).next(T=>(Z(T!==null),p=T.keys(),h.mutationQueue.removeMutationBatch(f,T))).next(()=>h.mutationQueue.performConsistencyCheck(f)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(f,p,l)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,p)).next(()=>h.localDocuments.getDocuments(f,p))})}(r.localStore,e);kd(r,e,t),xd(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield ti(r,i)}catch(i){yield Xr(i)}})}function xd(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function kd(n,e,t){let r=B(n),i=r.Ba[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Cu(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||Md(n,r)})}function Md(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(Qu(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),tc(n))}function Fh(n,e,t){for(let r of t)r instanceof ds?(n.La.addReference(r.key,e),__(n,r)):r instanceof fs?(N("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||Md(n,r.key)):L()}function __(n,e){let t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(N("SyncEngine","New document in limbo: "+t),n.xa.add(r),tc(n))}function tc(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new F(re.fromString(e)),r=n.qa.next();n.Na.set(r,new Au(t)),n.Oa=n.Oa.insert(t,r),Ad(n.remoteStore,new Gr(Ye(Ku(t.path)),r,"TargetPurposeLimboResolution",zh.oe))}}function ti(n,e,t){return V(this,null,function*(){let r=B(n),i=[],o=[],u=[];r.Fa.isEmpty()||(r.Fa.forEach((l,h)=>{u.push(r.Ka(h,e,t).then(f=>{var p;if((f||t)&&r.isPrimaryClient){let T=f?!f.fromCache:(p=t?.targetChanges.get(h.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(h.targetId,T?"current":"not-current")}if(f){i.push(f);let T=ru.Wi(h.targetId,f);o.push(T)}}))}),yield Promise.all(u),r.Ca.d_(i),yield function(h,f){return V(this,null,function*(){let p=B(h);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",T=>P.forEach(f,b=>P.forEach(b.$i,S=>p.persistence.referenceDelegate.addReference(T,b.targetId,S)).next(()=>P.forEach(b.Ui,S=>p.persistence.referenceDelegate.removeReference(T,b.targetId,S)))))}catch(T){if(!Zr(T))throw T;N("LocalStore","Failed to update sequence numbers: "+T)}for(let T of f){let b=T.targetId;if(!T.fromCache){let S=p.os.get(b),x=S.snapshotVersion,M=S.withLastLimboFreeSnapshotVersion(x);p.os=p.os.insert(b,M)}}})}(r.localStore,o))})}function y_(n,e){return V(this,null,function*(){let t=B(n);if(!t.currentUser.isEqual(e)){N("SyncEngine","User change. New user:",e.toKey());let r=yield Id(t.localStore,e);t.currentUser=e,function(o,u){o.ka.forEach(l=>{l.forEach(h=>{h.reject(new k(C.CANCELLED,u))})}),o.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield ti(t,r.hs)}})}function v_(n,e){let t=B(n),r=t.Na.get(e);if(r&&r.va)return K().add(r.key);{let i=K(),o=t.Ma.get(e);if(!o)return i;for(let u of o){let l=t.Fa.get(u);i=i.unionWith(l.view.Va)}return i}}function Nd(n){let e=B(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Rd.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=v_.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=m_.bind(null,e),e.Ca.d_=o_.bind(null,e.eventManager),e.Ca.$a=a_.bind(null,e.eventManager),e}function w_(n){let e=B(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=p_.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=g_.bind(null,e),e}var ms=class{constructor(){this.synchronizeTabs=!1}initialize(e){return V(this,null,function*(){this.serializer=bs(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return Ug(this.persistence,new su,e.initialUser,this.serializer)}createPersistence(e){return new eu(nu.Zr,this.serializer)}createSharedClientState(e){return new uu}terminate(){return V(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var Su=class{initialize(e,t){return V(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Nh(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=y_.bind(null,this.syncEngine),yield r_(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new vu}()}createDatastore(e){let t=bs(e.databaseInfo.databaseId),r=function(o){return new hu(o)}(e.databaseInfo);return function(o,u,l,h){return new mu(o,u,l,h)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,o,u,l){return new gu(r,i,o,u,l)}(this.localStore,this.datastore,e.asyncQueue,t=>Nh(this.syncEngine,t,0),function(){return os.D()?new os:new cu}())}createSyncEngine(e,t){return function(i,o,u,l,h,f,p){let T=new bu(i,o,u,l,h,f);return p&&(T.Qa=!0),T}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return V(this,null,function*(){var e,t;yield function(i){return V(this,null,function*(){let o=B(i);N("RemoteStore","RemoteStore shutting down."),o.L_.add(5),yield ei(o),o.k_.shutdown(),o.q_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()})}};var Pu=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ga(this.observer.next,e)}error(e){this.observer.error?this.Ga(this.observer.error,e):lt("Uncaught Error in snapshot listener:",e.toString())}za(){this.muted=!0}Ga(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var Vu=class{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=me.UNAUTHENTICATED,this.clientId=Ki.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,o=>V(this,null,function*(){N("FirestoreClient","Received user=",o.uid),yield this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,o=>(N("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new k(C.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new ct;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>V(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Zu(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function ra(n,e){return V(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),N("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>V(this,null,function*(){r.isEqual(i)||(yield Id(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function Oh(n,e){return V(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield I_(n);N("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>xh(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>xh(e.remoteStore,i)),n._onlineComponents=e})}function E_(n){return n.name==="FirebaseError"?n.code===C.FAILED_PRECONDITION||n.code===C.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}function I_(n){return V(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){N("FirestoreClient","Using user provided OfflineComponentProvider");try{yield ra(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!E_(t))throw t;Rn("Error using user provided cache. Falling back to memory cache: "+t),yield ra(n,new ms)}}else N("FirestoreClient","Using default OfflineComponentProvider"),yield ra(n,new ms);return n._offlineComponents})}function Fd(n){return V(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(N("FirestoreClient","Using user provided OnlineComponentProvider"),yield Oh(n,n._uninitializedComponentsProvider._online)):(N("FirestoreClient","Using default OnlineComponentProvider"),yield Oh(n,new Su))),n._onlineComponents})}function T_(n){return Fd(n).then(e=>e.syncEngine)}function Lh(n){return V(this,null,function*(){let e=yield Fd(n),t=e.eventManager;return t.onListen=u_.bind(null,e.syncEngine),t.onUnlisten=h_.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=c_.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=d_.bind(null,e.syncEngine),t})}function Od(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var Uh=new Map;function Ld(n,e,t){if(!t)throw new k(C.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function A_(n,e,t,r){if(e===!0&&r===!0)throw new k(C.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function jh(n){if(!F.isDocumentKey(n))throw new k(C.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Bh(n){if(F.isDocumentKey(n))throw new k(C.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Ps(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":L()}function Ur(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new k(C.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Ps(n);throw new k(C.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var ps=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new k(C.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new k(C.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}A_("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Od((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new k(C.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new k(C.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new k(C.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Bn=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ps({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new k(C.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new k(C.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ps(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new ia;switch(r.type){case"firstParty":return new ua(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new k(C.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=Uh.get(t);r&&(N("ComponentProvider","Removing Datastore"),Uh.delete(t),r.terminate())}(this),Promise.resolve()}};function Ud(n,e,t,r={}){var i;let o=(n=Ur(n,Bn))._getSettings(),u=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==u&&Rn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:u,ssl:!1})),r.mockUserToken){let l,h;if(typeof r.mockUserToken=="string")l=r.mockUserToken,h=me.MOCK_USER;else{l=Hl(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new k(C.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new me(f)}n._authCredentials=new sa(new zi(l,h))}}var cn=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},xe=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Rt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Rt=class n extends cn{constructor(e,t,r){super(e,t,Ku(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new xe(this.firestore,null,new F(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function jd(n,e,...t){if(n=it(n),Ld("collection","path",e),n instanceof Bn){let r=re.fromString(e,...t);return Bh(r),new Rt(n,null,r)}{if(!(n instanceof xe||n instanceof Rt))throw new k(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(re.fromString(e,...t));return Bh(r),new Rt(n.firestore,null,r)}}function Bd(n,e,...t){if(n=it(n),arguments.length===1&&(e=Ki.newId()),Ld("doc","path",e),n instanceof Bn){let r=re.fromString(e,...t);return jh(r),new xe(n,null,new F(r))}{if(!(n instanceof xe||n instanceof Rt))throw new k(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(re.fromString(e,...t));return jh(r),new xe(n.firestore,n instanceof Rt?n.converter:null,new F(r))}}var Du=class{constructor(){this.au=Promise.resolve(),this.uu=[],this.cu=!1,this.lu=[],this.hu=null,this.Pu=!1,this.Iu=!1,this.Tu=[],this.t_=new as(this,"async_queue_retry"),this.Eu=()=>{let t=na();t&&N("AsyncQueue","Visibility state changed to "+t.visibilityState),this.t_.jo()};let e=na();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Eu)}get isShuttingDown(){return this.cu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.du(),this.Au(e)}enterRestrictedMode(e){if(!this.cu){this.cu=!0,this.Iu=e||!1;let t=na();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Eu)}}enqueue(e){if(this.du(),this.cu)return new Promise(()=>{});let t=new ct;return this.Au(()=>this.cu&&this.Iu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.uu.push(e),this.Ru()))}Ru(){return V(this,null,function*(){if(this.uu.length!==0){try{yield this.uu[0](),this.uu.shift(),this.t_.reset()}catch(e){if(!Zr(e))throw e;N("AsyncQueue","Operation failed with retryable error: "+e)}this.uu.length>0&&this.t_.Go(()=>this.Ru())}})}Au(e){let t=this.au.then(()=>(this.Pu=!0,e().catch(r=>{this.hu=r,this.Pu=!1;let i=function(u){let l=u.message||"";return u.stack&&(l=u.stack.includes(u.message)?u.stack:u.message+`
`+u.stack),l}(r);throw lt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Pu=!1,r))));return this.au=t,t}enqueueAfterDelay(e,t,r){this.du(),this.Tu.indexOf(e)>-1&&(t=0);let i=_u.createAndSchedule(this,e,t,r,o=>this.Vu(o));return this.lu.push(i),i}du(){this.hu&&L()}verifyOperationInProgress(){}mu(){return V(this,null,function*(){let e;do e=this.au,yield e;while(e!==this.au)})}fu(e){for(let t of this.lu)if(t.timerId===e)return!0;return!1}gu(e){return this.mu().then(()=>{this.lu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.lu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.mu()})}pu(e){this.Tu.push(e)}Vu(e){let t=this.lu.indexOf(e);this.lu.splice(t,1)}};function qh(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let o of r)if(o in i&&typeof i[o]=="function")return!0;return!1}(n,["next","error","complete"])}var qn=class extends Bn{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new Du}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||$d(this),this._firestoreClient.terminate()}};function Vs(n,e){let t=typeof n=="object"?n:Pr(),r=typeof n=="string"?n:e||"(default)",i=Oo(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let o=Wl("firestore");o&&Ud(i,...o)}return i}function qd(n){return n._firestoreClient||$d(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function $d(n){var e,t,r;let i=n._freezeSettings(),o=function(l,h,f,p){return new fa(l,h,f,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,Od(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new Vu(n._authCredentials,n._appCheckCredentials,n._queue,o),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}var Wr=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Te.fromBase64String(e))}catch(t){throw new k(C.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Te.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Hr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new k(C.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Re(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var gs=class{constructor(e){this._methodName=e}};var Qr=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new k(C.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new k(C.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return J(this._lat,e._lat)||J(this._long,e._long)}};var Jr=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}};var b_=/^__.*__$/,Ru=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new ft(e,this.data,this.fieldMask,t,this.fieldTransforms):new un(e,this.data,t,this.fieldTransforms)}};function Gd(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw L()}}var xu=class n{constructor(e,t,r,i,o,u){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.yu(),this.fieldTransforms=o||[],this.fieldMask=u||[]}get path(){return this.settings.path}get wu(){return this.settings.wu}Su(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}bu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.vu(e),i}Cu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.yu(),i}Fu(e){return this.Su({path:void 0,Du:!0})}Mu(e){return _s(e,this.settings.methodName,this.settings.xu||!1,this.path,this.settings.Ou)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}yu(){if(this.path)for(let e=0;e<this.path.length;e++)this.vu(this.path.get(e))}vu(e){if(e.length===0)throw this.Mu("Document fields must not be empty");if(Gd(this.wu)&&b_.test(e))throw this.Mu('Document fields cannot begin and end with "__"')}},ku=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||bs(e)}Nu(e,t,r,i=!1){return new xu({wu:e,methodName:t,Ou:r,path:Re.emptyPath(),Du:!1,xu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function zd(n){let e=n._freezeSettings(),t=bs(n._databaseId);return new ku(n._databaseId,!!e.ignoreUndefinedProperties,t)}function C_(n,e,t,r,i,o={}){let u=n.Nu(o.merge||o.mergeFields?2:0,e,t,i);Hd("Data must be an object, but it was:",u,r);let l=Kd(r,u),h,f;if(o.merge)h=new Qe(u.fieldMask),f=u.fieldTransforms;else if(o.mergeFields){let p=[];for(let T of o.mergeFields){let b=P_(e,T,t);if(!u.contains(b))throw new k(C.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);D_(p,b)||p.push(b)}h=new Qe(p),f=u.fieldTransforms.filter(T=>h.covers(T.field))}else h=null,f=u.fieldTransforms;return new Ru(new Le(l),h,f)}function S_(n,e,t,r=!1){return nc(t,n.Nu(r?4:3,e))}function nc(n,e){if(Wd(n=it(n)))return Hd("Unsupported field value:",e,n),Kd(n,e);if(n instanceof gs)return function(r,i){if(!Gd(i.wu))throw i.Mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Mu(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Du&&e.wu!==4)throw e.Mu("Nested arrays are not supported");return function(r,i){let o=[],u=0;for(let l of r){let h=nc(l,i.Fu(u));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),u++}return{arrayValue:{values:o}}}(n,e)}return function(r,i){if((r=it(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return fg(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=fe.fromDate(r);return{timestampValue:rs(i.serializer,o)}}if(r instanceof fe){let o=new fe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:rs(i.serializer,o)}}if(r instanceof Qr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Wr)return{bytesValue:pd(i.serializer,r._byteString)};if(r instanceof xe){let o=i.databaseId,u=r.firestore._databaseId;if(!u.isEqual(o))throw i.Mu(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Hu(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Jr)return function(u,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:u.toArray().map(h=>{if(typeof h!="number")throw l.Mu("VectorValues must only contain numeric values.");return Wu(l.serializer,h)})}}}}}}(r,i);throw i.Mu(`Unsupported field value: ${Ps(r)}`)}(n,e)}function Kd(n,e){let t={};return Kh(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Gn(n,(r,i)=>{let o=nc(i,e.bu(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function Wd(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof fe||n instanceof Qr||n instanceof Wr||n instanceof xe||n instanceof gs||n instanceof Jr)}function Hd(n,e,t){if(!Wd(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=Ps(t);throw r==="an object"?e.Mu(n+" a custom object"):e.Mu(n+" "+r)}}function P_(n,e,t){if((e=it(e))instanceof Hr)return e._internalPath;if(typeof e=="string")return Qd(n,e);throw _s("Field path arguments must be of type string or ",n,!1,void 0,t)}var V_=new RegExp("[~\\*/\\[\\]]");function Qd(n,e,t){if(e.search(V_)>=0)throw _s(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Hr(...e.split("."))._internalPath}catch{throw _s(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function _s(n,e,t,r,i){let o=r&&!r.isEmpty(),u=i!==void 0,l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let h="";return(o||u)&&(h+=" (found",o&&(h+=` in field ${r}`),u&&(h+=` in document ${i}`),h+=")"),new k(C.INVALID_ARGUMENT,l+n+h)}function D_(n,e){return n.some(t=>t.isEqual(e))}var ys=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new xe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Mu(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(rc("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Mu=class extends ys{data(){return super.data()}};function rc(n,e){return typeof e=="string"?Qd(n,e):e instanceof Hr?e._internalPath:e._delegate._internalPath}function R_(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new k(C.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Yr=class{},vs=class extends Yr{};function Jd(n,e,...t){let r=[];e instanceof Yr&&r.push(e),r=r.concat(t),function(o){let u=o.filter(h=>h instanceof Fu).length,l=o.filter(h=>h instanceof Nu).length;if(u>1||u>0&&l>0)throw new k(C.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var Nu=class n extends vs{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return Xd(e._query,t),new cn(e.firestore,e.converter,Ca(e._query,t))}_parse(e){let t=zd(e.firestore);return function(o,u,l,h,f,p,T){let b;if(f.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new k(C.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){Gh(T,p);let S=[];for(let x of T)S.push($h(h,o,x));b={arrayValue:{values:S}}}else b=$h(h,o,T)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||Gh(T,p),b=S_(l,u,T,p==="in"||p==="not-in");return de.create(f,p,b)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};var Fu=class n extends Yr{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:je.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,o){let u=i,l=o.getFlattenedFilters();for(let h of l)Xd(u,h),u=Ca(u,h)}(e._query,t),new cn(e.firestore,e.converter,Ca(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var Ou=class n extends vs{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,o,u){if(i.startAt!==null)throw new k(C.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new k(C.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new sn(o,u)}(e._query,this._field,this._direction);return new cn(e.firestore,e.converter,function(i,o){let u=i.explicitOrderBy.concat([o]);return new kt(i.path,i.collectionGroup,u,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function Yd(n,e="asc"){let t=e,r=rc("orderBy",n);return Ou._create(r,t)}function $h(n,e,t){if(typeof(t=it(t))=="string"){if(t==="")throw new k(C.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!td(e)&&t.indexOf("/")!==-1)throw new k(C.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(re.fromString(t));if(!F.isDocumentKey(r))throw new k(C.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return mh(n,new F(r))}if(t instanceof xe)return mh(n,t._key);throw new k(C.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ps(t)}.`)}function Gh(n,e){if(!Array.isArray(n)||n.length===0)throw new k(C.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Xd(n,e){let t=function(i,o){for(let u of i)for(let l of u.getFlattenedFilters())if(o.indexOf(l.op)>=0)return l.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new k(C.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new k(C.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Lu=class{convertValue(e,t="none"){switch(rn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ne(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(xt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw L()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Gn(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){var t,r,i;let o=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(u=>ne(u.doubleValue));return new Jr(o)}convertGeoPoint(e){return new Qr(ne(e.latitude),ne(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=qu(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Br(e));default:return null}}convertTimestamp(e){let t=ht(e);return new fe(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=re.fromString(e);Z(Ed(r));let i=new Ji(r.get(1),r.get(3)),o=new F(r.popFirst(5));return i.isEqual(t)||lt(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function x_(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var Zt=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},ws=class extends ys{constructor(e,t,r,i,o,u){super(e,t,r,i,u),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Dn(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(rc("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Dn=class extends ws{data(e={}){return super.data(e)}},Uu=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Zt(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Dn(this._firestore,this._userDataWriter,r.key,r,new Zt(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new k(C.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let u=0;return i._snapshot.docChanges.map(l=>{let h=new Dn(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Zt(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:h,oldIndex:-1,newIndex:u++}})}{let u=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>o||l.type!==3).map(l=>{let h=new Dn(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Zt(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter),f=-1,p=-1;return l.type!==0&&(f=u.indexOf(l.doc.key),u=u.delete(l.doc.key)),l.type!==1&&(u=u.add(l.doc),p=u.indexOf(l.doc.key)),{type:k_(l.type),doc:h,oldIndex:f,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function k_(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return L()}}var Es=class extends Lu{constructor(e){super(),this.firestore=e}convertBytes(e){return new Wr(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new xe(this.firestore,null,t)}};function Zd(n,e){let t=Ur(n.firestore,qn),r=Bd(n),i=x_(n.converter,e);return M_(t,[C_(zd(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,en.exists(!1))]).then(()=>r)}function ic(n,...e){var t,r,i;n=it(n);let o={includeMetadataChanges:!1,source:"default"},u=0;typeof e[u]!="object"||qh(e[u])||(o=e[u],u++);let l={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(qh(e[u])){let T=e[u];e[u]=(t=T.next)===null||t===void 0?void 0:t.bind(T),e[u+1]=(r=T.error)===null||r===void 0?void 0:r.bind(T),e[u+2]=(i=T.complete)===null||i===void 0?void 0:i.bind(T)}let h,f,p;if(n instanceof xe)f=Ur(n.firestore,qn),p=Ku(n._key.path),h={next:T=>{e[u]&&e[u](N_(f,n,T))},error:e[u+1],complete:e[u+2]};else{let T=Ur(n,cn);f=Ur(T.firestore,qn),p=T._query;let b=new Es(f);h={next:S=>{e[u]&&e[u](new Uu(f,b,T,S))},error:e[u+1],complete:e[u+2]},R_(n._query)}return function(b,S,x,M){let D=new Pu(M),$=new Eu(S,D,x);return b.asyncQueue.enqueueAndForget(()=>V(this,null,function*(){return i_(yield Lh(b),$)})),()=>{D.za(),b.asyncQueue.enqueueAndForget(()=>V(this,null,function*(){return s_(yield Lh(b),$)}))}}(qd(f),p,l,h)}function M_(n,e){return function(r,i){let o=new ct;return r.asyncQueue.enqueueAndForget(()=>V(this,null,function*(){return f_(yield T_(r),i,o)})),o.promise}(qd(n),e)}function N_(n,e,t){let r=t.docs.get(e._key),i=new Es(n);return new ws(n,i,e._key,r,new Zt(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){$n=i})(Zl),Sr(new Cr("firestore",(r,{instanceIdentifier:i,options:o})=>{let u=r.getProvider("app").getImmediate(),l=new qn(new oa(r.getProvider("auth-internal")),new la(r.getProvider("app-check-internal")),function(f,p){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new k(C.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ji(f.options.projectId,p)}(u,i),u);return o=Object.assign({useFetchStreams:t},o),l._setSettings(o),l},"PUBLIC").setMultipleInstances(!0)),we(lh,"4.7.1",e),we(lh,"4.7.1","esm2017")})();var Ds=function(){return Ds=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Ds.apply(this,arguments)};var L_={includeMetadataChanges:!1};function ef(n,e){return e===void 0&&(e=L_),new yt(function(t){var r=ic(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function tf(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:Ds(Ds({},r),(t={},t[e.idField]=n.id,t))}function nf(n){return ef(n,{includeMetadataChanges:!0}).pipe(rt(function(e){return e.docs}))}function rf(n,e){return e===void 0&&(e={}),nf(n).pipe(rt(function(t){return t.map(function(r){return tf(r,e)})}))}var Be=class{constructor(e){return e}},sf="firestore",sc=class{constructor(){return Vr(sf)}};var oc=new se("angularfire2.firestore-instances");function U_(n,e){let t=Ni(sf,n,e);return t&&new Be(t)}function j_(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Be(r)}}var B_={provide:sc,deps:[[new De,oc]]},q_={provide:Be,useFactory:U_,deps:[[new De,oc],at]};function of(n,...e){return we("angularfire",Pt.full,"fst"),yn([q_,B_,{provide:oc,useFactory:j_(n),multi:!0,deps:[Oe,Kt,Vt,Jt,[new De,Rr],[new De,ot],...e]}])}var af=Pe(rf,!0);var Kn=Pe(Zd,!0);var hn=Pe(jd,!0);var uf=Pe(Vs,!0);var cf=Pe(Yd,!0);var lf=Pe(Jd,!0);var vf=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=o=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(Y(Po),Y(So))},e.\u0275dir=Fe({type:e});let n=e;return n})(),$_=(()=>{let e=class e extends vf{};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=Co(e)))(o||e)}})(),e.\u0275dir=Fe({type:e,features:[wt]});let n=e;return n})(),wf=new se("");var G_={provide:wf,useExisting:vr(()=>Ft),multi:!0};function z_(){let n=Mo()?Mo().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var K_=new se(""),Ft=(()=>{let e=class e extends vf{constructor(r,i,o){super(r,i),this._compositionMode=o,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!z_())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(Y(Po),Y(So),Y(K_,8))},e.\u0275dir=Fe({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,o){i&1&&ae("input",function(l){return o._handleInput(l.target.value)})("blur",function(){return o.onTouched()})("compositionstart",function(){return o._compositionStart()})("compositionend",function(l){return o._compositionEnd(l.target.value)})},features:[Ar([G_]),wt]});let n=e;return n})();function W_(n){return n==null||(typeof n=="string"||Array.isArray(n))&&n.length===0}var cc=new se(""),Ef=new se("");function H_(n){return W_(n.value)?{required:!0}:null}function hf(n){return null}function If(n){return n!=null}function Tf(n){return Fl(n)?_n(n):n}function Af(n){let e={};return n.forEach(t=>{e=t!=null?ke(ke({},e),t):e}),Object.keys(e).length===0?null:e}function bf(n,e){return e.map(t=>t(n))}function Q_(n){return!n.validate}function Cf(n){return n.map(e=>Q_(e)?e:t=>e.validate(t))}function J_(n){if(!n)return null;let e=n.filter(If);return e.length==0?null:function(t){return Af(bf(t,e))}}function lc(n){return n!=null?J_(Cf(n)):null}function Y_(n){if(!n)return null;let e=n.filter(If);return e.length==0?null:function(t){let r=bf(t,e).map(Tf);return Sl(r).pipe(rt(Af))}}function hc(n){return n!=null?Y_(Cf(n)):null}function df(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function X_(n){return n._rawValidators}function Z_(n){return n._rawAsyncValidators}function uc(n){return n?Array.isArray(n)?n:[n]:[]}function xs(n,e){return Array.isArray(n)?n.includes(e):n===e}function ff(n,e){let t=uc(e);return uc(n).forEach(i=>{xs(t,i)||t.push(i)}),t}function mf(n,e){return uc(e).filter(t=>!xs(n,t))}var ks=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=lc(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=hc(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Qn=class extends ks{get formDirective(){return null}get path(){return null}},ai=class extends ks{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},Ms=class{constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},ey={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},BE=$e(ke({},ey),{"[class.ng-submitted]":"isSubmitted"}),Yn=(()=>{let e=class e extends Ms{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(Y(ai,2))},e.\u0275dir=Fe({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,o){i&2&&Vo("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)},features:[wt]});let n=e;return n})(),Ls=(()=>{let e=class e extends Ms{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(Y(Qn,10))},e.\u0275dir=Fe({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,o){i&2&&Vo("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)("ng-submitted",o.isSubmitted)},features:[wt]});let n=e;return n})();var ni="VALID",Rs="INVALID",Wn="PENDING",ri="DISABLED",Jn=class{},Ns=class extends Jn{constructor(e,t){super(),this.value=e,this.source=t}},si=class extends Jn{constructor(e,t){super(),this.pristine=e,this.source=t}},oi=class extends Jn{constructor(e,t){super(),this.touched=e,this.source=t}},Hn=class extends Jn{constructor(e,t){super(),this.status=e,this.source=t}};function Sf(n){return(Us(n)?n.validators:n)||null}function ty(n){return Array.isArray(n)?lc(n):n||null}function Pf(n,e){return(Us(e)?e.asyncValidators:n)||null}function ny(n){return Array.isArray(n)?hc(n):n||null}function Us(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function ry(n,e,t){let r=n.controls;if(!(e?Object.keys(r):r).length)throw new Vi(1e3,"");if(!r[t])throw new Vi(1001,"")}function iy(n,e,t){n._forEachChild((r,i)=>{if(t[i]===void 0)throw new Vi(1002,"")})}var Fs=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=br(()=>this.statusReactive()),this.statusReactive=Ir(void 0),this._pristine=br(()=>this.pristineReactive()),this.pristineReactive=Ir(!0),this._touched=br(()=>this.touchedReactive()),this.touchedReactive=Ir(!1),this._events=new Pi,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return bt(this.statusReactive)}set status(e){bt(()=>this.statusReactive.set(e))}get valid(){return this.status===ni}get invalid(){return this.status===Rs}get pending(){return this.status==Wn}get disabled(){return this.status===ri}get enabled(){return this.status!==ri}get pristine(){return bt(this.pristineReactive)}set pristine(e){bt(()=>this.pristineReactive.set(e))}get dirty(){return!this.pristine}get touched(){return bt(this.touchedReactive)}set touched(e){bt(()=>this.touchedReactive.set(e))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(ff(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(ff(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(mf(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(mf(e,this._rawAsyncValidators))}hasValidator(e){return xs(this._rawValidators,e)}hasAsyncValidator(e){return xs(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched($e(ke({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new oi(!0,r))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),t&&e.emitEvent!==!1&&this._events.next(new oi(!1,r))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty($e(ke({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new si(!1,r))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),t&&e.emitEvent!==!1&&this._events.next(new si(!0,r))}markAsPending(e={}){this.status=Wn;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Hn(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending($e(ke({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=ri,this.errors=null,this._forEachChild(i=>{i.disable($e(ke({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Ns(this.value,r)),this._events.next(new Hn(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors($e(ke({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=ni,this._forEachChild(r=>{r.enable($e(ke({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors($e(ke({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===ni||this.status===Wn)&&this._runAsyncValidator(r,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Ns(this.value,t)),this._events.next(new Hn(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity($e(ke({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?ri:ni}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=Wn,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let r=Tf(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new Hn(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,r)}_initObservables(){this.valueChanges=new wr,this.statusChanges=new wr}_calculateStatus(){return this._allControlsDisabled()?ri:this.errors?Rs:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Wn)?Wn:this._anyControlsHaveStatus(Rs)?Rs:ni}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),i&&this._events.next(new si(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new oi(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Us(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=ty(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=ny(this._rawAsyncValidators)}},Os=class extends Fs{constructor(e,t,r){super(Sf(t),Pf(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){iy(this,!0,e),Object.keys(e).forEach(r=>{ry(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>r._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,o)=>{r=t(r,i,o)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var dc=new se("CallSetDisabledState",{providedIn:"root",factory:()=>fc}),fc="always";function sy(n,e){return[...e.path,n]}function Vf(n,e,t=fc){Df(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),ay(n,e),cy(n,e),uy(n,e),oy(n,e)}function pf(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function oy(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function Df(n,e){let t=X_(n);e.validator!==null?n.setValidators(df(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=Z_(n);e.asyncValidator!==null?n.setAsyncValidators(df(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();pf(e._rawValidators,i),pf(e._rawAsyncValidators,i)}function ay(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&Rf(n,e)})}function uy(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&Rf(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function Rf(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function cy(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function ly(n,e){n==null,Df(n,e)}function hy(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function dy(n){return Object.getPrototypeOf(n.constructor)===$_}function fy(n,e){n._syncPendingControls(),e.forEach(t=>{let r=t.control;r.updateOn==="submit"&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function my(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(o=>{o.constructor===Ft?t=o:dy(o)?r=o:i=o}),i||r||t||null}var py={provide:Qn,useExisting:vr(()=>ui)},ii=Promise.resolve(),ui=(()=>{let e=class e extends Qn{get submitted(){return bt(this.submittedReactive)}constructor(r,i,o){super(),this.callSetDisabledState=o,this._submitted=br(()=>this.submittedReactive()),this.submittedReactive=Ir(!1),this._directives=new Set,this.ngSubmit=new wr,this.form=new Os({},lc(r),hc(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(r){ii.then(()=>{let i=this._findContainer(r.path);r.control=i.registerControl(r.name,r.control),Vf(r.control,r,this.callSetDisabledState),r.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(r)})}getControl(r){return this.form.get(r.path)}removeControl(r){ii.then(()=>{let i=this._findContainer(r.path);i&&i.removeControl(r.name),this._directives.delete(r)})}addFormGroup(r){ii.then(()=>{let i=this._findContainer(r.path),o=new Os({});ly(o,r),i.registerControl(r.name,o),o.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(r){ii.then(()=>{let i=this._findContainer(r.path);i&&i.removeControl(r.name)})}getFormGroup(r){return this.form.get(r.path)}updateModel(r,i){ii.then(()=>{this.form.get(r.path).setValue(i)})}setValue(r){this.control.setValue(r)}onSubmit(r){return this.submittedReactive.set(!0),fy(this.form,this._directives),this.ngSubmit.emit(r),r?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(r=void 0){this.form.reset(r),this.submittedReactive.set(!1)}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(r){return r.pop(),r.length?this.form.get(r):this.form}};e.\u0275fac=function(i){return new(i||e)(Y(cc,10),Y(Ef,10),Y(dc,8))},e.\u0275dir=Fe({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,o){i&1&&ae("submit",function(l){return o.onSubmit(l)})("reset",function(){return o.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Ar([py]),wt]});let n=e;return n})();function gf(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function _f(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var gy=class extends Fs{constructor(e=null,t,r){super(Sf(t),Pf(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Us(t)&&(t.nonNullable||t.initialValueIsDefault)&&(_f(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){gf(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){gf(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){_f(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var _y={provide:ai,useExisting:vr(()=>dn)},yf=Promise.resolve(),dn=(()=>{let e=class e extends ai{constructor(r,i,o,u,l,h){super(),this._changeDetectorRef=l,this.callSetDisabledState=h,this.control=new gy,this._registered=!1,this.name="",this.update=new wr,this._parent=r,this._setValidators(i),this._setAsyncValidators(o),this.valueAccessor=my(this,u)}ngOnChanges(r){if(this._checkForErrors(),!this._registered||"name"in r){if(this._registered&&(this._checkName(),this.formDirective)){let i=r.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in r&&this._updateDisabled(r),hy(r,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){Vf(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(r){yf.then(()=>{this.control.setValue(r,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(r){let i=r.isDisabled.currentValue,o=i!==0&&ko(i);yf.then(()=>{o&&!this.control.disabled?this.control.disable():!o&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(r){return this._parent?sy(r,this._parent):[r]}};e.\u0275fac=function(i){return new(i||e)(Y(Qn,9),Y(cc,10),Y(Ef,10),Y(wf,10),Y(Ll,8),Y(dc,8))},e.\u0275dir=Fe({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Ar([_y]),wt,bo]});let n=e;return n})(),js=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Fe({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]});let n=e;return n})();var yy=(()=>{let e=class e{constructor(){this._validator=hf}ngOnChanges(r){if(this.inputName in r){let i=this.normalizeInput(r[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):hf,this._onChange&&this._onChange()}}validate(r){return this._validator(r)}registerOnValidatorChange(r){this._onChange=r}enabled(r){return r!=null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Fe({type:e,features:[bo]});let n=e;return n})();var vy={provide:cc,useExisting:vr(()=>ci),multi:!0};var ci=(()=>{let e=class e extends yy{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=ko,this.createValidator=r=>H_}enabled(r){return r}};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=Co(e)))(o||e)}})(),e.\u0275dir=Fe({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(i,o){i&2&&Rl("required",o._enabled?"":null)},inputs:{required:"required"},features:[Ar([vy]),wt]});let n=e;return n})();var wy=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ri({type:e}),e.\u0275inj=Di({});let n=e;return n})();var Xn=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:dc,useValue:r.callSetDisabledState??fc}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ri({type:e}),e.\u0275inj=Di({imports:[wy]});let n=e;return n})();var Bs={projectId:"sala-de-juegos-59d90",appId:"1:1000227605196:web:ed6371a18bbdaa3eb19069",storageBucket:"sala-de-juegos-59d90.appspot.com",apiKey:"AIzaSyAHNTs5amejnX-GYcdKbkUPQYVHEKb1h2g",authDomain:"sala-de-juegos-59d90.firebaseapp.com",messagingSenderId:"1000227605196"};var Ey=new Map,Iy={activated:!1,tokenObservers:[]},Ty={initialized:!1,enabled:!1};function qe(n){return Ey.get(n)||Object.assign({},Iy)}function Ff(){return Ty}var Ay="https://content-firebaseappcheck.googleapis.com/v1";var by="exchangeDebugToken",xf={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},ZE=24*60*60*1e3;var gc=class{constructor(e,t,r,i,o){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=o,this.pending=null,this.nextErrorWaitInterval=i,i>o)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return V(this,null,function*(){this.stop();try{this.pending=new No,this.pending.promise.catch(t=>{}),yield Cy(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new No,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function Cy(n){return new Promise(e=>{setTimeout(e,n)})}var Sy={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},Ot=new Xl("appCheck","AppCheck",Sy);function Of(n){if(!qe(n).activated)throw Ot.create("use-before-activation",{appName:n.name})}function Lf(r,i){return V(this,arguments,function*({url:n,body:e},t){let o={"Content-Type":"application/json"},u=t.getImmediate({optional:!0});if(u){let S=yield u.getHeartbeatsHeader();S&&(o["X-Firebase-Client"]=S)}let l={method:"POST",body:JSON.stringify(e),headers:o},h;try{h=yield fetch(n,l)}catch(S){throw Ot.create("fetch-network-error",{originalErrorMessage:S?.message})}if(h.status!==200)throw Ot.create("fetch-status-error",{httpStatus:h.status});let f;try{f=yield h.json()}catch(S){throw Ot.create("fetch-parse-error",{originalErrorMessage:S?.message})}let p=f.ttl.match(/^([\d.]+)(s)$/);if(!p||!p[2]||isNaN(Number(p[1])))throw Ot.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${f.ttl}`});let T=Number(p[1])*1e3,b=Date.now();return{token:f.token,expireTimeMillis:b+T,issuedAtTimeMillis:b}})}function Uf(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${Ay}/projects/${t}/apps/${r}:${by}?key=${i}`,body:{debug_token:e}}}var Py="firebase-app-check-database",Vy=1,_c="firebase-app-check-store";var qs=null;function Dy(){return qs||(qs=new Promise((n,e)=>{try{let t=indexedDB.open(Py,Vy);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(Ot.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(_c,{keyPath:"compositeKey"})}}}catch(t){e(Ot.create("storage-open",{originalErrorMessage:t?.message}))}}),qs)}function Ry(n,e){return xy(ky(n),e)}function xy(n,e){return V(this,null,function*(){let r=(yield Dy()).transaction(_c,"readwrite"),o=r.objectStore(_c).put({compositeKey:n,value:e});return new Promise((u,l)=>{o.onsuccess=h=>{u()},r.onerror=h=>{var f;l(Ot.create("storage-set",{originalErrorMessage:(f=h.target.error)===null||f===void 0?void 0:f.message}))}})})}function ky(n){return`${n.options.appId}-${n.name}`}var yc=new xi("@firebase/app-check");function pc(n,e){return Fo()?Ry(n,e).catch(t=>{yc.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function jf(){return Ff().enabled}function Bf(){return V(this,null,function*(){let n=Ff();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var My={error:"UNKNOWN_ERROR"};function Ny(n){return Kl.encodeString(JSON.stringify(n),!1)}function vc(n,e=!1){return V(this,null,function*(){let t=n.app;Of(t);let r=qe(t),i=r.token,o;if(i&&!li(i)&&(r.token=void 0,i=void 0),!i){let h=yield r.cachedTokenPromise;h&&(li(h)?i=h:yield pc(t,void 0))}if(!e&&i&&li(i))return{token:i.token};let u=!1;if(jf()){r.exchangeTokenPromise||(r.exchangeTokenPromise=Lf(Uf(t,yield Bf()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),u=!0);let h=yield r.exchangeTokenPromise;return yield pc(t,h),r.token=h,{token:h.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),u=!0),i=yield qe(t).exchangeTokenPromise}catch(h){h.code==="appCheck/throttled"?yc.warn(h.message):yc.error(h),o=h}let l;return i?o?li(i)?l={token:i.token,internalError:o}:l=Mf(o):(l={token:i.token},r.token=i,yield pc(t,i)):l=Mf(o),u&&Uy(t,l),l})}function Fy(n){return V(this,null,function*(){let e=n.app;Of(e);let{provider:t}=qe(e);if(jf()){let r=yield Bf(),{token:i}=yield Lf(Uf(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function Oy(n,e,t,r){let{app:i}=n,o=qe(i),u={next:t,error:r,type:e};if(o.tokenObservers=[...o.tokenObservers,u],o.token&&li(o.token)){let l=o.token;Promise.resolve().then(()=>{t({token:l.token}),kf(n)}).catch(()=>{})}o.cachedTokenPromise.then(()=>kf(n))}function qf(n,e){let t=qe(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function kf(n){let{app:e}=n,t=qe(e),r=t.tokenRefresher;r||(r=Ly(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function Ly(n){let{app:e}=n;return new gc(()=>V(this,null,function*(){let t=qe(e),r;if(t.token?r=yield vc(n,!0):r=yield vc(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=qe(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},xf.RETRIAL_MIN_WAIT,xf.RETRIAL_MAX_WAIT)}function Uy(n,e){let t=qe(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function li(n){return n.expireTimeMillis-Date.now()>0}function Mf(n){return{token:Ny(My),error:n}}var wc=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=qe(this.app);for(let t of e)qf(this.app,t.next);return Promise.resolve()}};function jy(n,e){return new wc(n,e)}function By(n){return{getToken:e=>vc(n,e),getLimitedUseToken:()=>Fy(n),addTokenListener:e=>Oy(n,"INTERNAL",e),removeTokenListener:e=>qf(n.app,e)}}var qy="@firebase/app-check",$y="0.8.7";var Gy="app-check",Nf="app-check-internal";function zy(){Sr(new Cr(Gy,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return jy(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(Nf).initialize()})),Sr(new Cr(Nf,n=>{let e=n.getProvider("app-check").getImmediate();return By(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),we(qy,$y)}zy();var Ky=["localhost","0.0.0.0","127.0.0.1"],hI=typeof window<"u"&&Ky.includes(window.location.hostname);var Hy="firebase",Qy="10.13.1";Ht.registerVersion(Hy,Qy,"app-compat");var Jy=["ngOnDestroy"],Gf=(n,e,t,r={})=>new Proxy(n,{get:(i,o)=>t.runOutsideAngular(()=>{if(n[o])return r?.spy?.get&&r.spy.get(o,n[o]),n[o];if(Jy.indexOf(o)>-1)return()=>{};let u=e.toPromise().then(l=>{let h=l?.[o];return typeof h=="function"?h.bind(l):h?.then?h.then(f=>t.run(()=>f)):t.run(()=>h)});return new Proxy(()=>{},{get:(l,h)=>u[h],apply:(l,h,f)=>u.then(p=>{let T=p?.(...f);return r?.spy?.apply&&r.spy.apply(o,f,T),T})})})});var Ec=class{constructor(e){return e}},zf=new se("angularfire2.app.options"),Kf=new se("angularfire2.app.name");function Wf(n,e,t){let r=typeof t=="string"&&t||"[DEFAULT]",i=typeof t=="object"&&t||{};i.name=i.name||r;let u=Ht.apps.filter(l=>l&&l.name===i.name)[0]||e.runOutsideAngular(()=>Ht.initializeApp(n,i));try{if(JSON.stringify(n)!==JSON.stringify(u.options)){let l=!!module.hot;Yy("error",`${u.name} Firebase App already initialized with different options${l?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Ec(u)}var Yy=(n,...e)=>{xo()&&typeof console<"u"&&console[n](...e)};function Hf(n,e,t,r,i){let[,o,u]=globalThis.\u0275AngularfireInstanceCache.find(l=>l[0]===n)||[];if(o)return Xy(i,u)||($f("error",`${e} was already initialized on the ${t} Firebase App with different settings.${Zy?" You may need to reload as Firebase is not HMR aware.":""}`),$f("warn",{is:i,was:u})),o;{let l=r();return globalThis.\u0275AngularfireInstanceCache.push([n,l,i]),l}}function Xy(n,e){try{return n.toString()===e.toString()}catch{return n===e}}var Zy=typeof module<"u"&&!!module.hot,$f=(n,...e)=>{xo()&&typeof console<"u"&&console[n](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var ev=new se("angularfire2.auth.use-emulator"),tv=new se("angularfire2.auth.settings"),nv=new se("angularfire2.auth.tenant-id"),rv=new se("angularfire2.auth.langugage-code"),iv=new se("angularfire2.auth.use-device-language"),sv=new se("angularfire.auth.persistence"),ov=(n,e,t,r,i,o,u,l)=>Hf(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{let h=e.runOutsideAngular(()=>n.auth());if(t&&h.useEmulator(...t),r&&(h.tenantId=r),h.languageCode=i,o&&h.useDeviceLanguage(),u)for(let[f,p]of Object.entries(u))h.settings[f]=p;return l&&h.setPersistence(l),h},[t,r,i,o,u,l]),Qf=(()=>{class n{authState;idToken;user;idTokenResult;credential;constructor(t,r,i,o,u,l,h,f,p,T,b,S){let x=new Pi,M=yr(void 0).pipe(vt(u.outsideAngular),Gt(()=>o.runOutsideAngular(()=>import("./chunk-JASDKVTZ.js"))),rt(()=>Wf(t,o,r)),rt(D=>ov(D,o,l,f,p,T,h,b)),Io({bufferSize:1,refCount:!1}));if(Bl(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=yr(null);else{M.pipe(Vl()).subscribe();let D=M.pipe(Gt(O=>O.getRedirectResult().then(H=>H,()=>null)),Go,Io({bufferSize:1,refCount:!1})),$=M.pipe(Gt(O=>new yt(H=>({unsubscribe:o.runOutsideAngular(()=>O.onAuthStateChanged(ce=>H.next(ce),ce=>H.error(ce),()=>H.complete()))})))),z=M.pipe(Gt(O=>new yt(H=>({unsubscribe:o.runOutsideAngular(()=>O.onIdTokenChanged(ce=>H.next(ce),ce=>H.error(ce),()=>H.complete()))}))));this.authState=D.pipe(To($),$t(u.outsideAngular),vt(u.insideAngular)),this.user=D.pipe(To(z),$t(u.outsideAngular),vt(u.insideAngular)),this.idToken=this.user.pipe(Gt(O=>O?_n(O.getIdToken()):yr(null))),this.idTokenResult=this.user.pipe(Gt(O=>O?_n(O.getIdTokenResult()):yr(null))),this.credential=Pl(D,x,this.authState.pipe(Eo(O=>!O))).pipe(rt(O=>O?.user?O:null),$t(u.outsideAngular),vt(u.insideAngular))}return Gf(this,M,o,{spy:{apply:(D,$,z)=>{(D.startsWith("signIn")||D.startsWith("createUser"))&&z.then(O=>x.next(O))}}})}static \u0275fac=function(r){return new(r||n)(Ce(zf),Ce(Kf,8),Ce(Er),Ce(Oe),Ce(Vt),Ce(ev,8),Ce(tv,8),Ce(nv,8),Ce(rv,8),Ce(iv,8),Ce(sv,8),Ce(ot,8))};static \u0275prov=zt({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();var Lt=class n{app;firestore;auth;currentUser=null;constructor(){this.app=Oi(Bs),this.firestore=Vs(this.app),this.auth=Li(this.app),this.initializeAuthListener()}initializeAuthListener(){sh(this.auth,e=>{this.currentUser=e})}getCurrentUser(){return this.currentUser}logIn(e,t){return V(this,null,function*(){try{yield oh(this.auth,e,t),console.log("Usuario logeado correctamente")}catch(r){throw r}})}registro(e,t){return V(this,null,function*(){try{yield ih(this.auth,e,t),console.log("Usuario registrado correctamente")}catch(r){throw r}})}getUserLogged(){return Ao(Qf).authState}logOut(){return V(this,null,function*(){try{yield ah(this.auth),console.log("Usuario deslogueado correctamente")}catch(e){console.error("Error al desloguearse",e)}})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=zt({token:n,factory:n.\u0275fac,providedIn:"root"})};var av=n=>({"btn-cerrar-chat":n}),uv=(n,e)=>({"mensaje-usuario":n,"mensaje-otros":e});function cv(n,e){if(n&1){let t=vn();j(0,"div",13)(1,"span",14),G(2),U(),j(3,"button",15),ae("click",function(){ze(t);let i=Se();return Ke(i.logOut())}),G(4,"Log Out"),U()()}if(n&2){let t=Se();oe(2),Tr(t.usuario==null?null:t.usuario.email)}}function lv(n,e){if(n&1){let t=vn();j(0,"button",16),ae("click",function(){ze(t);let i=Se();return Ke(i.irALogIn())}),G(1,"Log In"),U()}}function hv(n,e){n&1&&(j(0,"div",17),G(1," Necesitas estar logeado para jugar "),U())}function dv(n,e){if(n&1){let t=vn();j(0,"button",18),ae("click",function(){ze(t);let i=Se();return Ke(i.toggleChat())}),G(1),U()}if(n&2){let t=Se();Me("ngClass",kl(2,av,t.chatAbierto)),oe(),wn(" ",t.chatAbierto?"Cerrar Chat":"Chat"," ")}}function fv(n,e){if(n&1&&(j(0,"div",24)(1,"strong"),G(2),U(),j(3,"small"),G(4),U(),j(5,"span"),G(6),U()()),n&2){let t=e.$implicit,r=Se(2);Me("ngClass",Ml(4,uv,t.emisor===(r.usuario==null?null:r.usuario.email),t.emisor!==(r.usuario==null?null:r.usuario.email))),oe(2),Tr(t.emisor),oe(2),Tr(t.hora),oe(2),Tr(t.texto)}}function mv(n,e){if(n&1){let t=vn();j(0,"div",19)(1,"div",20),Et(2,fv,7,7,"div",21),U(),j(3,"input",22),At("ngModelChange",function(i){ze(t);let o=Se();return Tt(o.mensajeNuevo,i)||(o.mensajeNuevo=i),Ke(i)}),ae("keydown.enter",function(){ze(t);let i=Se();return Ke(i.enviarMensaje())}),U(),j(4,"button",23),ae("click",function(){ze(t);let i=Se();return Ke(i.enviarMensaje())}),G(5,"\u2192"),U()()}if(n&2){let t=Se();oe(2),Me("ngForOf",t.mensajes),oe(),It("ngModel",t.mensajeNuevo)}}var $s=class n{constructor(e,t,r){this.router=e;this.firebaseService=t;this.firestore=r}usuario;mensajes=[];mensajeNuevo="";chatAbierto=!1;subscripcion;mostrarMensaje=!1;ngOnInit(){this.usuario=this.firebaseService.getCurrentUser(),this.cargarMensajes()}irAQuienSoy(){this.router.navigate(["/quien-soy"])}irALogIn(){this.router.navigate(["/login"])}irAAhorcado(){if(!this.usuario){this.mostrarMensaje=!0;return}this.mostrarMensaje=!1,this.router.navigate(["/juegos/ahorcado"])}irAMayorOMenor(){if(!this.usuario){this.mostrarMensaje=!0;return}this.mostrarMensaje=!1,this.router.navigate(["/juegos/mayorOMenor"])}logOut(){return V(this,null,function*(){yield this.firebaseService.logOut(),this.usuario=this.firebaseService.getCurrentUser(),this.router.navigate(["/home"])})}abrirChat(){let e=document.getElementById("chatBox");e&&e.classList.toggle("hidden")}enviarMensaje(){return V(this,null,function*(){if(this.mensajeNuevo.trim()){let e=new Date,t=e.getHours(),r=e.getMinutes(),i=String(e.getDate()).padStart(2,"0"),o=String(e.getMonth()+1).padStart(2,"0"),u=e.getFullYear(),l=`${i}/${o}/${u}`,h=`${String(t).padStart(2,"0")}:${String(r).padStart(2,"0")}`,f=hn(this.firestore,"mensajes"),p={id:this.usuario?.uid,usuario:this.usuario?.email,hora:`${l} ${h}`,mensaje:this.mensajeNuevo,timestamp:fe.now()};yield Kn(f,p),this.mensajeNuevo="",this.scrollearAlFondo()}})}cargarMensajes(){let e=hn(this.firestore,"mensajes"),t=lf(e,cf("timestamp","asc"));this.subscripcion=af(t).subscribe(r=>{this.mensajes=r.map(i=>({emisor:i.usuario,idEmisor:i.id,texto:i.mensaje,hora:i.hora,timestamp:i.timestamp.toDate()})),this.scrollearAlFondo()})}toggleChat(){this.chatAbierto=!this.chatAbierto}ngOnDestroy(){this.subscripcion&&this.subscripcion.unsubscribe()}scrollearAlFondo(){let e=document.getElementById("chatBox");e&&setTimeout(()=>{e.scrollTop=e.scrollHeight},100)}static \u0275fac=function(t){return new(t||n)(Y(Ct),Y(Lt),Y(Be))};static \u0275cmp=Ge({type:n,selectors:[["app-home"]],standalone:!0,features:[We],decls:20,vars:5,consts:[["loginButton",""],[1,"home-container"],[1,"header"],[1,"button-container"],[1,"btn-quien-soy",3,"click"],["class","user-info",4,"ngIf","ngIfElse"],["class","alert-message",4,"ngIf"],["class","btn-chat",3,"ngClass","click",4,"ngIf"],["class","chat-box",4,"ngIf"],[1,"juegos-container"],[1,"item-juego"],["src","https://firebasestorage.googleapis.com/v0/b/sala-de-juegos-59d90.appspot.com/o/el-ahorcado.jpg?alt=media&token=9d6a53da-fb76-42cb-8b32-846e8c883391","alt","Ahorcado",1,"ahorcado-imagen",3,"click"],["src","https://firebasestorage.googleapis.com/v0/b/sala-de-juegos-59d90.appspot.com/o/Baraja_espa%C3%B1ola_completa.png?alt=media&token=7097f792-b827-41ac-b638-23c6697aa5c6","alt","Mayor Menor",1,"mayor-menor-imagen",3,"click"],[1,"user-info"],[1,"user-email"],[1,"btn-log-out",3,"click"],[1,"btn-log-in",3,"click"],[1,"alert-message"],[1,"btn-chat",3,"click","ngClass"],[1,"chat-box"],["id","chatBox",1,"mensajes",2,"overflow-y","auto","height","300px"],[3,"ngClass",4,"ngFor","ngForOf"],["placeholder","Escribe un mensaje...",3,"ngModelChange","keydown.enter","ngModel"],[3,"click"],[3,"ngClass"]],template:function(t,r){if(t&1){let i=vn();j(0,"div",1)(1,"div",2)(2,"div",3)(3,"button",4),ae("click",function(){return ze(i),Ke(r.irAQuienSoy())}),G(4,"Quien Soy"),U()(),Et(5,cv,5,1,"div",5)(6,lv,2,0,"ng-template",null,0,Nl),U(),Et(8,hv,2,0,"div",6)(9,dv,2,4,"button",7)(10,mv,6,2,"div",8),j(11,"div",9)(12,"div",10)(13,"h2"),G(14,"Ahorcado"),U(),j(15,"img",11),ae("click",function(){return ze(i),Ke(r.irAAhorcado())}),U()(),j(16,"div",10)(17,"h2"),G(18,"Mayor o Menor"),U(),j(19,"img",12),ae("click",function(){return ze(i),Ke(r.irAMayorOMenor())}),U()()()()}if(t&2){let i=xl(7);oe(5),Me("ngIf",r.usuario)("ngIfElse",i),oe(3),Me("ngIf",!r.usuario&&r.mostrarMensaje),oe(),Me("ngIf",r.usuario),oe(),Me("ngIf",r.chatAbierto&&r.usuario)}},dependencies:[In,Ul,jl,En,Xn,Ft,Yn,dn],styles:["[_nghost-%COMP%]{display:block;height:100vh;background-color:#333}.home-container[_ngcontent-%COMP%]{padding:0 20px;height:100%;box-sizing:border-box;position:relative}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;background-color:#444;padding:15px 20px;border-radius:8px;box-shadow:0 2px 5px #00000080;margin-bottom:20px}.button-container[_ngcontent-%COMP%]{margin-right:10px}.btn-quien-soy[_ngcontent-%COMP%], .btn-log-out[_ngcontent-%COMP%], .btn-log-in[_ngcontent-%COMP%]{background-color:#1db954;color:#fff;border-radius:8px;padding:10px 20px;border:none;font-weight:700;font-size:16px;cursor:pointer;font-family:Roboto,sans-serif;transition:background-color .3s ease,transform .3s ease}.btn-quien-soy[_ngcontent-%COMP%]:hover, .btn-log-out[_ngcontent-%COMP%]:hover, .btn-log-in[_ngcontent-%COMP%]:hover{background-color:#1ed760;transform:scale(1.05)}.user-info[_ngcontent-%COMP%]{display:flex;align-items:center}.user-email[_ngcontent-%COMP%]{background-color:#6cb6f2;color:#fff;border-radius:8px;padding:5px 10px;margin-right:10px}.btn-log-out[_ngcontent-%COMP%]{background-color:#ff4757}.btn-log-out[_ngcontent-%COMP%]:hover{background-color:#ff6b81;transform:scale(1.05)}.btn-log-in[_ngcontent-%COMP%]{background-color:#6cb6f2}.btn-log-in[_ngcontent-%COMP%]:hover{background-color:#5dade2;transform:scale(1.05)}.btn-chat[_ngcontent-%COMP%]{background-color:#1db954;color:#fff;border-radius:8px;padding:10px 20px;position:fixed;bottom:20px;right:20px;border:none;font-weight:700;font-size:16px;cursor:pointer;transition:background-color .3s ease,transform .3s ease}.btn-chat[_ngcontent-%COMP%]:hover{background-color:#1ed760;transform:scale(1.05)}.btn-cerrar-chat[_ngcontent-%COMP%]{background-color:#f44336}.btn-cerrar-chat[_ngcontent-%COMP%]:hover{background-color:#c62828;transform:scale(1.05)}.chat-box[_ngcontent-%COMP%]{background-color:#444;border-radius:8px;padding:15px;position:fixed;bottom:80px;right:20px;width:600px;max-height:450px;box-shadow:0 2px 5px #00000080;overflow-y:auto}.chat-box[_ngcontent-%COMP%]   .mensajes[_ngcontent-%COMP%]{max-height:250px;overflow-y:auto;margin-bottom:10px}.chat-box[_ngcontent-%COMP%]   .mensajes[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:baseline;margin-bottom:8px}.chat-box[_ngcontent-%COMP%]   .mensajes[_ngcontent-%COMP%]   div.mensaje-usuario[_ngcontent-%COMP%]{justify-content:flex-end;text-align:right}.chat-box[_ngcontent-%COMP%]   .mensajes[_ngcontent-%COMP%]   div.mensaje-usuario[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%], .chat-box[_ngcontent-%COMP%]   .mensajes[_ngcontent-%COMP%]   div.mensaje-usuario[_ngcontent-%COMP%]   small[_ngcontent-%COMP%], .chat-box[_ngcontent-%COMP%]   .mensajes[_ngcontent-%COMP%]   div.mensaje-usuario[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#fff}.chat-box[_ngcontent-%COMP%]   .mensajes[_ngcontent-%COMP%]   div.mensaje-usuario[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background-color:#1e90ff;padding:10px 15px;border-radius:15px;display:inline-block;color:#fff}.chat-box[_ngcontent-%COMP%]   .mensajes[_ngcontent-%COMP%]   div.mensaje-otros[_ngcontent-%COMP%]{justify-content:flex-start;text-align:left}.chat-box[_ngcontent-%COMP%]   .mensajes[_ngcontent-%COMP%]   div.mensaje-otros[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%], .chat-box[_ngcontent-%COMP%]   .mensajes[_ngcontent-%COMP%]   div.mensaje-otros[_ngcontent-%COMP%]   small[_ngcontent-%COMP%], .chat-box[_ngcontent-%COMP%]   .mensajes[_ngcontent-%COMP%]   div.mensaje-otros[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#bbb}.chat-box[_ngcontent-%COMP%]   .mensajes[_ngcontent-%COMP%]   div.mensaje-otros[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background-color:#28a745;padding:10px 15px;border-radius:15px;display:inline-block;color:#fff}.chat-box[_ngcontent-%COMP%]   .mensajes[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{margin-right:5px;font-size:.8em;font-weight:700}.chat-box[_ngcontent-%COMP%]   .mensajes[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:.8em;margin-right:10px}.chat-box[_ngcontent-%COMP%]   .mensajes[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.8em}.chat-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:calc(100% - 80px);padding:10px;border-radius:5px;border:1px solid #444;background-color:#555;color:#fff}.chat-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#aaa}.chat-box[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#227bff;color:#fff;border:none;border-radius:5px;padding:10px;cursor:pointer;margin-left:5px}.chat-box[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#106fff}.juegos-container[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:flex-start;flex-wrap:wrap;margin:50px 0;padding:15px 20px;background-color:#444;border-radius:8px;box-shadow:0 2px 5px #00000080}.item-juego[_ngcontent-%COMP%]{text-align:center;margin:10px}.item-juego[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#fff;margin-bottom:10px}.ahorcado-imagen[_ngcontent-%COMP%], .mayor-menor-imagen[_ngcontent-%COMP%]{width:300px;height:auto;cursor:pointer;transition:transform .3s ease;border-radius:8px}.ahorcado-imagen[_ngcontent-%COMP%]:hover, .mayor-menor-imagen[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.alert-message[_ngcontent-%COMP%]{text-align:center;background-color:#f44336;color:#fff;padding:10px;border-radius:5px;margin:10px 0}"]})};var zs=class n{constructor(e){this.router=e}volverAHome(){this.router.navigate(["/home"])}static \u0275fac=function(t){return new(t||n)(Y(Ct))};static \u0275cmp=Ge({type:n,selectors:[["app-quien-soy"]],standalone:!0,features:[We],decls:17,vars:0,consts:[[1,"quien-soy-container"],[1,"btn-volver",3,"click"],["src","https://firebasestorage.googleapis.com/v0/b/sala-de-juegos-59d90.appspot.com/o/yo.jpg?alt=media&token=d19649ff-8e96-4c4d-9142-8c4880ab21a6","alt","yo",1,"mi-imagen"]],template:function(t,r){t&1&&(j(0,"div",0)(1,"button",1),ae("click",function(){return r.volverAHome()}),G(2,"Volver"),U(),j(3,"h1"),G(4,"Mi nombre es F\xE9lix Castelli"),U(),j(5,"p"),G(6,' Soy estudiante de la UTN de Avellaneda, cursando la Tecnicatura Universitaria en Programaci\xF3n. Este es mi proyecto titulado "Sala de Juegos" para la materia Laboratorio IV. Mi juego se llama "4 Fotos 1 Palabra". '),Wt(7,"br")(8,"br"),G(9,' En "4 Fotos 1 Palabra", como su nombre indica, se presentan cuatro im\xE1genes que est\xE1n relacionadas con una \xFAnica palabra. El objetivo del juego es adivinar esa palabra bas\xE1ndote en las fotos que se muestran. Tenes un m\xE1ximo de seis intentos para adivinar cada palabra. Por cada respuesta correcta, sumas un punto a tu puntuaci\xF3n. '),Wt(10,"br")(11,"br"),G(12," Si agotas tus seis intentos sin adivinar la palabra, perd\xE9s y tu puntuaci\xF3n se mantendr\xE1 hasta ese momento. Hay un total de diez palabras disponibles para jugar, y su orden es aleatorio, lo que garantiza que cada partida sea \xFAnica y entretenida. "),Wt(13,"br")(14,"br"),G(15," Al finalizar el juego, vas a poder ver una tabla de rankings que va a mostrar las puntuaciones de todos los jugadores, permiti\xE9ndote comparar tu desempe\xF1o con el de los dem\xE1s. "),U(),Wt(16,"img",2),U())},styles:[".quien-soy-container[_ngcontent-%COMP%]{background-color:#1db9541a;color:#fff;padding:40px;text-align:center;border-radius:10px;box-shadow:0 4px 8px #0000001a;font-family:Roboto,sans-serif;position:relative;margin-top:130px}h1[_ngcontent-%COMP%]{font-size:1.8rem;margin-bottom:20px;font-weight:700}p[_ngcontent-%COMP%]{font-size:1rem}.btn-volver[_ngcontent-%COMP%]{background-color:#f44336;color:#fff;border-radius:8px;padding:8px 12px;border:none;font-weight:700;font-size:14px;cursor:pointer;position:absolute;top:10px;left:10px;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 8px #0000001a;font-family:Roboto,sans-serif;transition:background-color .3s ease,transform .3s ease}.btn-volver[_ngcontent-%COMP%]:hover{background-color:#c62828;transform:scale(1.05)}.mi-imagen[_ngcontent-%COMP%]{width:300px;border-radius:8px;box-shadow:0 2px 5px #00000080}"]})};function pv(n,e){if(n&1&&(j(0,"div",16),G(1),U()),n&2){let t=Se();oe(),wn(" ",t.error," ")}}var Ks=class n{constructor(e,t,r){this.router=e;this.firestore=t;this.firebaseService=r}email="";contrasenia="";error="";exito=!0;ngAfterViewInit(){}logIn(){return V(this,null,function*(){try{yield this.firebaseService.logIn(this.email,this.contrasenia).then(()=>{let e=hn(this.firestore,"logins"),t={fecha:new Date,user:this.email};Kn(e,t),this.router.navigate(["/home"])})}catch{this.exito=!1,this.error="Correo electr\xF3nico o contrase\xF1a inv\xE1lidos"}})}autoCompletar(){this.email="admin@admin.com",this.contrasenia="123456"}irARegistro(){this.router.navigate(["/registro"])}irAHome(){this.router.navigate(["/home"])}static \u0275fac=function(t){return new(t||n)(Y(Ct),Y(Be),Y(Lt))};static \u0275cmp=Ge({type:n,selectors:[["app-login"]],standalone:!0,features:[We],decls:25,vars:3,consts:[[1,"header-title"],[1,"login-title"],[1,"login-container"],[1,"btn-home",3,"click"],[1,"login-titulo"],[3,"ngSubmit"],[1,"input-group"],["for","email"],["type","email","id","email","name","email","required","",3,"ngModelChange","ngModel"],["for","contrasenia"],["type","password","id","contrasenia","name","contrasenia","required","",3,"ngModelChange","ngModel"],[1,"button-group"],["type","submit",1,"btn-login"],["type","button",1,"btn-registro",3,"click"],["type","button",1,"btn-login",3,"click"],["class","error-mensaje",4,"ngIf"],[1,"error-mensaje"]],template:function(t,r){t&1&&(j(0,"div",0)(1,"h1",1),G(2,"Sala de Juegos"),U()(),j(3,"div",2)(4,"button",3),ae("click",function(){return r.irAHome()}),G(5,"M\xE1s Tarde"),U(),j(6,"h1",4),G(7,"Login"),U(),j(8,"form",5),ae("ngSubmit",function(){return r.logIn()}),j(9,"div",6)(10,"label",7),G(11,"Email:"),U(),j(12,"input",8),At("ngModelChange",function(o){return Tt(r.email,o)||(r.email=o),o}),U()(),j(13,"div",6)(14,"label",9),G(15,"Contrase\xF1a:"),U(),j(16,"input",10),At("ngModelChange",function(o){return Tt(r.contrasenia,o)||(r.contrasenia=o),o}),U()(),j(17,"div",11)(18,"button",12),G(19,"Login"),U(),j(20,"button",13),ae("click",function(){return r.irARegistro()}),G(21,"Registrarse"),U(),j(22,"button",14),ae("click",function(){return r.autoCompletar()}),G(23,"Auto Completar"),U()(),Et(24,pv,2,1,"div",15),U()()),t&2&&(oe(12),It("ngModel",r.email),oe(4),It("ngModel",r.contrasenia),oe(8),Me("ngIf",!r.exito))},dependencies:[Xn,js,Ft,Yn,Ls,ci,dn,ui,In,En],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center;height:100vh;background-color:#333}.header-title[_ngcontent-%COMP%]{background-color:#000;padding:20px;border-radius:8px;text-align:center;margin-bottom:20px;box-shadow:0 2px 5px #00000080;text-transform:uppercase;color:#1db954}.login-title[_ngcontent-%COMP%]{font-size:28px;margin:0}.login-container[_ngcontent-%COMP%]{background-color:#222;padding:40px;border-radius:10px;text-align:center;box-shadow:0 4px 10px #00000080;font-family:Roboto,sans-serif;width:300px}.login-titulo[_ngcontent-%COMP%]{color:#fff;margin-bottom:20px;font-size:24px}.input-group[_ngcontent-%COMP%]{margin-bottom:15px}label[_ngcontent-%COMP%]{color:#fff;font-size:14px;display:block;margin-bottom:5px}input[_ngcontent-%COMP%]{width:calc(100% - 20px);padding:10px;border:none;border-radius:5px;font-size:14px;background-color:#444;color:#fff;outline:none;font-family:Roboto,sans-serif}input[_ngcontent-%COMP%]::placeholder{color:#aaa}.button-group[_ngcontent-%COMP%]{margin-top:20px}.btn-login[_ngcontent-%COMP%], .btn-registro[_ngcontent-%COMP%], .btn-autocompletar[_ngcontent-%COMP%], .btn-home[_ngcontent-%COMP%]{width:100%;height:38px;margin-bottom:10px;border:none;border-radius:8px;font-weight:700;font-size:16px;cursor:pointer;transition:background-color .3s ease,transform .3s ease}.btn-login[_ngcontent-%COMP%]{background-color:#1db954;color:#fff}.btn-login[_ngcontent-%COMP%]:hover{background-color:#1ed760;transform:scale(1.05)}.btn-registro[_ngcontent-%COMP%]{background-color:#555;color:#fff}.btn-registro[_ngcontent-%COMP%]:hover{background-color:#666;transform:scale(1.05)}.btn-autocompletar[_ngcontent-%COMP%]{background-color:#777;color:#fff}.btn-autocompletar[_ngcontent-%COMP%]:hover{background-color:#888;transform:scale(1.05)}.error-mensaje[_ngcontent-%COMP%]{color:red;margin-top:10px}.btn-home[_ngcontent-%COMP%]{width:50%;height:38px;background-color:#ff4757;color:#fff;border-radius:8px;font-weight:700;font-size:16px;cursor:pointer;transition:background-color .3s ease,transform .3s ease}.btn-home[_ngcontent-%COMP%]:hover{background-color:#ff6b81;transform:scale(1.05)}"]})};function gv(n,e){if(n&1&&(j(0,"div",12),G(1),U()),n&2){let t=Se();oe(),wn(" ",t.error," ")}}var Ws=class n{constructor(e,t,r){this.firebaseService=e;this.firestore=t;this.router=r}email="";contrasenia="";error="";exito=!0;registrarse(){return V(this,null,function*(){try{yield this.firebaseService.registro(this.email,this.contrasenia).then(()=>{let e=hn(this.firestore,"logins"),t={fecha:new Date,user:this.email};Kn(e,t),this.router.navigate(["/home"])})}catch(e){this.exito=!1,this.manejoErrores(e.code)}})}manejoErrores(e){switch(e){case"auth/email-already-in-use":this.error="La direcci\xF3n de correo electr\xF3nico ya est\xE1 en uso.";break;case"auth/invalid-email":this.error="La direcci\xF3n de correo electr\xF3nico no es v\xE1lida.";break;case"auth/weak-password":this.error="La contrase\xF1a es demasiado d\xE9bil. Debe tener al menos 6 caracteres.";break;default:this.error="Ocurri\xF3 un error. Por favor, intenta nuevamente.";break}}volverALogIn(){this.router.navigate(["/login"])}static \u0275fac=function(t){return new(t||n)(Y(Lt),Y(Be),Y(Ct))};static \u0275cmp=Ge({type:n,selectors:[["app-registro"]],standalone:!0,features:[We],decls:18,vars:3,consts:[[1,"registro-container"],[1,"btn-volver",3,"click"],[1,"registro-titulo"],[3,"ngSubmit"],[1,"input-group"],["for","email"],["type","email","id","email","name","email","required","",3,"ngModelChange","ngModel"],["for","password"],["type","password","id","contrasenia","name","contrasenia","required","",3,"ngModelChange","ngModel"],[1,"button-group"],["type","submit",1,"btn-registro"],["class","error-mensaje",4,"ngIf"],[1,"error-mensaje"]],template:function(t,r){t&1&&(j(0,"div",0)(1,"button",1),ae("click",function(){return r.volverALogIn()}),G(2,"\u2190"),U(),j(3,"h1",2),G(4,"Registrarse"),U(),j(5,"form",3),ae("ngSubmit",function(){return r.registrarse()}),j(6,"div",4)(7,"label",5),G(8,"Email:"),U(),j(9,"input",6),At("ngModelChange",function(o){return Tt(r.email,o)||(r.email=o),o}),U()(),j(10,"div",4)(11,"label",7),G(12,"Contrase\xF1a:"),U(),j(13,"input",8),At("ngModelChange",function(o){return Tt(r.contrasenia,o)||(r.contrasenia=o),o}),U()(),j(14,"div",9)(15,"button",10),G(16,"Registrarse"),U()(),Et(17,gv,2,1,"div",11),U()()),t&2&&(oe(9),It("ngModel",r.email),oe(4),It("ngModel",r.contrasenia),oe(4),Me("ngIf",!r.exito))},dependencies:[Xn,js,Ft,Yn,Ls,ci,dn,ui,In,En],styles:["[_nghost-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh;background-color:#333}.registro-container[_ngcontent-%COMP%]{background-color:#222;padding:40px;border-radius:10px;text-align:center;box-shadow:0 4px 10px #00000080;font-family:Roboto,sans-serif;width:300px}.registro-titulo[_ngcontent-%COMP%]{color:#fff;margin-bottom:20px;font-size:24px}.input-group[_ngcontent-%COMP%]{margin-bottom:15px}label[_ngcontent-%COMP%]{color:#fff;font-size:14px;display:block;margin-bottom:5px}input[_ngcontent-%COMP%]{width:calc(100% - 20px);padding:10px;border:none;border-radius:5px;font-size:14px;background-color:#444;color:#fff;outline:none;font-family:Roboto,sans-serif}input[_ngcontent-%COMP%]::placeholder{color:#aaa}.button-group[_ngcontent-%COMP%]{margin-top:20px}.btn-registro[_ngcontent-%COMP%]{width:100%;padding:10px;border:none;border-radius:8px;font-weight:700;font-size:16px;cursor:pointer;transition:background-color .3s ease,transform .3s ease;background-color:#1db954;color:#fff}.btn-registro[_ngcontent-%COMP%]:hover{background-color:#1ed760;transform:scale(1.05)}.error-mensaje[_ngcontent-%COMP%]{color:red;margin-top:10px}.btn-volver[_ngcontent-%COMP%]{position:absolute;top:20px;left:20px;background-color:#ff4757;color:#fff;font-size:20px;font-weight:700;padding:10px;border:none;border-radius:8px;cursor:pointer;transition:background-color .3s ease,transform .3s ease}.btn-volver[_ngcontent-%COMP%]:hover{background-color:#ff6b81;transform:scale(1.05)}"]})};var Yf=[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:Ks},{path:"home",component:$s},{path:"quien-soy",component:zs},{path:"registro",component:Ws},{path:"juegos",loadChildren:()=>import("./chunk-NMXN7JKW.js").then(n=>n.JuegosModule)}];var Xf={providers:[Ol({eventCoalescing:!0}),Gl(Yf),th(()=>Oi(Bs)),rh(()=>Li()),of(()=>uf())]};var Hs=class n{title="sala-de-juegos";static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ge({type:n,selectors:[["app-root"]],standalone:!0,features:[We],decls:1,vars:0,template:function(t,r){t&1&&Wt(0,"router-outlet")},dependencies:[$l,zl]})};ql(Hs,Xf).catch(n=>console.error(n));
